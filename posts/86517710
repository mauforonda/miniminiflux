Published on October 4, 2023 8:04 AM GMT<br/><br/><figure><img src="https://reader.miniflux.app/proxy/lBAbP-At9x88wWzN6cuttKVD8aqAqiR9YfrlF7ctFFY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jZHlla2x4OXJjbXdyMGhxZGNsNQ==" srcset="https://reader.miniflux.app/proxy/gfDPvX72GC4qCvwQL9ym7Vbc8EKFFn8Y4COeyYw92k8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hYm94aXVldHd4OGwweGwyamJsbQ== 100w, https://reader.miniflux.app/proxy/gf7R4Qp6kud1CfC8Q1l7Xk6mTO4chbankJbVlXiio8U=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qZzZvbWV4c2hobmhlemZvOG9kNA== 200w, https://reader.miniflux.app/proxy/yu36iQHS69jY5GzV0aE-pZSm6XPQyzV96lPDwpW-CMo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jenFvdm03YTVhNTN4amluNHV3dQ== 300w, https://reader.miniflux.app/proxy/mFyjnQCwjrWcWo6-pJgaKuWrdZ8WHFC4f3Yk5fUz3gU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wcXk3czZ2NGxvZGlueXdmZmZ5cg== 400w, https://reader.miniflux.app/proxy/f7DEQMdrZ6Cor8l1W9RyEVKBFH3pHj1qngD-PjxZGH4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zdGRvN2JoZnZybG1vcWl4emg2eg== 500w, https://reader.miniflux.app/proxy/O-slOzfzESTY4oKkUX2CZszZ_-rNOsyoWej4MlA6nSk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9rc2p1cTViYmpiYTVrMW53N2p3dQ== 600w, https://reader.miniflux.app/proxy/k5q5o22T-CFt-TIsXbs3zYXGZBoSx8eFoqzFzJP18jg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tbjhjMXNzaW51eGNyYXdnaTVndg== 700w, https://reader.miniflux.app/proxy/XJCWtp9rW74Lbt-zGcqz2PdvnWl16NNknsCnfqU8D9o=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mMXExcDloNXFuYmFlcmc5eWt3bQ== 800w, https://reader.miniflux.app/proxy/VojcfYBpL3Vx1aIrZQ6BiAXa3Y_Wv-hya0WPCw6L2iU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ocG9vdm9jdjk5azFkZ3AweW5reQ== 900w, https://reader.miniflux.app/proxy/8MrfZejy2852kdZw-nQ72pzKYA2tDUl90DVpEPSJsDA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9uZmh0YzF5ZjR6NHV4eDh6ZDlmbA== 977w" loading="lazy"/><figcaption>Some examples of graphical tensor notation from the <a href="https://quimb.readthedocs.io/en/latest/index.html" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">QUIMB python package</a></figcaption></figure><p>Deep learning consists almost entirely of operations on or between tensors, so easily understanding tensor operations is pretty important for interpretability work.<sup><a href="#fnbwj2f888xxm">[1]</a></sup> It&#39;s often easy to get confused about which operations are happening between tensors and lose sight of the overall structure, but graphical notation<sup><a href="#fnbytowdrb3ck">[2]</a></sup> makes it easier to parse things at a glance and see interesting equivalences.</p><p>The first half of this post introduces the notation and applies it to some decompositions (SVD, CP, Tucker, and tensor-network decompositions), while the second half applies it to <a href="https://transformer-circuits.pub/2021/framework/index.html" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">A Mathematical Framework for Transformer Circuits</a>. Most of the first half is adapted from my physics PhD thesis introduction, which is partly based on existing explanations such as in <a href="https://www.math3ma.com/blog/matrices-as-tensor-network-diagrams" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">the math3ma blog</a>, <a href="https://simonverret.github.io/2019/02/16/tensor-network-diagrams-of-typical-neural-network.html" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">Simon Verret&#39;s blog</a>, <a href="https://tensornetwork.org/diagrams/" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">tensornetwork.org</a>, <a href="https://www.tensors.net/p-tutorial-1" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">tensors.net</a>, <a href="https://arxiv.org/abs/1603.03039" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">Hand-waving and Interpretive Dance: An Introductory Course on Tensor Networks</a>, <a href="https://arxiv.org/abs/2303.13565" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">An Intuitive Framework for Neural Learning Systems</a>, or <a href="https://drive.google.com/file/d/1ycctAkXlN3-JrsTZM8TaAZDzTJum_EqX/view" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">a talk I gave in 2021</a>. Feel free to scroll around and look at interesting diagrams rather than reading this post start to finish.</p><h1>Tensors</h1><p>Practically, tensors in our context can just be treated as arrays of numbers.<sup><a href="#fnytaychzpt3">[3]</a></sup> In graphical notation (first <a href="http://homepages.math.uic.edu/~kauffman/Penrose.pdf#page=5" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">introduced by Roger Penrose in 1971</a>), tensors are represented as shapes with &#34;legs&#34; sticking out of them. A vector can be represented as a shape with one leg, a matrix can be represented as a shape with two legs, and so on. I&#39;ll also represent everything in PyTorch code for clarity.</p><figure><img src="https://reader.miniflux.app/proxy/16T-LaNRVwQFkfFINjoh3Y1odyDjEr5sLp7iK2cqPpw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94Z2JsOTBpbXB0dHVqcTBsejVtcQ==" srcset="https://reader.miniflux.app/proxy/vuJdz6d_7cMjrH3IFxIfeTVlsIamzR7ep4IMg_L18D0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9rZnFtc3Rwb2tidXJheDZmZjNrag== 300w, https://reader.miniflux.app/proxy/yZCkr0geQ0Kx6nkxuHbK5NV1j1YMpDZ4avlSwUsjlBk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ubHJkbXBvdWdoeGh6bDRsdHdscQ== 600w, https://reader.miniflux.app/proxy/VBDtCJoiEC1_s8Xa_liHx2kxQUq04p2B88USZFQStfU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93YjV4MHB5Mnl0MXBqZzB0eWN2YQ== 900w, https://reader.miniflux.app/proxy/XDHuhgX9mAmWM3rfLPTxd4g8sduhhGHqUUtapBCP_xU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qcGw2enJ3c3JhdHhqeDE2ZWc0cQ== 1200w, https://reader.miniflux.app/proxy/1xa93L0tKUkAR2Vcd4ZQ34vsRkfIDrdhEtNBsEtAl0U=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9iaTlvbjFuOWZ5cWsxYjNua3ZnZw== 1500w, https://reader.miniflux.app/proxy/BG-__k2oMXFnqP7p8Sq8HtwK7C_cTp-eC9VCDhMY3bM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9sdWlmZWpjNHJqdWQ5d3R6aDM0Mw== 1800w, https://reader.miniflux.app/proxy/yknsfv7oV7FJemzcYYbkWcPcNVxlsvWatCsKw5XDijE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9iZ2pjYW1scmlmYzNqenk5eWpyMg== 2100w, https://reader.miniflux.app/proxy/UJZ0WwBPxh9Np1huBG5EXDf0zvhfF-badLVTtGfzmPg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95czh5Y2ZxZm9maXFjdnVucDhqaw== 2400w, https://reader.miniflux.app/proxy/LJFMvK16RNeEgkTzQLKcsKXQHRcj2VP-RD_cfTIWVzU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oeGN3dXVpbXF6bGI1dXVxc2Rpcg== 2700w, https://reader.miniflux.app/proxy/OirCvH16bAKEqTcEg6cq0yQD435AQsEqqj8VBEbDMrk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9rZjZraGZuaGNnZHVpb3ZtOXAweQ== 3000w" loading="lazy"/></figure><p>Each leg corresponds to an index of the tensor - specifying an integer value for each leg of the tensor addresses a number inside of it:</p><figure><img src="https://reader.miniflux.app/proxy/yvJvMjrSc_j4JnDB5arUJlkVy0NatqW4mBD4evVBAMQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9sZ3d0c253cXRoOGZmemR0cGZueg==" srcset="https://reader.miniflux.app/proxy/c7cr-wnK9DS30XhRnVO3F0iudyKayouvqvjT3ceRrxk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94emZrb216dWx0M2F2bWFxbTZtcw== 210w, https://reader.miniflux.app/proxy/gwoyrRZuabkNO79JsoQElqq6gjkkkBpRMEGzZfKQdVY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hZTVvbzdhcnI3aDBnam1va3ZpOQ== 420w, https://reader.miniflux.app/proxy/jeavplAMOvh5n_RNHu5ksUmrxYJdsJ0PavuM4kADVxE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9uYXl5dmx1eWRibmtvd3V6ZGFmbA== 630w, https://reader.miniflux.app/proxy/e7_GUBg3XXzWAOreWKnYW-rX2ZYdfbkKxFUo3BRlJ1M=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94ZXRlcXF1NGp6c3FnMGZxcHQ0eA== 840w, https://reader.miniflux.app/proxy/Rvi1URHn9wbuiof37C63lJYpZf-u0daUaklqjOpASnM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mbjlzN3lsa3FlbnZ3Mnh1em10bg== 1050w, https://reader.miniflux.app/proxy/2hBcl9dBBaUZZeM697qqKsL47QqOgP-kXRaD6IWCeCE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xdHlzbXBld2Z5cnRycmphdXl2eg== 1260w, https://reader.miniflux.app/proxy/ptSAy7M6z25amc6aPRO3m3vRqnBEgxIqhZe0T6xUzNo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9obGFnc3N3cTBhbnQ5eGZkaDRwaA== 1470w, https://reader.miniflux.app/proxy/96ju-_0DwkosTcY_GXIwUC_LIMTNI614171uh76axv4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zamN3ajRxbGVmcHJkcXh1bDh0Ng== 1680w, https://reader.miniflux.app/proxy/vHbyVmWxRUY8oRYWyOAQE-lTP1xlqXXHr62Oj4_W0-s=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96NjRnczJhaWdkdHJ0bHN2emdheA== 1890w, https://reader.miniflux.app/proxy/Hc8QdJPf_dYn0ghBE6IUmcIBmY3YLntUgUVlPvfGDZ8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9sb3liN3E5c3RnZGplc2Zhd256OA== 2018w" loading="lazy"/></figure><p>where 0.157 happens to be the number in the (i=0,j=2,k=0) position of the tensor A. In python, this would be <code>A[0,2,0]</code>. The amount of memory required to store a tensor grows exponentially with the number of legs,<sup><a href="#fn13ccdi9zt3v">[4]</a></sup> so tensors with lots of legs are usually represented only implicitly: decomposed as operations between many smaller tensors.</p><h1>Operations</h1><p>The notation only really becomes useful when things get more complicated, but let&#39;s start as simple as possible. Multiplying two numbers together (<code>y = a * b</code>) in graphical tensor notation just involves drawing them nearby:</p><figure><img src="https://reader.miniflux.app/proxy/q6nR2ElkpMxPU_xVhrzGs1Mx1zI5t4GVuco9kB4JS2Q=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hMnJqZ2QyNHZ2eHgyYTZ5bGthbw==" srcset="https://reader.miniflux.app/proxy/88NJCCbjLhuoxqt26tXWAHxGoIu6DjtaltxU27vCJxM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hb3MxOGdxbnJyNXY1d3U4M3l6dw== 210w, https://reader.miniflux.app/proxy/jXqUC6fp6NvKzvW9dKCwpYw5VxsuT4X9xu45C_JbF3g=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zdWJyMXpqY3FicHFuanpvc2ZqZw== 420w, https://reader.miniflux.app/proxy/J7OUx43KcnH3qfvpqkpNKFA-Y67AoCzoP3y7fDSTU9w=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90bGFuZ2k3ZmU5bWI4MHNoZmdwdw== 630w, https://reader.miniflux.app/proxy/yf7ZTEtNR24CzwDB3P4qkhqnNjuvrZPds-QvpBapH7M=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wbmlqZmV1YnZ0dTN6aGFxOTQydQ== 840w, https://reader.miniflux.app/proxy/qONWxfOYhR8hCbZiW86NfDMPpvedFWNNNBKqAv1XU0g=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oeTFtbnFjZGxiOGJnanV5cHNiaw== 1050w, https://reader.miniflux.app/proxy/-iJo2BraLDa4R6J2Dos3aiVHSV-pUsiEeYdtaeo6Doc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hdzR5MWxxZnI1aW94cm5sdGFqbQ== 1260w, https://reader.miniflux.app/proxy/XoyNchZvIdwqAmujZzSSof9OvSzUiMuP5MjkWS1dFBo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vdmV1bG13c3JrbmV6dHNzd2N2MA== 1470w, https://reader.miniflux.app/proxy/IiiuGsGKOgTg3KWhsaddpZ2ttUi-hJrhVrlE-XRyEdg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oZ2R2NjRuMXdleDYydXNvZ3dlcg== 1680w, https://reader.miniflux.app/proxy/h1Ho2hgU13wgFjwrf2aUMQFQOCeaGZWbBz2hRU9nLKI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95ZmI4M3ozcHhzajd0ZGVpYWl4NQ== 1890w, https://reader.miniflux.app/proxy/7ilpUca90UV9laEpgd3jJ-80IRSc2tZuLhFvwgeoVfo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9kd3l5dm5mNzZzOGgxampweDVkMw== 2098w" loading="lazy"/></figure><p>The next easiest thing to represent in this notation is a bit more obscure: the outer product between two vectors (<code>t.outer(a, b)</code> or <code>einsum(a, b, &#39;i, j, -&gt; i j&#39;)</code>). Known more generally as a tensor product, this operation forms a matrix out of the vectors, where each element in the matrix is a product of two numbers: Yij=aibj or <code>Y[i,j] = a[i] * b[j]</code> (for example <code>Y[0,0] = a[0] * b[0]</code>,  <code>Y[1,0] = a[1] * b[0]</code> and so on). Simply drawing two tensors nearby implies a tensor product:</p><figure><img src="https://reader.miniflux.app/proxy/gUfV83-g9pqDZiopwp0-OJnWwCvCD0RA_LwCTf06ocY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9lY2ppaTExZnkyemUyY3NwZTQ2dA==" srcset="https://reader.miniflux.app/proxy/q3lUHTOzV2CN5ZK9HNq5_f4rS0RWvddbD6rAG-GFvdY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9yaGprdHdvYjljYXY1Z3B4NGl3ZA== 210w, https://reader.miniflux.app/proxy/MsYrd0E-jyIofbq6GNdO2yDJx6zKiNLMTlVwXUldbSU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vczhxMWhqN2xvYmQ5cWx5emx5cw== 420w, https://reader.miniflux.app/proxy/HOeyDh1hpM8lssJSLHBDxqbzn-0EmqWJvvi7xKSI6l0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9scHJjYnRtcjF2cHhyaDZ3ZmRycw== 630w, https://reader.miniflux.app/proxy/l_FhLqQ4oVfS3WAUS8kuNlMlm98wTpFtfAbXIVe39e8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hd2tjOTBjbGc2eHR3Nm5hemtndw== 840w, https://reader.miniflux.app/proxy/qaAp6tH-h1YPgeTEtx1l8pB7zQQpCBRTMB8_njU6kwo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96ajVsZnhheTFidTFwemhhd3F2ZQ== 1050w, https://reader.miniflux.app/proxy/ExnFN83Ms1UrR8jHFWf0WGt6S4nDHc1-aCD0a0lIKoo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95ZmR5aG4xYnV5ZnZwbWdzenA1MQ== 1260w, https://reader.miniflux.app/proxy/nZbGGdhwteKeBmddjjgM0Q1UxyaYc1AozexkF9DrmvE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ibjExbmYxb2p6d2dhZ2pvZGR3Mw== 1470w, https://reader.miniflux.app/proxy/i2KbuOWUsY9h7SInqZR7-lsUIpyr2eJgmcFqyrVH9OE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95eHloYnU1OWhhZHBjcGp1bDAwcQ== 1680w, https://reader.miniflux.app/proxy/bkuYtPaI2ZrhjXp2cSGBEMDReshgbQjGUtScuuErIQE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90bW9iYW9jY2Z3OHdnY245anJ0cw== 1890w, https://reader.miniflux.app/proxy/Ha9alWwFMbBuevF-JGf6QjWjyRYMlzgWXr7vsTK-BJY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ucW5lb2dwMWJ6b2prZ25yZWNhdQ== 2012w" loading="lazy"/></figure><p>The next simplest example will probably be more familiar: the dot product between two vectors: <code>t.dot(a,b)</code> or <code>a @ b</code> or <code>einsum(a, b, &#39;i, i, -&gt; &#39;)</code>, which can be represented by connecting the legs of two vectors:</p><figure><img src="https://reader.miniflux.app/proxy/nK4YlNXVTMIonMXL9poqeiVWi5JNWZBuCiYO5GctJHU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94YnB4bmlldWx1dGg0OXBqbml5aw==" srcset="https://reader.miniflux.app/proxy/VQzBNVkE5IMbcKNSjy0nT7Y-eCkMRJeDSvnZnyEmyIo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zaGNsMHhtaWlzaXF1OXJ6dHF0aw== 130w, https://reader.miniflux.app/proxy/b8hhGWhFFHHV7zIdyquc1oGmXjYQqI-pOd3cdgh1-gk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9iaXI2YnRza2wwazh3ZmI4dWNvbQ== 260w, https://reader.miniflux.app/proxy/2jX1XqBQWZIEkpvBsqI_S6dZtfYLVoRUE_C1bjye2R4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ycWx3ZnBzaHRtMDNuNHp4MW9zdg== 390w, https://reader.miniflux.app/proxy/HBySypODYuzsBfTFPlV5CEZdxsRYUsnX7swYTPpbZiw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ja3YxazZkaGxmc29pZTRtbmh0dQ== 520w, https://reader.miniflux.app/proxy/wcrWOS7jt4eDAQPnVgDatK8jNG_rbIowr2wo0iBuOKo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94bGQxem5wZ2llZmF1b2R3d3Fjbw== 650w, https://reader.miniflux.app/proxy/yYmyBVN_V6K8-b--IzvkI05KRbRMsJZoHMqWVjN443k=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wam0zZXhmbGRpYXp3MmJuZWduag== 780w, https://reader.miniflux.app/proxy/ME7IACZa0qHlS9gYwGH-uu9FAiXs97Ztg9TgguvykJk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9kdXJ2bXdycTNvMXZpd3JjNTJpag== 910w, https://reader.miniflux.app/proxy/wTsu06a36mgjxNIZIVNX-zr0ZFt6M6X0hDAAvswxZqk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95am5vdHNhbXF5eXdxMnh4djV2cA== 1040w, https://reader.miniflux.app/proxy/jIgq9N4lr_-FpHxD1dMUXAROEDfzSEG-mG_UYSv_wQI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95emU4Z3RxcTZ2amRnaXloMnF1cQ== 1170w, https://reader.miniflux.app/proxy/At1yOL-yKZ9td0RGG55zG78-Rh5uX6xsa-PLX0arVUw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qamt3bm51cG04b2g0a2RtNTlzcQ== 1296w" loading="lazy"/></figure><p>Connected legs like this indicate that two tensors share the same index, and a summation is taken over that index. Here the result is a single number, formed from a sum of products: y=∑iaibi or <code>y = a[0] * b[0]  +  a[1] * b[1]  +  a[2] * b[2] + ...</code></p><figure><img src="https://reader.miniflux.app/proxy/m-14S-WP5jOMiL2-GDPM7kvzCbXzif96F25qx0RQxrA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hZ29hdXY0aGFva2hkaWtpbm42dw==" srcset="https://reader.miniflux.app/proxy/7RPXtck07j8TiMXESrejl30f4529M-fO9F8jVrM1WVI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9iaXJvb25senY1eTczYW80bWp1Yg== 250w, https://reader.miniflux.app/proxy/eWcrrU_qBPNFhBdjOhN-2FoIlXD-mA41GgIdhDLxHVk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mcHJqcW1mbGxjdHZ3MTZuaGt1Zw== 500w, https://reader.miniflux.app/proxy/xVCqchZuiJoFDwryRTtJ1a0Io6WiI0xbvBuhdKKA2eU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9uY2V3OTN2ZGlzZ2lweGZtNXJwbQ== 750w, https://reader.miniflux.app/proxy/e7UxZxFUEjxrVyvrPf_fm2m4xmz6sKJJ_O8aUEEee4Q=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9penJ5OWtucWNqYW54OHg0N25kNA== 1000w, https://reader.miniflux.app/proxy/pfgiMM5kKCev5WlWOC3ozVD0STDjV6Myxh6Ft7kxehE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xeG42a29waXVlZjE1MXI1d3hzYg== 1250w, https://reader.miniflux.app/proxy/GyhavYB4cRoJezdqPVjQ7jbm86hqaxllS15DCBprWAs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9peWd1dXM0bzJvYTdqeXliYmxuMA== 1500w, https://reader.miniflux.app/proxy/85_5nRwIcBMlxiqCdo6RFLgoBtp8SE7MDiaRINiQ_QY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vdHA3cGtqMXh4dGNtcWViZ2gwZw== 1750w, https://reader.miniflux.app/proxy/pEQx_FnGEfNPEd7IwS_ocuvt0zBtrQjZihrjhjSg7KA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9iZTE1YXVqYWg3MnB0eTlqbXRoYw== 2000w, https://reader.miniflux.app/proxy/0BTaQx15uEKQFATjfdI0DoT2DTg8QyEWQTu34y5NOIM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mMThkZHRneHR3N3NrYWhnY2ZleA== 2250w, https://reader.miniflux.app/proxy/vLsm0gNUCgPA6wPv7QDXih4giEa4HqSXlIrxwyIIPmA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9waDNzdWllZG9hNnM1amtsanhvaQ== 2478w" loading="lazy"/></figure><p>Connecting legs like this is known more generally as tensor contraction or Einstein summation.  Let&#39;s take a look at all of the most common kinds of contractions between vectors and matrices:</p><figure><img src="https://reader.miniflux.app/proxy/4ELQ436Y7q-AYD5ZhP0QGLfbIsJkOmZ-0zsBtzdpQ-I=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mc2dzdjlvY3pidXNndHNhaDFybQ==" srcset="https://reader.miniflux.app/proxy/_2Lz1MagJwaiJ2-1zkHNSdQbB52nLU5BlWQF4Wxfq4A=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oeGJ6dWlmaXZzeHhwdDl3YW5sdQ== 370w, https://reader.miniflux.app/proxy/zBN2D6EujahaPR3RInSjsbz68VYodw5N-7Fvpi69WWQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9kdGczaGtlYmk5OXNycWx6eGdlaA== 740w, https://reader.miniflux.app/proxy/YYRqnAVHkZOwh_G-RY9i6_DrXg2B2dsIwxMVTRq1Jw0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9paHZwZHlsZThmemhjMW9lOGkxNA== 1110w, https://reader.miniflux.app/proxy/s6FySItucDSPTmPfs52-4AYdp3Jcr-Jdpt3k36Xi1rA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ybXhjaGdkczlsMm4zazJmanBxdQ== 1480w, https://reader.miniflux.app/proxy/JTBEiIqVo6itph3t_c8JVbDBaau2nAMbnx5H7wJllJU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zcnk4cGNqY3ZzN3BmZ3l0YW1sOA== 1850w, https://reader.miniflux.app/proxy/1iqrNsIaKJMAtWBuQA-t9fGuG_chYo7ZIZ45kVg_biU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9yZ2tlcHM1bzN6M2NhbW83aDE0aw== 2220w, https://reader.miniflux.app/proxy/ymGybISTxX8EII7NaOol3rw8_ADC43cqJDHaDrRfYlI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9nMnl3cG41YWRleHo1bTFybm5jOQ== 2590w, https://reader.miniflux.app/proxy/DZE0KJVUVDW5JRqSByDlhQjNO_LglSQbw01gSGqwjzU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jaDE1dWVlemtubnN4ZnhzOHZ4aQ== 2960w, https://reader.miniflux.app/proxy/vvriQgz4sUINxQ9QXBcN0Lh_xqLeDv5ryzjEtBgLs18=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zbjRudXZ1N2VvY2RsanAzcGM2Zw== 3330w, https://reader.miniflux.app/proxy/vewUE6sQaTPfcw30MS01VmxWIMg-fMkWYMODC-0dCvM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tN2gzYmVtdHR5NjNobXphbmdybQ== 3683w" loading="lazy"/></figure><p>In every case you can tell how many legs the resulting tensor will have by the number of uncontracted &#34;free&#39;&#39; legs on the left. </p><p>We can also represent single-tensor operations, such as the transpose of a matrix:</p><figure><table><thead><tr><th>Graphical notation</th><th>einops / PyTorch</th></tr></thead><tbody><tr><td><figure><img src="https://reader.miniflux.app/proxy/iUwPKcnT_UDEGiSAbaXJH5ns0r6zSvzyNMeyQvovB6Y=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91bXF0eWVqYThseXYzN3Vyd3g2cw==" srcset="https://reader.miniflux.app/proxy/vbrhJexPyZ8Y2TWdPU3WGUlQ2HNIJAvyTsY-IDqYX7E=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9pNXZuZmVxNzF3b2pxdjZtemN2bA== 140w, https://reader.miniflux.app/proxy/gt3kNSpzel5819yrYgNQ31HQRa2B21XUpgBCs4yM5xA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xeTNmMzFvdXNiM2NyazhieWo0dA== 220w, https://reader.miniflux.app/proxy/gEezMW4bGUrYNd_uo3go2Wz2iiLPLetFggtEv-s1c70=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9idWI5Y3B4dDBnNjhseWVuamxuYg== 300w, https://reader.miniflux.app/proxy/hWAHYS59Ayg3jFPsGrkL5vGeBYVJBAnrYGueX-cnvds=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ha20yaDM5dWZyNmQ0d2cxcGhnaw== 380w, https://reader.miniflux.app/proxy/FF7D-NrNJ0DNSYfWlsCMkcZE3ihMjqZaF-RStxpN9os=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9sZTB1aGJ1d3Jpbm5rYnh3cndtMQ== 460w, https://reader.miniflux.app/proxy/w4shfnTJLr2eD8XTTPh8eWO2IVqCNon0Ky-nsoMBZWg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jczM1ZWdyZnN2YXdkZ3k2aGNlYg== 540w, https://reader.miniflux.app/proxy/bfRn2PytfT1eSuTJsAkhPY0PSm8QHjYlJyCj_OxWouw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9za295ZnphY2I5ZnJrcmJ1ajludw== 620w, https://reader.miniflux.app/proxy/eCYmmdGYTm74lGl_BzhLRayHyLPJAj2mC49OWABWpzM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9paGhvb2N5NGtvOHp6cHQxOWp5Zg== 700w" loading="lazy"/></figure></td><td><code>rearrange(A, &#39;i j -&gt; j i&#39;)</code> <br/>or <code>A.transpose(0, 1)</code></td></tr></tbody></table></figure><p>the rearranging of tensor indices:</p><figure><table><thead><tr><th>Graphical notation</th><th>einops / PyTorch</th></tr></thead><tbody><tr><td><figure><img src="https://reader.miniflux.app/proxy/-K4qzGoQummONxG3_Tpq1Hc5IAs2rOKHBF_OhBLLo6c=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95MTlpd3ZxeHh3aHYzb3luYzh3YQ==" srcset="https://reader.miniflux.app/proxy/WAZwovgsPjZoVPaPVMhb0Ha4RGRiRKpmzkGHV9xDbYI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mY25iM2x4bHJsamNqNnM2YXV3ZQ== 150w, https://reader.miniflux.app/proxy/8vLowXi2eNHBu2XSF56nrjoYKdBnfInoJqW2AjJ9klY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ueWxtczBqZmthYnZ0dnNqb3Axdg== 300w, https://reader.miniflux.app/proxy/ugDrrLWGY-nyuuL5DZU3L1A5i-Hvayl2N0AjeD9xFu0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90ajUzaHl4NWowZG8wdGp3NXBmeA== 450w, https://reader.miniflux.app/proxy/78f5jUwVTBstzwaHQXrr_Yc3hfX8uTPrgWO3DKPCRiI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91ZzRucW9oanA1bGtma3dmbmc5Ng== 600w, https://reader.miniflux.app/proxy/nRIWCOKcUlj5MsPCrNVWJ98u4bdSBC2Nayui2mdzWz0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9uY3lsZG1hdGtpanhmdWRmanlndw== 750w, https://reader.miniflux.app/proxy/qgVrjpQjwKgqrX04K5maU47aiyHqxGGqCCwsG47aNqE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tY3pocW1jc3l5YWtwdmhzMXlnNw== 900w, https://reader.miniflux.app/proxy/oYG9K1a-Gjks8ni4c2_B-4Qq3Ai4EPdInW78pOo8Nb4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mbXN3cWRhMmdjZmRxZDJkZHJ2bg== 1050w, https://reader.miniflux.app/proxy/QWUlwb-MJWS9MYT-MCoAs7NxweEpJCnsGmfrVF8c2WE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oZTFxYXZwcHN3a3J4bXhvMGh1bQ== 1200w, https://reader.miniflux.app/proxy/DdcUmELM9fiQ-XPbmiLRioLG322MrAOlE1tbrajCvEU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wdHpoZmFmaHppcGd2ZnFhanh4YQ== 1350w, https://reader.miniflux.app/proxy/NIp2fEWPRXpRjpmr-lszyz6CEpRfarNJPofzPbRWR-E=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9weGpwY2tnbnp0aG03M2VpdHF3Yg== 1500w" loading="lazy"/></figure></td><td><code>rearrange(T, &#39;i j k l -&gt; i k j l&#39;)</code> <br/>or <code>T.transpose(1, 2)</code> </td></tr></tbody></table></figure><p>and the reshaping (flattening) of a tensor into a matrix by grouping some of its legs:</p><figure><table><thead><tr><th>Graphical notation</th><th>einops / PyTorch</th></tr></thead><tbody><tr><td><figure><img src="https://reader.miniflux.app/proxy/vQwA7rmJITJL2UP_VC6lxJRuU1H19s1HXJhaPSG6GNs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95ZnZzem1mZzVkcnpndTR5NXNlbA==" srcset="https://reader.miniflux.app/proxy/tzhwVqUbW40mUz3tzrwJoUz5PKgiDh3qNs6v2HEG0bo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90b3Q3bnJiNTBwd3pvY2Q5bmc2ag== 300w, https://reader.miniflux.app/proxy/_Ff0CyVSf-pA7evbPl_grVA7t9gstRlNuFXTp6zaQ5g=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92a2RoM3N3NGRpdmh3aWZocnJqbg== 600w, https://reader.miniflux.app/proxy/HWI31pTZ5D-HSPI_l8qrR4mAPXk1q7EAEheWTI9tDO0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94MDBiaHlwbjhrYXd6dXV2NjQ4Zw== 900w, https://reader.miniflux.app/proxy/pjzpgTI-fGm2yKQ8nrHguFzuH367Dr1T3-yr1oMtZD0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mZ2dmaHVwd2ZpZGJ2dnVqa2w0cQ== 1200w, https://reader.miniflux.app/proxy/9VzUWixAu7MOgOkSD2B4OIWiyWiE8coDskHlaCU2hyY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9lMmx3Z3I3amlwcHR5bXE4d3FkbA== 1500w, https://reader.miniflux.app/proxy/5WVY8eoAEwMO3-V9J2Jaiq1Josw1S9Y90cSFSPnbMwg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ybDE4cGw5eXZmeDFlYngzOHk1Zg== 1800w, https://reader.miniflux.app/proxy/Rwh_l7mbVSW09WDnPNwIauOpw2b-pmCaXLgIUXn5a2s=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oaHVmYWV3cXRtbGhoOHdhZmdwZw== 2100w, https://reader.miniflux.app/proxy/dY2RdMK08KxR9WHkGQbXMh02IoSsrLLq-xIrnxjJO5Q=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zZ3ptbHFpYXB3MmFtZG84ZHlyZg== 2400w, https://reader.miniflux.app/proxy/7GZEEbuaDFFQKbdbTuQUvL5S0yIJGYdplYHtaTyJx-I=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hYzRucnppa2c2c2hreGpteW1ieA== 2700w, https://reader.miniflux.app/proxy/2pXRyVaZWEKaKIXAsJ7B8ei2dixj95N1L5LD9lxaepo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91dDN1NnRjaHo4d3VmdHZpbnJzag== 3000w" loading="lazy"/></figure></td><td><code>rearrange(T, &#39;i j k l -&gt; (i l) (k j)&#39;)</code> <br/>or <code>T.transpose(1,3).reshape((T.shape[0]*T.shape[1], T.shape[2]*T.shape[3]))</code> </td></tr></tbody></table></figure><p>where thicker lines are used to represent legs with a larger dimension. Of course you can also split legs rather than grouping them:</p><figure><table><thead><tr><th>Graphical notation</th><th>einops</th></tr></thead><tbody><tr><td><figure><img src="https://reader.miniflux.app/proxy/H3Ivliym7uc6TuGSgzdkU7Ef6T7VrOShXbrpFAqCF0k=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oemRoa2RsNDM4ZGRkcmJzMW11eQ==" srcset="https://reader.miniflux.app/proxy/8CrnKO-d1p0am1LAOBgCcIkZ7b51kE5eYG6r4Y7tLUc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jcmR2d3BxYzRmeW1heW01MmN5cw== 300w, https://reader.miniflux.app/proxy/Z47NwOJDIchJ7M2FXSeAPi8FWOv5aXrdt8hzipum6i8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94a2Z1dHU5dW9qbm1mb2c4dTgwcQ== 600w, https://reader.miniflux.app/proxy/99gR9gFhAVvYMu5ReGZqw7JyhJFZv3ux338YkXm2sOY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vZWF4cGVxdG5nYXppcm5qbW1sZQ== 900w, https://reader.miniflux.app/proxy/UvwemH2RzRthyNLNXPeCSdD0kQ67fM46Etju910GQpI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mZXd5Z3FheHU4a21raWV2OWh5Yw== 1200w, https://reader.miniflux.app/proxy/mrcfiDRRL_WTNKEV_anDr9MKGy59k4dx7kQ9IY-i0bs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zeHE3ODZseWoxZG1oanZtM29hZw== 1500w, https://reader.miniflux.app/proxy/fxPLIS_JdM4v7QG1K8jGmKgYzFUIb9jD_JNOcG7Z9Fo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94dnBycml3Mm1wemMyeGhxbWxjZg== 1800w, https://reader.miniflux.app/proxy/ehMfBaPva8N6DX8kwI-gRnCyNICzg0uwENwChstGNrY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9kenAzeXFsbGN3cHczdXM3ejZyNQ== 2100w, https://reader.miniflux.app/proxy/IFxAF4BBybLkkUXFIXDkMVc5HbGDGMqv-wj-2Pp1fl8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qY25ibTExZmZ6bXlqOXlyZ3FxOQ== 2400w, https://reader.miniflux.app/proxy/THMJ90gqdAT_EkbZiIJJW9Ipzzbk1fkOwPbvYX3YJGI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91amhka2t6aW9ucDZnd2xmdnl2Zw== 2700w, https://reader.miniflux.app/proxy/c67NyMlFfI-a015iwr4WYZwgfwZ5TYevjw06zXLcWmM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9idmVpM2NzOWQzcHNlZ2RvM2x0OQ== 3000w" loading="lazy"/></figure></td><td><code>rearrange(M, &#39;i (j k) -&gt; i j k&#39;, j=int(np.sqrt(M.shape[-1]))))</code> </td></tr></tbody></table></figure><p>Various relationships also become intuitive in graphical notation, such as the cyclic property of the trace  Tr(AB)=Tr(BA):</p><figure><img src="https://reader.miniflux.app/proxy/QM890-Z9karOX-Gx23b_XAuUZTaW944su7hcjBX7ucA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zYXB0ZDRkZzh5ZncyOWlrYXpvaA==" srcset="https://reader.miniflux.app/proxy/Kwx1WSotzLVZPNBOxMhAN6XrQmUdiCvNR-sinOT9f1I=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9uY2h5aW9xeXpnYnRnNGVmZnA2MA== 300w, https://reader.miniflux.app/proxy/_fu8V09d3CdL5adFUbVrltn7owNyrI_lrrZ5CL4uAKM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ldGIxaWh0b2d6b205bG14aHpodA== 600w, https://reader.miniflux.app/proxy/E1dbmpslNi1tIHRe6jZiRHbqCeXs_K9cEIZtOWk41KI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9reWQ5cHdhYnBvcnp6cmp6dHR2aw== 900w, https://reader.miniflux.app/proxy/KFHvfsJq8NdkWPZNbtQk5BZIoY0bfjmUdw_LRYUj87o=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94enh2dHl4bmFkb2xvZHpzZGN5aA== 1200w, https://reader.miniflux.app/proxy/uVFtbuE4_NWLNOV_FpPGz2TIZN7rIOfDGCpQWRhjH3o=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ocm53YXdidW1jYmlmZzZrdDR3cQ== 1500w, https://reader.miniflux.app/proxy/jp0gQ0bA47vwzC6C52gJr7lph9p0pMUiPBVWtGCYXlk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zeTFsamlpeHRlbnFlaHdueGx4Zg== 1800w, https://reader.miniflux.app/proxy/b8Q3RK4w0acnHgMIjaQqAKBkscAgh1vDBQYrb0x3VCk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tOXJnYXl3Zjl6cXViOWR2Y2d3YQ== 2100w, https://reader.miniflux.app/proxy/eROYeH2KdDnKJ05x4EZK1YxaUdyuEbD6ZdnanQDfrI0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zcXIzZHJjeGlzamJ4cXN0eWJ0Yg== 2400w, https://reader.miniflux.app/proxy/2YZwEUmj3r8Rj3sMbKTMXcLGlD1ArV9x23zQQYdlLCc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92cXZ5dW5yM3pheHJ4ZWx2dTFkdQ== 2700w, https://reader.miniflux.app/proxy/-V9ZvUf1Fl0oNIkXGWtBHO-7UYwnJ3_Jg-c8b6ZVJWg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93dnhxdm5na3RtaXpwd3hlN2Rkbg== 3000w" loading="lazy"/></figure><p>Or if you prefer transposes rather than upside-down tensors:</p><figure><img src="https://reader.miniflux.app/proxy/n6GHkM08cXh4RZMqgsFJ0k0L6cP0ubzfPnQahSoI8MI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wYmZxb3NmazVjZXpoZTgxcWxnYQ==" srcset="https://reader.miniflux.app/proxy/lnumKy5a8ynSDiHvA1Jb9kqvZrYcT0RAZdNg7s-5dtk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9teWluOGk4cm10aWZzbDdiNmVicg== 460w, https://reader.miniflux.app/proxy/WjDXF6azxZhS2DH92y4T4K39kpZPyKjJoqa6m1VkkWs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9pMWV2bHdpanB2end2Ym9ucHl1Mw== 920w, https://reader.miniflux.app/proxy/WIVmpu1O0PJ_OnHzo4EQats4u3HYjgAyUzfQpxCxOeo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93dXJkaWp0bHJrdmRrZ3NmcjIyZw== 1380w, https://reader.miniflux.app/proxy/ps-54Eb9Q3Nh6cL4oaq_wziSWZcjiLG0kLJ6gEEFeAs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hYnRwaGlxcWx0YmJkYWd0djl0Ng== 1840w, https://reader.miniflux.app/proxy/fzFkTaQHGrpY1uAp37gHirJerOYVC8lCZx6m7SMwLyA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96enRxMmU0dmZ3ZWI5b3dheDNmaw== 2300w, https://reader.miniflux.app/proxy/HVNLZ4LlEALP1bTqf4TMmPE981SXNQMsGssRQhptyQA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hZzJ5dThpY2gycWljaHllZXo2MA== 2760w, https://reader.miniflux.app/proxy/8kk5X9w6QStZ8wPE20RXJ83xL36KSnCZNDGR1VsexNU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96NndzMXZlZGE1ZzJwZ3Y2ZWxoZA== 3220w, https://reader.miniflux.app/proxy/IBYebO9XzkzP0ahv1-VIS8oOw89B7_oMrEpuUGSDo1Y=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91azU3eDRieGlmMmg0a3F3cHpwNQ== 3680w, https://reader.miniflux.app/proxy/--RY-WBAlXhzTt9vyIdlXr_fdDRg7y4FdK1TNjgEg88=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zMGVmZzVtYnZlcTA2b2FiZDFveQ== 4140w, https://reader.miniflux.app/proxy/C58LNNpwo7HCAMKxdJnrteu5JeneEs_YFq2bZMH1RQs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9heXBiazFrd2piYmVheWNmdWFpbA== 4575w" loading="lazy"/></figure><p>But graphical notation is most useful for representing unfamiliar operations between many tensors. One example in this direction is  ∑αβAiαβvβBαβj=Mij, which can be represented in graphical notation as</p><figure><img src="https://reader.miniflux.app/proxy/k21uB6aUZ0VW0vsfl7dX06dBh6vuWP2d8tQv6Tn1qqc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9iaHl1bGxhODNpZjJ5Y3lubzg1dA==" srcset="https://reader.miniflux.app/proxy/YTnbQrE6GG0mCjN7WwXDoQ1JETmUDOklqGfXKx6Tr-0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9keHRldnZpN2tpZXN4bWNiZ3d5cQ== 200w, https://reader.miniflux.app/proxy/feFTN27d-MSJivgH0PQhdkAxVXHuShbeyjdyU7r5iTo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vcXdjcHEybWRxc244cnpxZ3Z2OA== 400w, https://reader.miniflux.app/proxy/PKZzvTLYAM6uAs34FC2Rr5GTut19WOWZns6bDd7RjX0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96Y2RmbHZmbXNnc2F2dGJ5eDg2cQ== 600w, https://reader.miniflux.app/proxy/9_6VKsc9vpgL6JoMRFe4-jtETjraIIkDLSn-qMuwxrs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94eGQ5YmR1MmoybXN2ZnBzeGhocg== 800w, https://reader.miniflux.app/proxy/LsTJ5W-b-C_qw2RtYyv3UlBy4CjQF78RnJK4fRMXhn8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9lb3NyYWE2eHVhdm51YzZvdWFkMw== 1000w, https://reader.miniflux.app/proxy/JEVdvrM6RTtyqqPcZp2EsbJvwh7gjX3VMLpQ-QdfNsw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9yaGZieDE3bWF1cmZlZHk5aG9hbw== 1200w, https://reader.miniflux.app/proxy/R1YfdFbs6GeDPOtMrEhJZ53zEqlHtNMIHYOXzbVQInI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wcThudm5vYjhpbWtuam16ZW1uZQ== 1400w, https://reader.miniflux.app/proxy/som0yARFGGzqRWs2fcwrKQAuTxLhgCXmKQ-sMQcp1ro=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91aGZ5NmZveHNwaWhsM2ZsMzNhcg== 1600w, https://reader.miniflux.app/proxy/E8SpnY8UqefUL7KYSxBAlbj1zlySo3ZYBeMEbC9ERPU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9scTZoN3ZkczdqdDJpZnFhczdudQ== 1800w, https://reader.miniflux.app/proxy/tlqG8TiHbDLXNnLghLVm2wGAKeRn6YPMOLo-_Q0btx4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92dHc0N3NjcnN6ZWdieHRwdWpzdQ== 1920w" loading="lazy"/></figure><p>or in einops as <code>M = einsum(A,v,B,&#39;i α β, β, β α j -&gt; i j&#39;)</code>. The middle part of the graphical notation here shows that the number in each i, j position of the final matrix can be calculated with a sum over every possible indexing of the internal legs α and β, where each term in the sum consists of three numbers being multiplied (though in practice the contraction should be calculated in a much more efficient way). </p><p>Graphical notation really comes into its own when dealing with larger networks of tensors. For example, consider the contraction </p><figure><img src="https://reader.miniflux.app/proxy/5klTxiI5w1QjVXJS56MVz8EsP27tGv5wbwRLaXb5vhk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90NDJuZWdkd2VuZ3hpamNlbHFwbQ==" srcset="https://reader.miniflux.app/proxy/evp7CEiG30BJDvZ7lXYF2fbKxtguTUh7WMdo-BAIfZM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95MDI2bzdmdG9sdjltb3dramRhMg== 110w, https://reader.miniflux.app/proxy/Thod72UwUkgw2gdgt4eAswLszreq8RCQd1KLQDPi4ys=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wYXZhbnFvNXJrcGc5aTZqbGJ2cQ== 220w, https://reader.miniflux.app/proxy/-pnU-MmJeTcb5ngmqi2PxNyJgy7QCkmUBUum-Ixqtmo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tbjg1OGEycHVseGR1MG16bG50Zg== 330w, https://reader.miniflux.app/proxy/eQy44JYgQmH72ObY3PNrFMgmpSM8d7m0dvkSYATghDk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oZGVwbGNjZWE4YTNlOXZvcHh0dA== 440w, https://reader.miniflux.app/proxy/6d9Ivao2ucU5Bt0wS9ExBCUclukRYrLixio2wJn0KPE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qdWRtd2FobGMwb2dheno4cG90MQ== 550w, https://reader.miniflux.app/proxy/2FespF8IKZ37jHMgdMZfR2PqLBfjE8YVlYlRI9LR3-g=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9kOWZrbGE1dm81ZDR2b252a3FjYg== 660w, https://reader.miniflux.app/proxy/dnb10uDA26gnAXvRTc7rUalKe_xu0T716x6N4JKFqTg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hNjU0em5idTIxdGRxeDdjdXVnNA== 770w, https://reader.miniflux.app/proxy/23AC1mCp9ywR9N0bc4aBJ82IVER5DL9O-wfWZ15MQkk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9nN3lhOXZ0aXZmbDNham9hb2RsZw== 880w, https://reader.miniflux.app/proxy/EOnkI6PC6U77bScFlKgeq2WzZKbfRxWkq36mSrl9a70=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tcGt5cGU5Z2RlYjNrcTBvaGhuaQ== 990w, https://reader.miniflux.app/proxy/WBQnGuOMASO77NMtfoMKAZSrIl8JSxdfcJr3Avkzbhg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9iZGJ5YmdrZHJ3NzR6cGc0OXU2Zg== 1072w" loading="lazy"/></figure><p>which is tedious to parse: indices must be matched up across tensors, and it is not immediately clear what kind of tensor (eg. number, vector, matrix ...) the result will be. Needless to say, the einsum code is about as bad: <code>einsum(A,V,B,W,C,X,D,Y,E,Z,&#39;i j, i r, j k l, r k s, l m n, s m t, n o p, t o u, p q, u q -&gt; &#39;)</code>. But in graphical notation this is </p><figure><img src="https://reader.miniflux.app/proxy/tN4Cmozao66VZyX_AjwHjRzrcPU36GklWtCMapC0Tdc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94NmtycXdraG1oejE3MXBsbXM3dA==" srcset="https://reader.miniflux.app/proxy/UnWI9TmQZsq5oeiv0Zd3L6XNIaPHLGfVSRBay_MmYLE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9pbHc2ZmpqZXFlanhiYzNkcWZ5MA== 200w, https://reader.miniflux.app/proxy/0MIHk11nRu0iXDA_Z2CLUGll1_SqqeGtB0vBge1lSuw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9pcmhybHZzbmd6dzdtazA3bXNmNw== 400w, https://reader.miniflux.app/proxy/vKpURtbPkNLl-ri60nPyYe57N-r9n68QJjrOBlLUESo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xdThsYjdmdnFqbzlnbGlud2Robg== 600w, https://reader.miniflux.app/proxy/uxGG7J8taeTyjULIxfmco4zSEDzuz5iexL9V4DRQqog=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tdjRkaDBqZjBhZ3JtYnphOWN2ZA== 800w, https://reader.miniflux.app/proxy/ZkTF4qIX2tFHUDMPSBCIo56IiiTlwmzOCoI-4kIlckc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zb3pvaHRyN3N5OWJ1NjB2cGJpag== 1000w, https://reader.miniflux.app/proxy/qtn1jUwt3EBHD8yCc16S1JfbvVcbN5bXlQugzbFVC_Q=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93ZnBmN3UzbmhxYWF3d2t5eXhxbg== 1200w, https://reader.miniflux.app/proxy/dzjOueRx_TA6SzlsA9rHdFHXqwgzRymhIIOmLu8A86s=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ldzY3OWZicWVuYjR2aGU5dXFkbg== 1400w, https://reader.miniflux.app/proxy/9ZeIJLSSKSHKv9CqkBRZs-5aNODcWiYIqJEgNGzYatY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zY2I4Nndwd2VrcWlmYmx1eDRxeQ== 1600w, https://reader.miniflux.app/proxy/tRf8JtgmJxOiM974a-DY_wpmarnJzxH5edL6s_8ABGA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91bGFiYWV3cHB2aWQ2MHZnc3Zmag== 1800w, https://reader.miniflux.app/proxy/EFzJqxmBWMYDNKeijuRGxvu7vzutJkqUY1B9G4K6j0k=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9rc2F0eHNoYm0wOGExaHVxYmFsdw== 2000w" loading="lazy"/></figure><p>and we can immediately see which tensors are to be contracted, and that the result will be a single number. Contractions like this can be performed in any order. Some ways are much more efficient than others,<sup><a href="#fnh1buayt8oo">[5]</a></sup> but they all get the same answer eventually.</p><p>Tensor networks (einsums) like this also have a nice property that, if the tensors are independent (not copies or functions of each other), then a derivative of the final result with respect to one of the tensors can be calculated just by &#34;poking a hole&#34; and removing that tensor:</p><figure><img src="https://reader.miniflux.app/proxy/_Y9g0szSiQRg_JaqXfKythljNdXe0rs4v8HXZsh125w=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9maGxmNmRlMHN4bDl4dmUwdzJmdw==" srcset="https://reader.miniflux.app/proxy/DL3N8AvXg4PTiSkEmUWXT8pCnM1j8SGXKBqmkujgcCk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9haWhleXB3MXBiZjZwYmtrZXRjdA== 200w, https://reader.miniflux.app/proxy/FPHxqEo4dDX8fAyaGarDQgp2Xwa1tj0C05OwdSc-0Vk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96MmZnNHliZ3dldGRjcjlxNW5yZA== 400w, https://reader.miniflux.app/proxy/tlw_7R-uWEzCdF8f6HJqTnoyqINSOEWRAYXs0wrTsIM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9renFyd2ppcGVsenBueHJveDhnNg== 600w, https://reader.miniflux.app/proxy/OJL0_MdexTZyjQn9sEjAtHrr5gdCh-cUf8TYdlypQBs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92dHltb3huZ3dhemdtZWUzYnF3ag== 800w, https://reader.miniflux.app/proxy/cEmfNYIO4sDVOLvvHW9BOHM-sVHYUsQ3Ge__9_EjRCY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9pa2Vodng4MWpmZGhkdjBwa2I5Zw== 1000w, https://reader.miniflux.app/proxy/MOBVn8IxjuK6DQ20Pv5IvqE0ts0eCy7h3_ztSPpcAeM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ha3hkcDZ5a2Rkd2R0OHI1Y3p2Yw== 1200w, https://reader.miniflux.app/proxy/_xr-lhXK8lXgTAWJ3G7LxIIYlj2Ozx6yBepJGebOfzc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qejZ6NDN6bGZ3dnEyMjJxd3BxYg== 1400w, https://reader.miniflux.app/proxy/e4tnlWBH0Z4fG621JE_ih3DKBk307_4uWIzzf5etEJc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ubHd5eWE3aWQ2NnJocWJ2cWV3bg== 1600w, https://reader.miniflux.app/proxy/k5tC6acMa8iXdP6ewqWNONxsPhLaC5kkVOVEmg45S6U=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9sYjlxaXJmM2ltOGd2Y25rbDk1eQ== 1800w, https://reader.miniflux.app/proxy/BIWs30m4OH4vyPI5kaiEIvPq5FgRhh0fO4MclwxlOL4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xbXRleXVycHh2ejc0eXEwY3JidQ== 2000w" loading="lazy"/></figure><p>this is because einsums are entirely linear (or multilinear, at least).</p><h1>Special kinds of tensors</h1><p>Different kinds of tensors are often drawn using different shapes. Firstly, it&#39;s common to represent an identity matrix as a single line with no shape in the middle:</p><figure><img src="https://reader.miniflux.app/proxy/SJvbC1NQYxfxGcbLx5uZOxjb6Rwx5penSjLnc_iR5Oo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wY2phdHoyamR4OXJyN2U1a3d4eQ==" srcset="https://reader.miniflux.app/proxy/SoW5UEgHs7ePd53kx4nl7OiEUgEp-dBFjzsBzOaok8I=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hZDhqM3Z3eGtiNzgwenliZHdtag== 130w, https://reader.miniflux.app/proxy/TJtmsbCtBv3YZbqCBccPDbw17oRLwvF9EBG_BqN0Tjo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9nMjJsNnRuaXkzZWxqMG14eHl6eg== 260w, https://reader.miniflux.app/proxy/3MVO7kKhVcvYOEA85sPt8H-4WpwrEHhoJdgvmGUFSoc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tc2hzYm40bWowaHpueGd5cHlrYQ== 390w, https://reader.miniflux.app/proxy/T_avny7UBCVu3oKnXpe6JPRKH_TM6pZs3vW20zVIqI8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90bWpzZWhtaXlyZWtkd2xra2l0OQ== 520w, https://reader.miniflux.app/proxy/-ssdpmCq_dZaHeaoyMp14Eiv9dRGkD1e5lnspUESMfI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9yYm1vemw2dnlwbm05YmNiNGtvcg== 650w, https://reader.miniflux.app/proxy/aBtoWoyTFmsr8G72UBMQGy34PyZ1l_RgCbEvQ9ng2rs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9iZXVwZ282N2JoaG1pdG56YjB6cw== 780w, https://reader.miniflux.app/proxy/3mvB6EGo0Im109uqAhlZIH5DLy2e0ZNSqzvFGuDeecE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vbDVvcmV1c2tvaWNmb2kwZ3Nlag== 910w, https://reader.miniflux.app/proxy/eiGcl_md5RZWjcVTC4g7SjA6BOuK8j-dXHcrZIHa-eA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ib29peWppb2d1ZWd1a29ncG1icA== 1040w, https://reader.miniflux.app/proxy/Qy95agiejZy8xF9F4a4qRYSvBx5_qDUZ6cxCpmiBd-I=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vcXdmNHJxcTBqa2FhcGJ6aWJraw== 1170w, https://reader.miniflux.app/proxy/y0I1aJramPZvGIu0SWuPtbPATXBTbOzZlx96CTa6cgE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9pdWV6bnBqcXB2Y3hvd212N3NpMQ== 1209w" loading="lazy"/></figure><p>(or <code>t.eye(2)</code>) where we have used the delta notation δij because the elements of the identity matrix are equivalent to the Kronecker delta of the indices: 1 if i=j and zero otherwise. You can also extend this notation to the three-leg delta tensor, which has ones only along the i=j=k diagonal:</p><figure><img src="https://reader.miniflux.app/proxy/F5H4X3z_iqCEppzyKRizzLjHUDXv8zLD-Nv_dy7gHig=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93enFyMnlndW9tMmRueHE4cnlqNA==" srcset="https://reader.miniflux.app/proxy/qWFvgWzFSpYnqr7rGrY6-Hd0zdEszoWuoCS9_bMXzjc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mdWJ4bXVlaXJ6MmNldGtueW5nYg== 130w, https://reader.miniflux.app/proxy/0wCRaF4qfAEN-_hm7mOVZ_1c2HvByr0WlvvtxGywzzU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90aXJjdDd3ZGphdTZkeWp2dmxpNw== 260w, https://reader.miniflux.app/proxy/YSesUcWTrgxDXkJItVoxtyWHvMxfkjg0_58dtK5Hdfo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96bGl5M3ZwZ2R3aGpoYW5pcGFvZw== 390w, https://reader.miniflux.app/proxy/rPA_DKBQjnKNL9uPsQuGGP8SfSk_bENuzDUbz2ZnlS8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jbnZnZTl3ZmVhNzZocXRveHAxYQ== 520w, https://reader.miniflux.app/proxy/uSJEpyopYWKzRYHuqFAHRMfF7f7AaVFk3jycQta-aGc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9sbjBxZGpsdjkwdG1tdmF0aGthdw== 650w, https://reader.miniflux.app/proxy/j7vYPdWY-OXgafU3UtaPe09GdOO4SLU8xsz5N66KBzc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vYm50Y3J4aHNqOGYzemdhajY4eg== 780w, https://reader.miniflux.app/proxy/cGFgxVk7k4y5y2kjWFAziMK4Sy-JB94IolyxWxkqoDY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94bmt2aHdyNzR0eWRydzhhaWdkZQ== 910w, https://reader.miniflux.app/proxy/S8wSY8eqfok3dOABXHziOpe4Qn1Jbu-qy3d8SRPbFUQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tY2o3cDR2Zm1kbmViczhkZXJldQ== 1040w, https://reader.miniflux.app/proxy/tLUPMhWVaujloOePQes8RhaxABQbJdklDCV7Tt0TuJM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9leG1nYmkycXBiY2JsOHp2aHU5dQ== 1170w, https://reader.miniflux.app/proxy/3bL3b2Q2l9hcGXDVfMkz2v6TUU0UoewiYnj7mzeDSq8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90bWlvY3hrMXJ0c2hjdGdtaGp0bA== 1262w" loading="lazy"/></figure><p>and so on for delta tensors with more legs. Among other things, this lets us represent diagonal matrices using vectors:</p><figure><img src="https://reader.miniflux.app/proxy/skw-JQ8KiBOM8RMUXpgSIm3gSmDusReF9urRidRP87U=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oaTA0eHVnOWRtcjRtdHRsN2Zubw==" srcset="https://reader.miniflux.app/proxy/Q_oF331Hf3MHzj7U0VuCXgZrWcoxT1xcfORFa_LX5QU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96d2xmZXE0ZWJlNWw2MWljYmJyMg== 88w, https://reader.miniflux.app/proxy/od_gY_u3dz1Rk931kMoTqYSgWfPd1s96qsWJ1qYbjwA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9rcmRyNGlsc2h0ejA4OHJ5aHM1cg== 168w, https://reader.miniflux.app/proxy/lJvMgvhOTY62t5APD2ERwyRWgWiT51qFksOr-4B2w18=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9yYTlmcmtsY29odWc1N3g5azY1Yg== 248w, https://reader.miniflux.app/proxy/zDjW2DzjJW-X1yVK8agFi4JYXEquxynnGWFyIChDDO4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hYWEwbnJlMmV4cnRqaXpjeDVyOA== 328w, https://reader.miniflux.app/proxy/4tbMTz8DQP8RZHPZvh0HRoCxoIEdGrumzH-3TgL5rFM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ocjJ6ZXc5bHZjbzhiamh0ZGJrZg== 408w, https://reader.miniflux.app/proxy/jU9HvCEEF6nsGpCFJBveicu6fFKj_q0meGEdZtWBUnU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9lYzJrc3MxZWQyN3R5eWdtNmtmeA== 488w, https://reader.miniflux.app/proxy/imfMc67MYDu-skPr4-7c74SZLnu2kw7zSNXLVlPgcEs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9pZG9xZWdoN29yYnl6YnhiNTFmaQ== 568w, https://reader.miniflux.app/proxy/Bgy1s3e5oLqrBc6Xxbc5pePZuY2QjpiRbQ4sSeJ7ZyQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qOGdjdGFvejFreDBwNm5ueXkzMQ== 648w" loading="lazy"/></figure><p>where the vector in grey contains just the elements on the diagonal. Typically though, it would be inefficient to actually code a contraction with a delta tensor made of actual numbers: it&#39;s much faster to just rearrange or reindex the relevant data directly. Still, whenever you see any line in a tensor network diagram, you can imagine a delta tensor implicitly sitting there. </p><p>Triangles are often used to represent isometric matrices: linear maps which preserve the lengths of vectors (eg. performing a rotation), even if they might embed these vectors into a larger-dimensional space.  A matrix V is isometric if it can be contracted with its own (conjugate) transpose to yield the identity matrix. Graphically, </p><figure><table><thead><tr><th>Graphical notation</th><th>Math</th><th>PyTorch</th></tr></thead><tbody><tr><td><figure><img src="https://reader.miniflux.app/proxy/juixqCQPb43QnndBoI7VH72bfEq64N69l77PsPr6CyY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xdWtjbmFmMzhrbnh0ZGdkMG5nMg==" srcset="https://reader.miniflux.app/proxy/9-ErnjYfdOzV5PygFYmPLquOWMEcBNuc3-ftxmA2rgc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9kYWVkeWkzOWplem14eDFvaWVlcw== 120w, https://reader.miniflux.app/proxy/P7XeN5MvIhWWwxuEsvd9vRJbIqbhFw3mRKKGYAKM8UU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92YTcyaXZhZWU2aXN5Y2JuazNydA== 200w, https://reader.miniflux.app/proxy/5sIoscikFZoXJtmvuvymYaJEQK0A8XX-pZBMnDNhYy4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9lNGVnM2p5cDNjYjZlc2NjaHBrZg== 280w, https://reader.miniflux.app/proxy/JueIkQlIoIyVpcw_lp3h0FZvtJAWDcb1w5b83A_BqQw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mZ29jYTdrdXlscmc3ejBseWl2eg== 360w, https://reader.miniflux.app/proxy/JclMyGitelzXFaaQDGN_-kotG4W-UWvASXkIOFQOyzw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ldWdvZzVqYXNnampjaXhlZnl3bw== 440w, https://reader.miniflux.app/proxy/J2C2KGmmJXHewqfx-LnkixnFa5a1wjWhUdhtpKDS7eU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vYmg5eWplNmNtaXl2bzNtYXluOA== 520w, https://reader.miniflux.app/proxy/Y_HcZedn6PZopyB7zK77KTGF8PKbfz8DaLfYhHtcsic=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ucXA4OGFnMGhiOGZoc2d6b3B4Yg== 600w" loading="lazy"/></figure></td><td>V†V=I</td><td><code>t.transpose(t.conj(V)) @ V </code><br/><code>== t.eye(V.shape[-1])</code> </td></tr></tbody></table></figure><p>where the tip of the triangle points towards the smaller dimension. However the reverse is not true when the matrix is not square, because some vectors will inevitably get squashed when mapping from high to low dimensions:</p><figure><img src="https://reader.miniflux.app/proxy/kiGlPaEKHKweXzpySwocR8qRB7x9SereB6R_H3VMGyI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93a3NkbmxpYml3ZmtqdmRoYmF3bw==" srcset="https://reader.miniflux.app/proxy/ZJ_1I4gQeYGLaMVA3wN6scA0Z35bTYvnJKKS6qhUZIo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wdXJuajdrOGRheG53a3dwajE0dQ== 129w, https://reader.miniflux.app/proxy/U8Gk5B6TftJ6MFMSSWCdEZSjRqcEhWqVQHAiZWwezX8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9sa3V4ZnN4ZzB0cTM4a3RuczN5Zw== 209w, https://reader.miniflux.app/proxy/CY1M6HkvD6VldaXTmZ3VxAUloKh1Lwsb1Lw5mn3vqGw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ubnZ6b3R6ZmdveG9pNnJtanBibg== 289w, https://reader.miniflux.app/proxy/pqW9p3ULBNK2wEbKsFD28ChHtJhy-wuYvebOee1FHJg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9sdm9tcm5uMGFlMW5mendwbWg3ag== 369w, https://reader.miniflux.app/proxy/DaMdJBa9gc4rNhdiCf8JqrN6K5YQuOuIE0MrJcFloUI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91OW9hdWFzcXdlY3RkMmhxZXNmaA== 449w, https://reader.miniflux.app/proxy/Uim_hyStItDpnwZ3K2ktLMn5531DqoNGu6EU0SvhQxM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96NGpuZ3Q1dWJ6cmlqcXJyM2E1eg== 529w, https://reader.miniflux.app/proxy/7LEVzA9bvDmJvy2XM4-AEGNrH74PKiAJGPmwSlKK6nk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hY2lrdHl4YXo2YzhleDQ3ZGlsNQ== 609w" loading="lazy"/></figure><p>Square isometries are known as orthogonal matrices (or unitary matrices if they contain complex numbers), and are often represented with squares or rectangles:</p><figure><img src="https://reader.miniflux.app/proxy/SjzXS7SP1Ksz1LUQF6elxwI3tofxvG8cvEEoeAMXXP0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zcGowNDM1bGYwdzhidXl0N3dreA==" srcset="https://reader.miniflux.app/proxy/RLws-Jmx-fYG3RtTMc22NhS1O4wkLr-N8tFQk-Zx6mw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96Z25sejRmdDBvemhlNnQwMXE1aQ== 110w, https://reader.miniflux.app/proxy/JV2YhU-Q1IhxQvTp7zs4EWnsY-yQIiE0LZwQjW6WzKU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zb2E2cms4c2JtcHNtcWdkeW56aA== 220w, https://reader.miniflux.app/proxy/IZ-Mk029T6Me36mooyY7a-GNa6GNNE7b6J7nButYDt8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92NWFsbmdjZXFxdWtwODE5YW1kdA== 330w, https://reader.miniflux.app/proxy/DeBUB_HIgeQbw53v095Y9KD4ZlNVpi5cV8qzzwDXzWU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9nc3hsZmNpcXU2Y3ZhdXBqcXRuMw== 440w, https://reader.miniflux.app/proxy/kbr2q9ZRSii2hYzblN79S7PVDlN1BtKwRD8YgytQeHo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ybXJjMm54cjlnc2E1dHdseWZmOA== 550w, https://reader.miniflux.app/proxy/BFIodJiNUM4EN_EAAtjdlb1R9-JKPqg7ulQzJtEYirU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91c2twNXpzbW5xdWtzNnhvZW15ag== 660w, https://reader.miniflux.app/proxy/TemiQwDtNHq0vdCUNqOxI4tv7GNuXVbOzGjcI28Purw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9sdG9vNnZ6Z2lpeXc4c2xzY25zMg== 770w, https://reader.miniflux.app/proxy/GUNujuLNtX5XpxCFIF08yOpxXAVl_7cvALHmWEZGI7w=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92Z3UzbGRvZ3NxZW05aGl1MHNkcg== 880w, https://reader.miniflux.app/proxy/08Jc-sCM6yZmETb9Woy1z5DTHHRwWQgRtb9G0lc-WlQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9kcWloanJzaW8wcnFodmRscnU2cQ== 990w, https://reader.miniflux.app/proxy/iGIzk0Rj5v_1IUTeU6gbLbXmFxps6T92TzrZnPtS1iY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oZWV5ZGFzdmNrc2I0ZWkwcGFxMw== 1011w" loading="lazy"/></figure><p>When isometries have more than just two legs, their legs can be grouped by whether they go into the edge or the tip of the triangle, and similar relationships hold:</p><figure><img src="https://reader.miniflux.app/proxy/oTR0O0CW8TGxCZxKb333UWzCYHV4SR2JYBuq3OQk4TE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9rZjloYzY3Y3RuaGl1ZDdheWZxdA==" srcset="https://reader.miniflux.app/proxy/WssLGf3qW1xEzX_wYSjdQYYlkkPQ006mAhnC4rSpq5k=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9sZzI1NHFiZ3h6MWV3b2xzbGkxcQ== 120w, https://reader.miniflux.app/proxy/NJUGLpEdZUpVZwiJ1n9dCuI_iRAgbQTgvN4VR6x3_WE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9obXY1MmFuamh0djJuYWFhZ2htOA== 200w, https://reader.miniflux.app/proxy/DzNQQ7Rb1ELVEKkDal64VQgEC8CRafXJAbD9yHrCIrc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ybnEzdDFtY3VxcnJsNXp5YWVjcA== 280w, https://reader.miniflux.app/proxy/QIjua3GieUWIDwDYj9cn1iT3VMrdHt9uISyCAWLbZ_o=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mcHN1aWV3Y29jZW5xdGJqbGEzeA== 360w, https://reader.miniflux.app/proxy/ggIDvtuS3WD7MPCRmtGHwycSh1Sbp4WpKUU4CzQ9kbo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9uYW83ZGV4NGhjdXRrOHdnMXFpcQ== 440w, https://reader.miniflux.app/proxy/4j2kKIAfBQ6GQ3c3JfJ6VDGOvtOlvNmTc1a0CqJC528=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90endsdXo2NnRuYTJqdW95cXhuYw== 520w" loading="lazy"/></figure><p>Finally, here&#39;s a silly looking related graphical equation:</p><figure><img src="https://reader.miniflux.app/proxy/FZGtB7rGVa0tkkSyq8nHy6Jq0wWfvl0wQUYrhhaHem8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90YW15bWRmYXh5aWtyNTRwcjVkdw==" srcset="https://reader.miniflux.app/proxy/4suiNJCLNuyIW0Qt_aAtwNSudxoBdna2md6CDjO9KOg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ieXFkc2Q4aGVncmQ3ZHZqdXltdA== 110w, https://reader.miniflux.app/proxy/hZypysgmu-hiNdhGpWQGO4tBk8ENzGDTkUOdWRF3DNc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zZnlhMjlueDFhZWpmcWdrdW1yMA== 220w, https://reader.miniflux.app/proxy/0lkPY78_gKl3ih40Esp2PlZBvGVXiAkokv3olyf61Ng=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9nb3FqdmllNnA5aHZmbjF0d240ZA== 330w, https://reader.miniflux.app/proxy/F2Ow7A3PtTpe88yLCHqP4tVIwwkZZzJsD5AsXGS99kM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zcWQwZHB5aG1rcnJrcXdjYjQ3ZA== 440w, https://reader.miniflux.app/proxy/IFgA3QzpYCcqAY4kugr1HAh7G-eIMY0CXjO3PV5NGHE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xMnFnamJmeHhobXNoY2NyY2pvMg== 550w, https://reader.miniflux.app/proxy/FxYHfogERHfD0F5iKrTG-90YRycMkGZBfAsSXwrFloI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9keTk3amZ2YzZzZHp6b2M4Y3p5bg== 660w, https://reader.miniflux.app/proxy/KjHwTvZ9FixJhpCnKcMOss7mrg2RfaWFDjGeM1kCrnE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9iZWJiZ2xpZHRwZHF1enh4bmRhcQ== 770w, https://reader.miniflux.app/proxy/rnYAF8PwQXSBC4vKW64DNeQV9Qh__E6xct0Ot0ARPYA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94dzcwdDRkeXRob3Y1Z2xyNDFhdA== 880w, https://reader.miniflux.app/proxy/F-q4Q41PXwcnuCMpLeGdJD7JUMIB8O6KlKtybIZQZdI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9iNWgxdDBmcTFianpnYzBydzF5dg== 990w, https://reader.miniflux.app/proxy/AmwobUcyiAmSFHDHfATh3nO9ueN6MghigHrhEmfIkjw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zcm1hdGUxbnFxYnpyNHg5eDBkaA== 1022w" loading="lazy"/></figure><p>It says that the flattened tensor product (Kronecker product) of two identity matrices is another identity matrix. In pytorch / einops, this is <br/><code>t.kron(t.eye(5), t.eye(3)) == t.eye(5*3)</code> or <br/><code>einsum(t.eye(5), t.eye(3), &#39;i j, k l -&gt; (i k) (j l)&#39;) == t.eye(5*3)</code>.<sup><a href="#fn9fzq2gk6z18">[6]</a></sup> <br/> </p><h1>Decompositions (SVD, CP, Tucker)</h1><p>[Feel free to skip to the <a href="https://www.lesswrong.com/posts/BQKKQiBmc63fwjDrj/graphical-tensor-notation-for-interpretability#Neural_networks" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">section on neural networks</a>]</p><p>The Singular Value Decomposition (SVD) allows any matrix M to be decomposed as M=UDV†, where U and V are isometric matrices, and D is a diagonal matrix:</p><figure><img src="https://reader.miniflux.app/proxy/CIxupo6XAN9pc4ng52aqja9lqyZR5jzyuX0lw-o0JO4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9nOXRqcmsxMGEydnZvZDB0eXF5YQ==" srcset="https://reader.miniflux.app/proxy/AWr9n_H42RDxNid_lqfcCf5n9DFp2VdMgmx5xRWWSow=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93ZTMzcndleDJqMWFiaDZnbXE4ZQ== 200w, https://reader.miniflux.app/proxy/vBLLM15uhjlX4nQrHhgn7tblpA1mG_dnB0nIjxAGBWM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94bnFja3lkZnV0cWFoaHQxendoNQ== 400w, https://reader.miniflux.app/proxy/Bqz-ZPzds94taPgMCV6nYZ49bHChJLFmk0cGpYpqXvM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9uMHN3MWtmcW9teGU1a3BhY2x4ZQ== 600w, https://reader.miniflux.app/proxy/0ZwreAx6WgDjtlSuuVi1o75ApWCxnI4RJia3Pg2xEKk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90c3RoY3JlbjRveGhyZ2tmNXIycA== 800w, https://reader.miniflux.app/proxy/as5uhJKM3zMb7GUGcOJL3eLcqb2ld1uahI_loUrfu3E=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95empqam1vcmFqcmx2dnNybGt2bQ== 1000w, https://reader.miniflux.app/proxy/2aLVhmCJIbfAUsPk1FePttnRT8M4t0XAyPjGHUJx6ns=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93ZHRoOHcyenAwaWxlMmpheWtrZg== 1200w, https://reader.miniflux.app/proxy/hIrTuTP-4qsKtuWfmaOb78w0TJmleaJRidXMASo7CNI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ycmhha3o2b2J0Z3p4bGFmYnVrdw== 1400w, https://reader.miniflux.app/proxy/Pqdv2xCyMsSFDTvHnxAmNNsUyhCP-G2sG-x6QWA7kg0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oZ2JnZWdsc29ldWJ6ZW8wYnN4bQ== 1600w, https://reader.miniflux.app/proxy/f1yXeWaYG_8FC277Gxi9nH76yT3aIoiRGPvf5LO554o=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xajd6b2RhczAwb2w4eWMxZGFjdw== 1800w, https://reader.miniflux.app/proxy/7EvCgEOizZXvqH55f0xZ_BtJTkMYDxXXHYgCl5pFWn8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9iM2RyeHNrNWxvbWV3NzRjcnV2Mw== 2000w" loading="lazy"/></figure><p>where λ is the vector of non-negative singular values making up the diagonal elements of D. Or in torch / einops: <code>U, λ, V = t.svd(M)</code> and<br/><code>t.allclose(M, einsum(U, λ, t.conj(V), &#39; i j, j, k j -&gt; i k&#39; ))</code>. </p><p>There are many (at least <a href="https://www.lesswrong.com/posts/iupCxk3ddiJBAJkts/six-and-a-half-intuitions-for-svd" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">six and a half</a>) intuitive ways of thinking about the SVD. Geometrically, the SVD is often thought of as decomposing the linear transformation M into a &#34;rotation&#39;&#39; V†, followed by a scaling D of the new basis vectors in this rotated basis, followed by another &#34;rotation&#39;&#39; U. However in the general case where U and V† are complex-valued isometries rather than just rotation matrices, this geometric picture becomes harder to visualize.</p><p>Instead, it is also useful to think of the SVD as sum of outer products of vectors:</p><figure><img src="https://reader.miniflux.app/proxy/Z4QRUxE_W7wek6d3FC97pe3kD0zQdpOo_uxCcmPcdqw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tYXpxOWNpcW9reWhsc3djaWg3dA==" srcset="https://reader.miniflux.app/proxy/BvcqHOWO3OEHzzAia8-w2Yt6YxBF7ZZc61AH1sULHVA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9seGRhbDFvb2loa3dtcmk0bGZ6YQ== 190w, https://reader.miniflux.app/proxy/x83WCctIhFLYXbfEyJJ2hRS6wDOuM_TNuGki75ncw8o=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9pOTRka3g4a3J4eHl0d3NzanhjZA== 380w, https://reader.miniflux.app/proxy/rcLC8tQq48DMt6PdcFPzD--lmUmbw_Lrp9eV7RKW8Pc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hdXJ0YXlhbDRuemlmYjQzeWVoeg== 570w, https://reader.miniflux.app/proxy/dBTmIHpuQ5ClQzmOyzr-213TLfHdb5e9SN1TmnfYXC4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9naXZzaTZjdXZ1OWF2ZDltOHpmcA== 760w, https://reader.miniflux.app/proxy/2g3BfX75BJ8Ti5EtqvGGEo1xGJQp6X3MHphnISUxtn4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9haDB4ZTh1N3Nqbzdqb25mOXdyOA== 950w, https://reader.miniflux.app/proxy/if9BGyTJsu9fnop-yZLlXiasw4zevG5QqPEi6Q1OxbA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jYWtodWVwYnhnemlkdXNoM2hvdw== 1140w, https://reader.miniflux.app/proxy/FSv2FTgUu8vF3ahtQsMUKZW03hVvN8U2UGbPaJ3ibXs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wZGRmam1oNnAwMzRzc2txbWh2aA== 1330w, https://reader.miniflux.app/proxy/aMmmN17dQ-bbZgLcI6wIkObRbcv4UWEUjfywx52Ch-g=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92eW9mdmpveGQ5emR1dW80bmtxZA== 1520w, https://reader.miniflux.app/proxy/EGbSsjhcq0yQhzwDfuiLSgWY-tY5xGWs5LLxgZKze30=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ibHZsNWh3aTF2cm9manFnMG9hbg== 1710w, https://reader.miniflux.app/proxy/e2V7gWqD_6hl3tQE2HVLVQkCx592xtqIRjBnid8huHU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9nbXd6aHdtYWVoa2l4NW9kNHF2MQ== 1900w" loading="lazy"/></figure><p>where u1,u2,… are the orthonormal vectors from the columns of U, and v†1,v†2,… are the orthonormal vectors from the rows of V†. <br/><br/>The size of each singular value λi corresponds to the importance of each corresponding outer product. The number of nonzero singular values is known as the &#34;rank&#34; of the matrix M. When some singular values are sufficiently close to zero, their terms can be omitted from the sum, lowering the rank of M. The effects of this low-rank approximation can be seen by treating an image as a matrix, and compressing it by performing an SVD and discarding the small singular values:<sup><a href="#fnm5ocsq6ut5j">[7]</a></sup></p><figure><img src="https://reader.miniflux.app/proxy/AjaYDAuyZrIqKdNUnZCov5Ih_Em_dqj4qO5aJ8YAMnE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9sM3lyamFkb2NtbHBwdHJ0bzFlaA==" srcset="https://reader.miniflux.app/proxy/Ypkhlg3TF72pPBV5ehraTehqzMiK5rFAV0anrGmnIao=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9uejV3c2gwNWhkeWtia2t0MXk4Yg== 200w, https://reader.miniflux.app/proxy/_ZjCUJ1xGei98OchFy3Q5pkAM7_NFcQbdcANtxOU3tM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jaW00dm15cTRtY3U3YnNvM3YycQ== 400w, https://reader.miniflux.app/proxy/6iBb79jNs4sx3KJ0ggcdZE-Y0DOdSkKNwAtApGq0CnU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qNjFlcjN6NDV3eHhjNjFqZWJqYw== 600w, https://reader.miniflux.app/proxy/cG7Mn2Pyg_FzRetyHiclxCmpZYuyUNgKg4eREz8z8Jc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9kamV5ZHdyanpsY2lxcXF0c292Zw== 800w, https://reader.miniflux.app/proxy/ryKc0El-9NZU9Amcmb_QLmAsgWQ-Bt1AE_axeLkif0w=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hd2VidWtlcmQxM3g2aGQwcjBseA== 1000w, https://reader.miniflux.app/proxy/s65BAEWp1ky6jiMgziEDWsQLQQ3VkKT6SUEC6G-VJjQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9henR6dWVzeHJseG40eXQ1bndvNA== 1200w, https://reader.miniflux.app/proxy/fQrOCdwPK7NTVTHkn5qMk8cLfQxcbWeGl6oA0O4PK60=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95b2hkeXE5cHNhbnlrNTBvcnFtaw== 1400w, https://reader.miniflux.app/proxy/qqvnSAA2t_H6Z_ZP1SnJGfrYJmi_L45-KEmND6kK_pk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93Ym95bTBlZmt5a21ocXRwMjN4bg== 1600w, https://reader.miniflux.app/proxy/o2pxR_1ekqpfHnzaeEBpZ3GDcm83Zm8YkxBkhhwK9xY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zbndseHRidXNxMGl6aTQ3aGZvMA== 1800w, https://reader.miniflux.app/proxy/bxZrbtr9e-SVnQh9DwtMK5y7OZNsswHbkWfJ-Qo4v-o=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hbHdwMHF6eHRqcTI0NGZoYXpuMA== 2000w" loading="lazy"/><figcaption>A matrix can be compressed by performing a singular value decomposition and discarding the smallest singular values. Here I treat an image as a matrix, and perform various levels of truncation, with the discarded singular values shown in the red shaded regions of the plot. (a) shows just one singular value kept: the matrix is approximated as a single outer-product of two vectors, scaled by the first singular value. (b) shows 7 singular values, (c) 30, and (d) 100 kept out of the 200 singular values in the full decomposition.</figcaption></figure><p>In fact, performing an SVD and keeping only the largest k singular values λ1⋯λkprovides the best possible rank-k approximation of the original matrix M. This is known as the Eckart–Young theorem, and is true regardless of whether the &#34;best&#39;&#39; approximation is defined by the spectral norm, the Frobenius norm, or any other unitarily invariant norm.<sup><a href="#fntsvsfrkezh">[8]</a></sup> The error in this approximation is determined by the total weight of the singular values thrown away.</p><p>General tensors can also be decomposed with the SVD by grouping their legs, forming a bipartition of the tensor:</p><figure><img src="https://reader.miniflux.app/proxy/2W-oeLVuLGKqqpn6ofZpyW5aeodYGji4kJK5DP7dhFk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xNnJoYjhmaGljdGhkbTMxZm1xdg==" srcset="https://reader.miniflux.app/proxy/I5m0cur27c_PbqZ05hKdwn6GXJ-c4E9wpS3iDSeeifM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9rcGphMDBqbDRoYWZvb3Nwb3ZsdQ== 150w, https://reader.miniflux.app/proxy/LL5Hcz8Nwf9UhPJ46K1Vtst4Z4lciEueswGww-l3Vkw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qOGFjOGhob2xzM3YyYnR0ZGRhbg== 300w, https://reader.miniflux.app/proxy/XEmIG0-3oBrLwx5XGBxU8BhGIOl53eV3pcLO_u5lqT0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91c3JtaDlscTF6cTQyZnpvNjRobg== 450w, https://reader.miniflux.app/proxy/Jv5hcqJmJ-fNY0odmBeG0BRiZw3CovLLDjWaWO26FFo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xcXBvN3hpdmVkaTNmcmdsYWtteA== 600w, https://reader.miniflux.app/proxy/PjDOAikF6kYRxa7FF7dbyFz-VmHj1PewYxo0A_1tvdQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hOWdreXV4YTh2c3VmOHVicmtjaA== 750w, https://reader.miniflux.app/proxy/feC0kpkfxgY6wwYYr0w9K4xSP2IXraCkfKXSK9IAI3A=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9semJmejBoZW1qa2t3MHV6bHp3bw== 900w, https://reader.miniflux.app/proxy/V8uI74IWaTzkuP8JGh1OAMunZBktuiF-zYTDrucSkO8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90ZGV4NHV0bGtwdmxsenNucjd5cA== 1050w, https://reader.miniflux.app/proxy/4NXZzNmekI-rW6DC3G2_ZV3IaLMjwZusimKfIYzkKj4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9lOXJ5dm1raHhvc3N6MDJidHFuOA== 1200w, https://reader.miniflux.app/proxy/wmdc8GADrdbEuLaLCfbAvRTAYcap0KgT9NQD7O6esXQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95dWcxN3h0dXNqbmJxZWd6emR0OA== 1350w, https://reader.miniflux.app/proxy/cZN7_MNfoMDa2_FSNkVBZmnVKEZhSKTr91bX0Tm6P1M=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hemtwc25hYWNtdnRqamFxYW16eg== 1500w" loading="lazy"/></figure><p>The SVD also has some higher-order generalizations, such as the CP and Tucker decompositions. These decompositions work directly on tensors with any number of legs, without requiring that legs be grouped into an effective matrix. The simplest generalization of the SVD is the CP (Canonical Polyadic or CANDECOMP/PARAFAC <sup><a href="#fngub7c5mcstg">[9]</a></sup>) decomposition, which extends the SVD pattern naturally to more legs</p><figure><img src="https://reader.miniflux.app/proxy/Xj-gBqj9oBFaBzCQgRArtM3nN0S2sVqKdu0Hm6aEYzI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9waTY5Z2hyd2lrZ3pyZnVvOHo5Ng==" srcset="https://reader.miniflux.app/proxy/wCDdiS_lgVzMqydmPJ7BFzMlFxq_XlmK_WG9esEa4kU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96MHN5ZmFzeWdrdGhmc2M1aHlsOQ== 200w, https://reader.miniflux.app/proxy/Wc0uCr7irNOFZV7TlM6ceUAZ8V4DjN2ZHRFKeVKsRmQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ib3Z3ZGtkbnF4bXl6MHdvbmd6MQ== 400w, https://reader.miniflux.app/proxy/9rxG76Sm8njG0u-0DZWddLfJwuSDscleoiWbjdCac08=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xZXhna3QyZ2NyOHpnZ2VmZW9mbg== 600w, https://reader.miniflux.app/proxy/3kF6lE_sSdwSd84Uh4anSdJSHjlXWomElo5RQ0N8gCk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96bWV2MXJodnVvaGE1dXNrbmFmYg== 800w, https://reader.miniflux.app/proxy/zfxn0o9GWW2WP7tN7bo7EH4OJJxf6QJRnkncQzvvC5c=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oNmt3M2xwcXN0MmN3YWxvbnNpcw== 1000w, https://reader.miniflux.app/proxy/bFnkT5a5r5ZSYYYMQwUNJRZZ7SqWDLQ2SS5ztJGVMQ8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tMjJwaG5oNmhubGVhOWdnaGJuYg== 1200w, https://reader.miniflux.app/proxy/YKpO4-8iamHRJEO4AEMGaTWHQxGr1TDvL1jjhr2ulso=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hYnUzaGo0eHY5OGRucHF3cWdhdg== 1400w, https://reader.miniflux.app/proxy/9G3puC0t60NhIDfminALHdmd7wR26M81U4wwbWjsbJg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90aXhxaXFoempkYmJ1ZWFpc3NqMg== 1600w, https://reader.miniflux.app/proxy/aVVraFk9mcXL-2tmZAE0vZ3P04BwyfxpwwGH2vEHvxs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94eG5xZHczYzR0ZGt3cmt5ZjUwag== 1800w, https://reader.miniflux.app/proxy/0OmJ2Q5mjLyvJYQku3Wes6Caa9gMuWcdTaOks9UR4qY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9keWJtdDFrbnp3b3hndHRuOGluYg== 1924w" loading="lazy"/></figure><p><code>T = t.rand((2,3,4))</code><br/><code>λ, [U, V, W] = tensorly.decomposition.parafac(T, rank=9, tol=1e-12)</code><br/><code>O = einsum(λ, U, V, W, &#39;s, i s, j s, k s -&gt; i j k&#39;)</code><br/><code>t.allclose(T, O, rtol=1e-3)</code><br/><br/>Whereas the Tucker decomposition is a relaxation of the CP decomposition where the core tensor is not restricted to be diagonal<sup><a href="#fnjxtzw5zwo8">[10]</a></sup></p><figure><img src="https://reader.miniflux.app/proxy/0EYtkbiLYec2Z5z6VJBu_bWPQnv7SzIoCf4f1Ov7U0w=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94cmRpemxpNThyanZmbGxsdXNreA==" srcset="https://reader.miniflux.app/proxy/zUj-wg3cUj7zNjkNW2tPhKJ7fHgjkAicjzIhKm5-p34=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92cTNzZ2N6cGpkZjI5enhkbjFhYQ== 110w, https://reader.miniflux.app/proxy/eIC8TAWvgaF7bfcIcPoAAnPkXNHQsgQIRcSkS-4VfuQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96ZWJlZ3RzY2lqNnBoZ2Nrbml5eg== 220w, https://reader.miniflux.app/proxy/os-q07sOllpPx_KoSf_1I4kjdOoBTJ1RYk0EtQeGxrw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90dWhmcG04dHRwaGJoaG52eXdqZg== 330w, https://reader.miniflux.app/proxy/K2FRc2gM6jN9f0-PK46eATagGcmnFQv4AHz5XbjanY8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9lZ3UzaHZqbzNpY3p0enU4ejZ3dg== 440w, https://reader.miniflux.app/proxy/D31rou299_sSEiJ80ONOYws_k4_aiYosaLuFb6Xz6N8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9nNGRzaWNmeGx3dzZzcm9xZWF6bw== 550w, https://reader.miniflux.app/proxy/YkLrvBT08RAt5_iUimKW2_aYno7QeUaGrXn9B9RKmoI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hcHIyd2xvcTdudTRvd3htcXd0cw== 660w, https://reader.miniflux.app/proxy/3hulyanWili30sBU3qR2xQ7eGK5mDc7ifPO8uu-fTc0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96cXR3eGdmdmtqOWp1MHZ2Z3VmYg== 770w, https://reader.miniflux.app/proxy/Bxkcx7A7X1ajEoS4N8R2QK9buAjrK-dki7olzE9FisI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9sOHV6OXB6YmdiaXVpbW84bXIxeQ== 880w, https://reader.miniflux.app/proxy/QXnCJ209kCXMQC-pDIFk7f9wQ2t_HDDBUR_f1O2Z7U8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9scmxueHBmMHBoZmR5bXFvcXVlcw== 990w, https://reader.miniflux.app/proxy/OD3TWR6lE0pfd4ntl2nvldHYRj1Y1twvHVXGv4G8v3s=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oOHhmcnFsdjJqc3duM3VwaTliaQ== 1034w" loading="lazy"/></figure><p><code>T = t.rand((10,10,10))</code><br/><code>C, [U, V, W] = tensorly.decomposition.tucker(T, rank=(5,5,5), n_iter_max=10000)</code><br/><code>O = einsum(C, U, V, W, &#39;a b c, i a, j b, k c -&gt; i j k&#39;)</code><br/>The restriction to isometric matrices is also often relaxed in these decompositions (replacing the triangles with circles).</p><p>Sadly, these decompositions are not as well behaved as the SVD. Even determining the CP-rank of a tensor (the minimum number of nonzero singular values λi) is an NP-hard problem,<sup><a href="#fnnw86qlujp7">[11]</a></sup> so the rank must usually be manually chosen rather than automatically found. Calculating these decompositions usually also requires iterative optimization, rather than just a simple LAPACK call.<br/> </p><h1>Tensor network decompositions</h1><p>Tensor networks are low-rank decompositions in exponentially-large dimensional spaces. The most common example is a Matrix Product State, also known as a tensor train.<sup><a href="#fnfmyqacdyvzw">[12]</a></sup> It consists of a line of tensors, each with one free &#34;physical&#39;&#39; leg, as well as &#34;bond&#39;&#39; legs connected their neighbors:</p><figure><img src="https://reader.miniflux.app/proxy/UtH75Ia5foQWi4_jeIYtjgU6ml4E0DyHHwwnPJKGOoE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9paGtrN2Q3dG1ldWtybHljeGNxdg==" srcset="https://reader.miniflux.app/proxy/hY4NLl0qDA4Xp4ZCqe48xp_RAIraMK2j0V8lN2mOoGw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tNWh6M2tseWZ5bWd6a252cmR0Yw== 200w, https://reader.miniflux.app/proxy/eWsaTVJTVaJT0rzb6IbjevUpU1eYwpJS2OjfBtlFf5Y=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vbjZkanBreDFndHdmbmJ6aWZobg== 400w, https://reader.miniflux.app/proxy/Sn6XUOI_1PrDv68wIBbnuPL_0NV5HgTMi0k3AggTZgc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91cXZ2Z2hkNGY1OW9xdHZnbmR3Zg== 600w, https://reader.miniflux.app/proxy/fDWDo90RMiDlLJSlKiVOuVj6fH43qEWfHgEX85mBXDg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xb3Q3NHZidGluaHkxZmh4ZHZlZg== 800w, https://reader.miniflux.app/proxy/h1y_6A4hspsNJ0UoLQznMmiMadOIr0r9dA_c8-Sk-xc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jOWt6ZjB1cGVtOGN4aXc2Y3Y0cA== 1000w, https://reader.miniflux.app/proxy/-fwk8wWxp2F_ejtj7i6CJTLJo3cSr3SprCcbZ0RTDyw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wam85eDlseGR3dTVvb2xyMW5taw== 1200w, https://reader.miniflux.app/proxy/_3v2nuHoSE5lrvZdLwlotXSjQrr7pwC61WrOwdj8DBk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9kZDJicGxzejIwaHI3bHJxdzFxMw== 1400w, https://reader.miniflux.app/proxy/EXNBNPEaykJ2ZiJ-pHe9CPAzB738CG-ETQY3mj3HTds=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xdWhmaTJsemRlaGxxemR5aXh2Mg== 1600w, https://reader.miniflux.app/proxy/Sh-tJOuHyUUnj7BLQFqLGo9nqwEHrsPHj5enkGd3yx8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qeHQxcDlhemVhcm1kc2xjd2Npcg== 1800w, https://reader.miniflux.app/proxy/OaUEwKan1NZDdLpvQA8hlptMiC5Pv7KQyEEO7Wjifqs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9nMTU3emdieTdtOGJtdWVkbDE4NQ== 2000w" loading="lazy"/></figure><p>Tensor trains live in an exponentially large dimensional space, because if they were contracted and flattened they would be an exponentially large dimensional vector. </p><figure><img src="https://reader.miniflux.app/proxy/XQOBQi5IL1fdeOIQzYa4nl14TqcECUfhFXFJfX-35Jc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90aWY1ZnBsMTJjZndqc3JvaTR6bw==" srcset="https://reader.miniflux.app/proxy/llq8hBEw0u2I8Nap71ReR3FG2lmkKHOCJkRoLsUeTD8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9uaXJ1bTc0anRzeHM2eHRraDBxbA== 210w, https://reader.miniflux.app/proxy/wSuno9ToFrY2nmJz0e_8gyMbpbKgFmO5zM-PaniFJaQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90bWlwdnJvZWR6bW1sbW0zZnp2NQ== 420w, https://reader.miniflux.app/proxy/a1P47h4-h3pF10KS0X8CGKiVn08T3dfH9UN_Ibhf6GE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95cWZjaGg0eXh6Y24zcmNpYWJnNw== 630w, https://reader.miniflux.app/proxy/Tba_tWRYKh7Kt8hP86dd8phrIXrtqFa1fwANeTmGFqs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qaWJlM2Z2Z280dG1kdHVrNm9pZg== 840w, https://reader.miniflux.app/proxy/dhN3BhDxX031qTg5UR6e-pnz5m1u_SZa4qYlfLYKqdo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wcXBqdjE1M2hzZXdld2U2eHRhcg== 1050w, https://reader.miniflux.app/proxy/zxEDZkfbq8vM_pd6VlpD2EAp2nNChM_CNE0A2kub9dU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92emZ3am0xcjNqbWJtYW5ha2d3ZQ== 1260w, https://reader.miniflux.app/proxy/RCtrphLod6Cxf5wNtpAAbCfkxYHLiy7jAIZuq0It91E=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91em1vY3Q0OW54emNhc3R6anh5Zw== 1470w, https://reader.miniflux.app/proxy/TFmHE5rjem_neFs0BuXzHFKdZC2tLW6iFSJtDa3t87Q=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9sNmV5c3h5bnZya2N3bzNlYnB5Nw== 1680w, https://reader.miniflux.app/proxy/RE36UGJQ5iWiCZjJbv4rpvoHsLP2LK-qmImrW5i_S5k=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zM3N1cGZiYnB1ZHlnejR5d29scw== 1890w, https://reader.miniflux.app/proxy/WXgayg3kW1Xk1IBVu8H7bWBTAT6r2Pxo0QdUb8tVKyo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9pZHFzOHVrd3F3d3NydnRzaXJnMA== 2006w" loading="lazy"/></figure><p>A single large tensor like this can be decomposed into a tensor train using a series of SVDs:<br/><img src="https://reader.miniflux.app/proxy/9HCv8uOAis1hob4vm5aZy_F2dMkClbv_Lj4SlEVkaIg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95NGJqa2w5cGpjY2V2eW12eGpjZw==" srcset="https://reader.miniflux.app/proxy/qOjuI2Ay9pU7VVo_zuhbz99WUkwsGBYyOcQZplOjQmQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9weXVoZmZrdXlnbXJ5dGRlb2lybw== 250w, https://reader.miniflux.app/proxy/EOyKs2vJghBMNOtjBFHSvNfx67M7KIWn6NCA9M6zWJY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tdGViMm9vYXVyajZiZXl6eHdzdg== 500w, https://reader.miniflux.app/proxy/ysTV4sy-LNOd-0tPoQw59HsTu6oQFuXFX-ESbzdDRtU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90Y2xqZW1uYWlxY21ienpvaWlrdQ== 750w, https://reader.miniflux.app/proxy/EbELECaul2QYFW8tNgO7wJTOFoIxMbAC5BGItRqXPXQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ocWh3dnFsbHZnNGRjdjdrZng3NA== 1000w, https://reader.miniflux.app/proxy/s99XJH7EUZFqN8Ml8AZyGI1gFMKO6vU59YM_l2DKuC4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95bWZ0b3FiaGk1MWkwY3F0a2dnZA== 1250w, https://reader.miniflux.app/proxy/aPuqMtloypFh93MrTrBZrMuwmIptumVARyObCjAyX5A=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hZ3hpZ3dwamZoMGJ4Y3hkZm92dQ== 1500w, https://reader.miniflux.app/proxy/Ni_qO8wRUHNt1W_0eXNlCZ-lW9qd8PWdA99xG0REtV0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qZmd2cnNyemRzaGxkZnEyODd2bw== 1750w, https://reader.miniflux.app/proxy/nDmspiPWDbGxRKGbLTS3xAOlaC2bXvc4YM71v540F7Q=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9teTRtY2N6dXd6OWkybm5mcm1jcQ== 2000w, https://reader.miniflux.app/proxy/URDFFiJQg2SvfKBJdUtlTyCb1LULNWmSrY5SZeki4Lc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zaW50ZThybjNhZG96YXh0Zm9wcA== 2250w, https://reader.miniflux.app/proxy/89vatZyoJJOVQ1Ak0OpTuy7YbQFmuvYpi2DrR-pgzFY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96YWttYXI5dm5wbWhxM282ZWRkeA== 2500w" loading="lazy"/><br/> where each SVD needs only to be taken on the grey tensor rather than the whole network - the isometries in blue already form an orthonormal basis from the left, so taking an SVD of the grey tensor alone is equivalent to taking an SVD of the full network. In practice however, it&#39;s common to work directly in tensor network format from the start, rather than starting with a single extremely large tensor. Regardless, if all of the tensors are made isometric<sup><a href="#fn7wayrajbdzx">[13]</a></sup> so that they point towards some spot, then the whole network is equivalent to an SVD around that spot:</p><figure><img src="https://reader.miniflux.app/proxy/-DWm3Auwk6kbdILmgWYIdDZdCbzsFWZvSztPi0HAIEk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xcHlrYng2dm93eTZucThwYnprMA==" srcset="https://reader.miniflux.app/proxy/SGtnYiOSmZ58Y0vWncDiuLQvJ1WBV_pMsBR4DjC-P-k=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hcm5hbGZqeTZuc3o1YnpqdHQ0cQ== 200w, https://reader.miniflux.app/proxy/dhxouHsxwU362lU2VuWRC1rEP0S1w9yUkcYT0NVPZm0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9peHhoeWU3c3Zqd3BqNjAya2dxaA== 400w, https://reader.miniflux.app/proxy/POQVTb6cnynay_h1fKN45Z7efUpM-OpROSFKUwE-QbM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hYWE4Yzlvcm02YTJubHE2djFhcg== 600w, https://reader.miniflux.app/proxy/DWoKCOY6Vo5QMxuyj4Uw8siR_60RfYxOrLbb0Ib9FKE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9scGRkdnl0M2pxcXN4dWN4bWR0dQ== 800w, https://reader.miniflux.app/proxy/0XskhDDd14KS51ACbFE-Vf6Trboi97FEJ8-hjVGys3c=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94eHFzZmxsNHhlYmZ5MGFqZ3dtdg== 1000w, https://reader.miniflux.app/proxy/E9q2nbj2vGrW_p2VJonCMfGCxkhDZTsGVHvbM-oA-3I=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jd2VmbTczOHY3enQ1bTN2eTc2dw== 1200w, https://reader.miniflux.app/proxy/sdloT5-zsNQNi48r5t20nIQfbsWPhwOWFd5eW8uopSw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zbW9pZm90bG9lbW51dmE0aXJidQ== 1400w, https://reader.miniflux.app/proxy/Hg1pgwMTMiv-ydJpPzxdo40BMKgdlosRTMmLarHXnMs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95dDJoaGpzOWtmbnAxZWo4ZmsxaA== 1600w, https://reader.miniflux.app/proxy/OsBnB5uhlwSSP1-YnEppoX1HQ7uo2hES5JjBABdOofM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9na3Rzb25oaXZzdGd5eWlyY29qZQ== 1800w, https://reader.miniflux.app/proxy/A9aT7A5OwDgj4gLAXFLW-bGW457PS8okTcuQh_d0w1Y=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9sZXRnZG9mdW14OXFjNzBveTd2dQ== 2000w" loading="lazy"/></figure><p>and you get all of the benefits that come with the singular value decomposition, such as (sometimes) interpretable dominant singular vectors, optimal compression by discarding small singular values, etc. Having a well defined orthogonality center like this also has many other advantages, such as fixing the &#34;gauge freedom&#39;&#39; in a tensor network.<sup><a href="#fnvvx1l7fra8">[14]</a></sup></p><p>Of course, this low-rank tensor train decomposition is only possible when only a few dominant singular vectors in each SVD are important - most singular values in each SVD must be small enough to be discarded. Otherwise, the bond dimension will grow exponentially away from the edges of the network. </p><p>As a result, these decompositions work best when &#34;correlations&#34; between different sites far apart in the tensor network (that can&#39;t be explained by correlations with nearby sites) are relatively weak. In quantum physics for example, tensor networks are good at representing wavefunctions which don&#39;t have too much long-range entanglement.<sup><a href="#fnk90gzolb6j">[15]</a></sup></p><p>There are many tensor networks commonly used in physics:</p><figure><img src="https://reader.miniflux.app/proxy/CsNw7uFLhLqnMhidNvvNpFjJAVxr_AWJ58j4jaFf2Is=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91bmp0a2Y3c3N2MHNmN2FncnkxZQ==" srcset="https://reader.miniflux.app/proxy/EV7yPxLe8YQKGPK4dopO5tGV3emn81sWXYmLCqwM1Kc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9pZnd2emtzdmlsYXBiZXdnbWRmdA== 190w, https://reader.miniflux.app/proxy/neBqaF-krsMzjDrma3I_IjBdogwqM5R7YkW91M2ZWD8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vb3N1Z21zMG9samVqeXV1MW0waw== 380w, https://reader.miniflux.app/proxy/5og2izPWTbvWvNhQhF9YtIqx43gKAl3RcSgKz8Vln2c=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oazBmamd5eGVrYXZ6b3JldmZrdw== 570w, https://reader.miniflux.app/proxy/EPxDTASpQLqQpKeAoqkvn8RIzi1zKziIEmKQKCWfhJs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90aHp5OGJrbXlndWZhbWx1azZpdA== 760w, https://reader.miniflux.app/proxy/XPj2MBmY3ADLPwWZVmcsjr_TAQDT_fqhlI8ZH3dEUXs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vbGt5c3lvZTk3cXVwdmZpZXFwZQ== 950w, https://reader.miniflux.app/proxy/saPlnW52vNxQmhws6iRkbGIDt_oxqiKtVys-7MCmEqE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92emM4a2tvb3Bmd2UxeDN6eXFhbg== 1140w, https://reader.miniflux.app/proxy/neGMYtlb4ZrRpUfDWYlaRAYbq_RFKhICm65gh3dxv1o=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zeGg1bm15cHgwZ3h4cDIxNHRiMA== 1330w, https://reader.miniflux.app/proxy/qdLi5WY9i3AXjckp05WFNZ3QH6kMzU9taKAsr9R6xB8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93MzVpN2NnZXdzdWlxdmloNW85ag== 1520w, https://reader.miniflux.app/proxy/1SDjPYsmfoKzT8Zj4-D_HcTKkDPqjwP6GQQkrRCFK-M=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95aGtwdXViNXdjaGxzZnh3YnR2dw== 1710w, https://reader.miniflux.app/proxy/MbVdJRQA9kbjGcFH2rcfsx6Oxw_XdO6PtfpjTF3m0uY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mdzlyY3dycm9ydGs4NWV2bWJqMA== 1888w" loading="lazy"/><figcaption>Image adapted from <a href="https://tensornetwork.org/" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">tensornetwork.org</a> </figcaption></figure><h1>Neural networks</h1><p>The problem with tensor network notation is that it was developed for quantum physics, where things are extremely simple. No, seriously: in quantum mechanics, <code>einsum</code> is all you need - no nonlinearities are allowed, <a href="https://en.wikipedia.org/wiki/No-cloning_theorem" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">not even copying</a>. So neural networks require going slightly beyond the standard graphical tensor notation, in order to represent nonlinearities.<sup><a href="#fnd3bbi58ho5">[16]</a></sup></p><h2>Dense neural networks </h2><p>Without nonlinearities, dense neural networks are equivalent to a bunch of matrices multiplied together - one for each weight layer. The data x is input as a vector, which contracts with the matrices to yield the output vector y:<sup><a href="#fn1g1fyzr8cdph">[17]</a></sup></p><figure><img src="https://reader.miniflux.app/proxy/JIm5EUyc_oPNGBSpApEpsVchr-xe5OmCr3DBPYvGx2Q=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tbXVoMGtxdDRzcG5mcG5hc2Vxcg==" srcset="https://reader.miniflux.app/proxy/HY94mFaiWvyQS0n4x1iUWo0KzG5lxlIOxdPidRNLIAw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9naXhuZ3lna2tkemRzeGRkenN4NA== 95w, https://reader.miniflux.app/proxy/aF9w7Gc3PQo_JpcdW7Qj7ULkRc94sAFAtHqRFYHTglw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9uZmhrZzV2aHhjMHd4bmNicXBjbA== 175w, https://reader.miniflux.app/proxy/Fr5u_2BxeCoqZKSnbe87OxD8jT-6JRqKI8vmXpv8too=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ncjZkbnZhcTdxcm50dmJpbTYxcQ== 255w, https://reader.miniflux.app/proxy/ARA-faFDLA9AHKteL6_3w0XpKXascZTkh9NARF6ZpT8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hMnA2bHNhb2FwcWJmeWd0Z3RhZg== 335w, https://reader.miniflux.app/proxy/DDECcZNbdtwburgXqJ9jQu-LbuRbqQKCe19DELHkY1A=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zdXdtaHNxbXprdThreHNteXF4bQ== 415w, https://reader.miniflux.app/proxy/bW2dl4bs15B1EikkaAh7SaQqL1a14e74k5DYtUi2esg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ycWNrdG05ZnlrYmdzcmtqMGI0bA== 495w, https://reader.miniflux.app/proxy/w6EWPlK-e7a4scNZHN66zA8u_moNVXZHxoWkaDfrh3U=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wdnJmcWN5YXM3ZHZ2NHJnZXN4cQ== 575w, https://reader.miniflux.app/proxy/kW70l27qGGiKTVPbZbLNsUHADctbcwtjtDnyb_RGkBQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oZWRkbGJmeWR5aWhxd2VkYndsdw== 655w" loading="lazy"/></figure><p>Without nonlinearities, this contraction can be performed in any order. In fact it&#39;s equivalent to multiplying just a single weight matrix, as the contraction of weight matrices can be computed independent of the input vector x:</p><figure><img src="https://reader.miniflux.app/proxy/C-mhdrKH8lVymQ7ZuH6az6acGvg3E713WJDvXcg41_E=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90eHhlajhnb3N5Zjc4MHBmN3Z4Yg==" srcset="https://reader.miniflux.app/proxy/fQmPJDVUaNoqOuVMZxVITWn5pq7NeG1a28l2Rzygf3E=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vc2xydXN2cnh6djVucmRrbDF0ZQ== 158w, https://reader.miniflux.app/proxy/cOrg_sT1Gfy6UKLkEJqcXWudvK9mXXQvRxAECJnisBs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9lc2s0MmxwM2xlaHFjazl4bnZlcQ== 238w, https://reader.miniflux.app/proxy/UAw5LXLm6oEFuKY1UOqPzTmlbVggeY21hdjkKLciZFc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9la3VnamN3YWVvaGt1dzdmc2lyeA== 318w, https://reader.miniflux.app/proxy/HUMlFe2cQS5QoL4WvD2N-8k618KTZDMTqhcMzAL4G1A=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94cXN0MnJwZWo0bTcyZDBtdHhhZQ== 398w, https://reader.miniflux.app/proxy/WlkBGNtzoptwh3UYGLh7pUBknUaJr2P7zFfaDa6cGGQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hMmhjNjVlZWllNHJleWg3cm9zcw== 478w, https://reader.miniflux.app/proxy/k-CpNCoEeCk3XGc9-0KuPLLKhQFzlgpQR5V8OLThN9o=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9kMG96cWNkOGlsZmFncXF3cHlzMw== 558w, https://reader.miniflux.app/proxy/FWEmafAlMihb2ig212uqBtWczsKmWWSNi7mfOg-2gOU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tNTJ1ajhvbWZsZmpyZ29sanFneA== 638w" loading="lazy"/></figure><p>Adding nonlinear functions, we introduce &#34;bubbles&#34;: everything within the bubble must first be contracted, and then the nonlinear function can be applied to the single remaining tensor inside the bubble. As a result, these nonlinearities induce a fixed contraction order:</p><figure><img src="https://reader.miniflux.app/proxy/aXy9FHnEMpY2b7aRoVgwQSNfggrK7TzLqNKMr4ALzto=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9yenB6em5vYXExMXFvZHJjOW56Mw==" srcset="https://reader.miniflux.app/proxy/kG0ZMwGYgxc6RzLXXt3BIEOHMWr0AoRLmv_vZYQVZhA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wcmZybzBpa211YTVxNm9lYWlldA== 158w, https://reader.miniflux.app/proxy/DJKxWNcmnZCmTp9VRgkypQmJTOa8xOMM3Lv7kWeiO98=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zZXEzeXhydWZzMnpqeHV2eDk5ZA== 238w, https://reader.miniflux.app/proxy/vVAlVUA1AnT4qGACq99GBtLlAM4PiyVvKJwo8hb1AbU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9rYmZueGc0Y3JxMjQ0cGVqOGFzcg== 318w, https://reader.miniflux.app/proxy/DkvT8mfanhgL2TdbX_IZi_RdYJE0-E2SqZy5bSwp22Q=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9iM2J0N3hhZm16aXhxamMycWxocg== 398w, https://reader.miniflux.app/proxy/F3P519IvmgCcHMWGsGGOGhZKjBTDzzBn43u5x-EuLX8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9iZWVqa2VqaWlzOG94c2lwbWhxcw== 478w, https://reader.miniflux.app/proxy/bFbLm7VBINSrAjduGAqe6nnq_YsXjaHAx32Or5uYFHM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ubWtuMTZ3b3BhY2JndnQxdGhpag== 558w, https://reader.miniflux.app/proxy/54WA-mRajAsF3pQoal_LJsYo5y-lDozXtEAw5VakS4Q=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wdmNzZ3lpeWx4enh1Z2JxM2JseA== 638w" loading="lazy"/></figure><p>First the input vector x must be contracted with the first weight matrix W1, and only then can the elementwise nonlinearity σ1 be applied, and so on. <br/> </p><h1>Transformers</h1><p>Transformers are being used for the largest and most capable AI systems, so they&#39;re an important focus for interpretability work. Transformers are traditionally used for sequence-to-sequence tasks, such as turning one string of words (or &#34;tokens&#34;) into another. We&#39;ll explore them in graphical notation, with a focus on illustrating some of properties elucidated in <a href="https://transformer-circuits.pub/2021/framework/index.html" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">A Mathematical Framework for Transformer Circuits</a>.</p><p>So here&#39;s a tensor network diagram for GPT-2, with non-einsum operations shown in pink and green:<img src="https://reader.miniflux.app/proxy/cUstaq_vFthahdrIn0M04pgPh9hyJiHZba8t2grHNYQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9pbnRzdmZwc3IyNG1lbHk5dnFmeA==" srcset="https://reader.miniflux.app/proxy/D2bDsyn9_zU1Z046rZoDzCeqGwrUfCmD3czXP5GhDJA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9pNTVja2JsODZ4bjRmY294aTZkbw== 370w, https://reader.miniflux.app/proxy/DsZJMDrgey7dYz9MKZRQKP1tihzwr3FbLSylxGAVixQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9obDN5MmVsb216bjJ5cGx5YWZybA== 740w, https://reader.miniflux.app/proxy/9QZ5xDq62k0u3tvNlGT0RMM0epdDMfm3LiMrFUbz6Go=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93dnJlbGpydGZ5cXpyYjRrY3RveQ== 1110w, https://reader.miniflux.app/proxy/LPaJuqNh4RKPyUjJIWPtYxoZNK8ditqyg2Juk6IALxw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9yd3FsY2plcWl4MnBxZXh5a2J0aA== 1480w, https://reader.miniflux.app/proxy/Oul-dK_mT4ys1fbNHLImK2y6cce53aq1_MUuOPyANds=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9iY3NlbmM2aHN5NHNqZHBkMDhlMA== 1850w, https://reader.miniflux.app/proxy/3qlXpF2yBEng3FtKwU-jM9qrU5G-aCG806Vb7ZUBxIQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90djlnZGxwZ2R2YmNqYW1sZ2didg== 2220w, https://reader.miniflux.app/proxy/klRgB-ed2aW9yqz3JW7AdeTic9QMf4YN2L5nMDqSK5s=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9nbnVheW5kZWd0Y3l3Z3RqcWd5bg== 2590w, https://reader.miniflux.app/proxy/PJBQBih-NokcWpqz2-eqmpzuBkHd4SehDuQhtmzl3C0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9kemZ0enBvYTBleG5mdXhsYWMwYw== 2960w, https://reader.miniflux.app/proxy/csbJzFxREnZVfyiJQrzHm9JpknEM_MagxRzibE6nliI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96ZmY5Y2lqZGd6OGx6ajFyYmxheQ== 3330w, https://reader.miniflux.app/proxy/aZCHueGr_GJR5nRngmJyMraMBU0E-m7WQphCR6qgv_c=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9pNWJuZXlqbWRoYXNndGdnODB3Zg== 3618w" loading="lazy"/></p><p>We see that the structure of the transformer is a series of distinct parts or &#34;blocks&#34;. First, an embedding block, then &#34;Attention&#34; and &#34;MLP&#34; blocks alternate for many layers, then an unembedding block. Let&#39;s flip the diagram around and view it vertically so we have more room to label the legs and see what&#39;s going on:</p><figure><img src="https://reader.miniflux.app/proxy/bgBvzCwyaVkK0Fpz9ZEU9f-0z_Dm5M3YPpFd2pUv_Oo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95eXNsOHdvYWo0bGZmc3Q2ZTd0dg==" srcset="https://reader.miniflux.app/proxy/EX374zGs-qMF7p4v0Vmquu4JLk9PcCOR7UmD97L_uCk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ndnN5YnN3dWRsd3Z6NjRyeXczcw== 170w, https://reader.miniflux.app/proxy/2z1z_VEakHuERGdpvV0qoRXMwXEdRNJczR5RVwTFUGk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qMnVpem5wdDRpbm0za2RzcWh0NQ== 340w, https://reader.miniflux.app/proxy/0kj8SZwJ9zjjyKlHleiLRAlgn_cS9Tdl_m-nlmpL5xU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9yd3l1eGJodGxkbTN3NzliaHcwdg== 510w, https://reader.miniflux.app/proxy/xrPgrG80XECCNoTcj9uMIyzjef_oggKlwtCyaR84xOc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qaWRkeGlxYmt4dWx5cGJ3ZnJjbQ== 680w, https://reader.miniflux.app/proxy/rGqIO3fNM6ZFDUm5QASrarUu-I3qSSnwYDt1-cCaAiM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tNmJ3dnE3bmN0enBwMXN2Z3NncA== 850w, https://reader.miniflux.app/proxy/B10PqtRd63xXDi-xK6UrOlxKkemeMSkukYOefzDgn04=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92YWFxamtjcXJybXh5a2Z6aXNibQ== 1020w, https://reader.miniflux.app/proxy/d733LEayGnksIdOm99gamid3AwXHKe5WvpCVyw9q0YE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ocGNxajNydGdpMXNncWNiemhzbw== 1190w, https://reader.miniflux.app/proxy/6Nn6XP-kdg2_WlNuqXr8pXHB5_3J1y89IrsXYgLFjYk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90c2ZmYXdnZGZtYmp4azhkaWtxOA== 1360w, https://reader.miniflux.app/proxy/w0HEoAJFVGn90T4cD-dyBDYEDGT16wFOGa_kwyY6vi4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92Znd1dnZiemN4ejdobXJ3eGV1cw== 1530w, https://reader.miniflux.app/proxy/oqjToY7pBohxvWuXmPZWwQxArgy1D1yIrQYsQBLt1aI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vbWdlNnd1Ynd4bGpjcGJzbGl4YQ== 1687w" loading="lazy"/></figure><p>Here we&#39;ve also changed how we denote the elementwise addition of tensors (in blue), to emphasize the most dominant part of a transformer: the vertical &#34;backbone&#34; on the left known as the residual stream. This is the main communication channel of the network. Each layer copies out information from the residual stream, uses it, and then adds new transformed information into (or subtracts it out of) the residual stream. </p><p>Here are the dimensions and descriptions of each leg in the above diagram for GPT-2: </p><figure><table><thead><tr><th>Leg</th><th>Dimension in GPT-2</th><th>Description</th></tr></thead><tbody><tr><td><code><strong> seq pos </strong></code></td><td>up to context length (1024)</td><td>The number of tokens in the input text. (Indexes which token in the input text)</td></tr><tr><td><code><strong> vocab </strong></code></td><td>50257</td><td>The number of tokens in the vocabulary of all possible tokens (Indexes tokens by their token ID).</td></tr><tr><td><code><strong> hidden </strong></code></td><td>768</td><td>The dimension of the residual stream on each token (space for information stored on that token)</td></tr><tr><td><code><strong> num heads </strong></code></td><td>12</td><td>The number of attention heads per attention layer</td></tr><tr><td><code> <strong>head size </strong></code></td><td>64</td><td>The compressed dimension of each attention head </td></tr></tbody></table></figure><p> </p><h2>Input and output</h2><p>The input data <img src="https://reader.miniflux.app/proxy/Md6oHoR-hEtYq-JqtLvtWZYEqApn_f4lnhkJ6iCxsBM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96c2gwYnI1NzBpdG83b3R1cWNycA==" srcset="https://reader.miniflux.app/proxy/A4P2FwGr9ZdFgj5vIhxQbdJfVjYMZ8AsrSjOoO0FZF0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9md2thMWJqMWpodHc2ajV4c2djNw== 133w, https://reader.miniflux.app/proxy/j2nP3dI_yjBqiLLbI3UZ3f68BAfvSUmsk41Hy1jRBJA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9yZmRzZzNubWM5YWlrcXd2Z21iZg== 213w, https://reader.miniflux.app/proxy/sAc9PQJu45MAw9zOuK_xUVnx7s6Ozx_Z734ijGG6wGs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9yeXF3bXFlNXRqb2s2aGFleG52dQ== 293w" loading="lazy"/> can be seen as a map from each position in the input text to the ID of the token at that position: x=δseq_pos,corresponding_token_ID. Like most delta-tensors it&#39;s computationally cheaper to use clever indexing rather than actually representing it as a tensor, but here&#39;s what it looks like regardless:</p><figure><img src="https://reader.miniflux.app/proxy/jiMVTGbDurggl0kS_0HNzmxfrvek9YsVhQnj3r0V3_Y=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9odXEzY21zMmh5dHFvdHc5Y3F6dw==" srcset="https://reader.miniflux.app/proxy/xD1QPJrqs5-76g-KX9VofUW7EBPiOSopGrZTa9vhsIo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ydW43ZmQ2eGZsNTJlMG9mc2h2Yw== 390w, https://reader.miniflux.app/proxy/dVv3cLdsYVjsAXRn_vopBUWp1ItJQIv4LQo_0hQYZ5s=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9td3h1aTJqem1kcXppMTNsbDVjaQ== 780w, https://reader.miniflux.app/proxy/lGIs50PizweHpatKGVryV3xrOrCvoZUW9r-XTy-H5ww=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tc3FnY2dhMXpsZ3p1c3dwOW84ag== 1170w, https://reader.miniflux.app/proxy/SH4jyJhBkrNt0xn3QOK-a29mzoEbXlEze1fEivZT7nA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mYWhteGhnbnF2YWt1d3Vrb3p6ZQ== 1560w, https://reader.miniflux.app/proxy/A1Z3qf21Yip35kpThlehlaNO-jOul-p2HkYgOqiiEgs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9pY3lpcXV2ZXRzZm5qYWVpejRwYg== 1950w, https://reader.miniflux.app/proxy/QNCI4fGiYe4kIlBDRypFzaUPjB569C7f8FUJuW9TM38=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qZXhobHhtamM1enhrdGN3cWV3dA== 2340w, https://reader.miniflux.app/proxy/5TgDpVntltGFfMLotb4QnBgYQa2t4IKeTx2SsE7ip1k=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mdmppNTdjb2MybDFwbnVpamVtcw== 2730w, https://reader.miniflux.app/proxy/ixDWxqSC_3Q8jk89cJf1c10kzRYYG09l4wUW0hlqP_w=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91cGdsOWZ0cHpmY2RrdHlmZXpwMA== 3120w, https://reader.miniflux.app/proxy/GXv3OhUUEoCuCiDicsjzZIdxAPq09Tyyg3x__3zexDM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vdmV2ZHEwbXVjdG12MWE2MDFpZA== 3510w, https://reader.miniflux.app/proxy/q1QqVjfPT5Ob_kTaRIjvRPqENWaN7gv3hL6-PH0F4ws=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ybndkMGFqd2lwbzBtbTlma2Zwcg== 3810w" loading="lazy"/></figure><p>The output tensor y (found by contracting the input with the whole network) has the same shape, but in general every entry will be nonzero, as it represents the log probability that the model predicts for every possible next token at every position. The vector at the final token position represents the log probability distribution for the unknown next word, which can be sampled to turn the predictive model into a generative model.</p><p>The embedding layer is responsible for getting the input into the model, by compressing (projecting) the input vector on each token from a dim(<code><strong>vocab</strong></code>)≈50,000 dimensional space down to a dim(<code><strong>hidden</strong></code>)≈768 dimensional space known as the residual stream of each token:</p><figure><img src="https://reader.miniflux.app/proxy/I5POMi1DGcCo01VIO0c8MRcfJ43uJm4p0zhei76hoYk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9lcm93d3N6ZW9uZ3lpbGpyOWV0dw==" srcset="https://reader.miniflux.app/proxy/1fq1lwL_FpEP27xiFI-2l_CKZF6OzBfzeDL8b9NKel4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tNXRqcTVvbmwxdHp2eWpnd25pYw== 340w, https://reader.miniflux.app/proxy/Q5rEiJ9JfBAYxZ9Cp0_ROhOjmnYQR6zyCVxDS7q2LrU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90NnR5ZHhkZmN6YmRwczlpZGxjcQ== 680w, https://reader.miniflux.app/proxy/d7vcFWerTt7yd6WizrPGtpupw819TKf2MOQ6D4mZmsE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94dmF3cjV3cGticDJ6anMyZWlmYQ== 1020w, https://reader.miniflux.app/proxy/kl3spGryfv8mwpHcZXgWNgmLFYzUu9wVd1KgA3vC5G4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zY29ydnd1c3NsZzUxanFoM3JoeA== 1360w, https://reader.miniflux.app/proxy/NJ7ZtuawiekGwjO5KbfgDtC4DA-dqeC9QFnU0RcCEFE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oeGlpYnYxcW9kbWllMm9vZzNmZQ== 1700w, https://reader.miniflux.app/proxy/jAdjSjtVKNcxquZ4hbOzPl98YPxrC-yrJgGl9pJs0Ho=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95bW5zdGQ0eDNxazFidTFuem1ndw== 2040w, https://reader.miniflux.app/proxy/1wQcunRkuXVpqrVn9dCHW0iHDlWqFfMwopE4TtRAp68=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vOWhiamZsYnFyOW5mYjVhZWF4Zg== 2380w, https://reader.miniflux.app/proxy/M42Pg2eJO80avNClRKkagttqh--SC04zFaQ3j6L9BeE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vcm54dmx4eHBlZmhsa2NyZG9qNg== 2720w, https://reader.miniflux.app/proxy/kKsCnFSBCB00LMxD0cIj5XhI5CFr0u0iMJX_a8MiyPM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9uanNxZHRjeHF3eWVueXpwc3h4Mg== 3060w, https://reader.miniflux.app/proxy/lkjPnxwDX34nqHJpiJZ-xlh14d6TUwMEdEFKcCNmzoE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9neWt5c3p2bnQ4Y3M5Y3d3ZGJ0dw== 3361w" loading="lazy"/></figure><p>The total dimension of the residual stream is dim(<code><strong>hidden</strong></code>)×dim(<code><strong>seq pos</strong></code>): there is one stream for each input token, and each token&#39;s stream is of dimension dim(<code><strong>hidden</strong></code>). </p><p>Presumably this process of embedding involves creating a vector representing the token&#39;s meaning independent of any context from the tokens around it, by packing similar tokens into similar parts of residual-stream space (though <a href="https://dynalist.io/d/n2ZWtnoYHrU1s4vnFSAQ519J#z=3br1psLRIjQCOv2T4RN3V6F2" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">superposition</a> may also be involved). </p><p>The embedding also has another component: the positional embedding. This is a simple fixed vector for each position, added to each residual stream independent of the token at that position. It lets each residual stream have some information about where in the sequence it is located, as long as a subspace in the residual stream is reserved to store and use this positional information.</p><figure><img src="https://reader.miniflux.app/proxy/fJGs8SwQ6Za-hrwf5OzQXA8M1SP-qt0FekctTeDLhl4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94d2FieHRxeDdwbWF2Z2VyZm95aA==" srcset="https://reader.miniflux.app/proxy/UgcixA-Gs4KCgGFAkjCzfd_hz6IcJ-EU2sqDecB_9J4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9rdzk5cXB6anhwa3FlN3d1dmtoeA== 370w, https://reader.miniflux.app/proxy/MtkQw0gu1h5-9gRN9lzfpQB8hkXPI9AAUDfKB8gMFbw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jd2VjYm9pcGFidXB1bWZuZWlkaQ== 740w, https://reader.miniflux.app/proxy/wSJ05mHsnbFrSD9a4pdVk7EtbGhqCxXwqM0crBnZq1Y=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wdGxrYm1ybmoxb2U3YWh0OXhzeA== 1110w, https://reader.miniflux.app/proxy/Uewfhg8WbAJuiKMPxc53Idzdz63CfWjtS0YmF0sp52Q=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90dXlodTIzaHR1M2locm5jdmQ0aA== 1480w, https://reader.miniflux.app/proxy/iwiyE0xp5Ip5qIcz7VSmdRAq1nT8hs1mKZ8tjDgBp4s=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oNGI4MnlhaTd5d3R0bWkyc2g0aQ== 1850w, https://reader.miniflux.app/proxy/Y00W1TYA2xFU08XM9pRjUOv3GLNgtCGIN1GfFFVGpQI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93enN6dGlwZ2h4MmJrdnBleWRjYw== 2220w, https://reader.miniflux.app/proxy/_wF-KCkRVBzxTSqTau7rPCrmtdkz1NRwsQ8ijoteD5Y=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94aHhwanhhb3NqY2J3cWMycWd0Nw== 2590w, https://reader.miniflux.app/proxy/A4Fi_a_R9QmXbDlvMTJSDoOUuJa0MBsJpfOMwdmF18A=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93bXVzYW45Y3dvbmF1aWJtNWVhMQ== 2960w, https://reader.miniflux.app/proxy/8d799Xhbxqvecc2HrXxSR0od3s0UGjzMmRurjYlSIo0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ieGdwOXNmeWpsZXJvYWdvZGN3bw== 3330w, https://reader.miniflux.app/proxy/8SKrKXSDIgg8zNEywlsGRPS7w9DJmE7QB-_GQQU71iw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qemJpZXpvemU4YzRjeG92bmRucg== 3642w" loading="lazy"/></figure><p>However different transformer architectures tend to use very different kinds of positional embedding techniques, so for simplicity throughout the rest of the sections we&#39;ll contract the embeddings and the input into a single tensor:</p><figure><img src="https://reader.miniflux.app/proxy/XDcUyPzdmnNJaUTlkWtQrDR0LmURKJucxI6eqktyf1s=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zejRmb3Y0a2VwM20yc3B1c2t6dw==" srcset="https://reader.miniflux.app/proxy/AOmuYWDq2F46_c2HwVufwMDpdJVBaTxQEbUyGT2-CBY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zcnhsOHJ3czdpYm5wenFqYW5nbw== 240w, https://reader.miniflux.app/proxy/TS-KQVEy5uQOWxEhkKiiAXp8Nz8aNjfsfysJXp0zloA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9nMnU5ZjRpaHN5MnZ5ZWwwOHhzcA== 480w, https://reader.miniflux.app/proxy/j50z8KT2msOVJyhxklRJjfN6XdKY8_55p0qeEmrWZhs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92dHRqbXhwY29sYjVkeW94bGxncg== 720w, https://reader.miniflux.app/proxy/1ovhHqZF1p_bETz_yhjHShB6mjC92W3LVfEqdHgVKTw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9idDdhcWs2a3BtbnM5Y2NnN3g3Yg== 960w, https://reader.miniflux.app/proxy/GqcK-nU3hfDAQ-LYHEchTcJtUy2ykoU7lsSgwDshz7g=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vdHAwMml3bmFuZWRiZHNtbjl6bQ== 1200w, https://reader.miniflux.app/proxy/kh4kYTa9vWYinxDYsDgQnPmSmNYTEsD3KPSNxrP-SAs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96bmZqbXpmdG10YnNldjl0aTIzcA== 1440w, https://reader.miniflux.app/proxy/3qB6qKijzN0SmGUz99WDkH9eltQ8gjSM-19MFaCS6rg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mZ3FxeTVybGhoZnVmemdxYXFseQ== 1680w, https://reader.miniflux.app/proxy/hI-1abd2laToFyL-ouvoxgKsA0IvmT6eiqYYVwjoUFs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90Z2VrZXJpcHVnaW5zYnUxeGl3cQ== 1920w, https://reader.miniflux.app/proxy/WuQmourrG-pHdQGjykrCiytEhG9pLw230esT3MLSf4w=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hOGhjazB0YzFldDhna2FyanV4cg== 2160w, https://reader.miniflux.app/proxy/eHe-7DYwxmWclHKXKzUbj2ZmnjTmKC_jKLDkfPFyHHM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93azdvZ2pwY2ltdjF5Z2ZvY2Yyag== 2358w" loading="lazy"/></figure><p>but feel free to substitute in the expanded form whenever you like.</p><p>The unembedding matrix works similarly, but without any positional component.</p><p>The structure of the transformer from here is a series of &#34;blocks&#34; which copy from, then add back into the residual stream. There are two kinds of blocks: Attention and MLP, which alternate down through the layers. </p><h2>MLP</h2><p>The MLP layer is most like a dense neural network, though it is residual (copying from and adding into the residual stream, rather than modifying it directly), and acts only on the <code><strong>hidden</strong></code> index. Unlike an MLP, a general transformation would be able to move information between token positions, by also acting on the <code><strong>seq pos</strong></code> index like so:</p><figure><img src="https://reader.miniflux.app/proxy/cB2bxrbS20_NwgWLM9JOx4NlUQrV5r_XyuGT2-qiBT4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91MXJ1d2xkbnN6aTlpeGl1cTVpNA==" srcset="https://reader.miniflux.app/proxy/ORit9Ur0trulq25XhiMoQiMnXfweYHwrSzHEJYbG6VY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ibXdrZmtrNjJtaTRjbjhobnVhdQ== 104w, https://reader.miniflux.app/proxy/yRBak7DJXLPlDtb30bGOmbEPl7Mslu6UpdQYod0wGXM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9objdhZHZhajJkNHdjbmphdWpzZg== 184w, https://reader.miniflux.app/proxy/HTi3MIWa_ZN4ihx-PPbqAg1Ql3yvo7MibafZLi5ezV4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ocDZzZjRzdXE5NnQ4eGZpZXJxbw== 264w, https://reader.miniflux.app/proxy/8-bETReaOQPVx6XjN-2vyY6rS0uIzUQVOKxYttczp3E=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92dXl1aXN0aHRhenhwNHpqaGsxag== 344w, https://reader.miniflux.app/proxy/BSyvgRgRjF8baYIXQwPhS-fGILKNfsEo2vP9214ZdnE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96cnhiNWdnbWV6bGZjeW1oNzBhbQ== 424w, https://reader.miniflux.app/proxy/iGugoIqOnwNMRvzpg5QMtuULAHL-qTktPTQn3rCNybE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9odnM1Y29td3YzYzlieml3Z3Jzaw== 504w, https://reader.miniflux.app/proxy/vWNAM_awF8KylrnoZsiV636HeOekuHmJnMEbFuZwul4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zZnlwcGJkaHJ5NnlraW5zNHRwZg== 584w, https://reader.miniflux.app/proxy/KxoNzmiK8mVHda2oktP1cgCXTZwHwNd1j2iIHEgcO8o=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qeHVoMXN2ano1YWprc2xjc2FxNg== 664w, https://reader.miniflux.app/proxy/kxungZJa2tWUBM_ZWBWXtLppd0eiSIj48SycI7WVCn4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9uNXV1MGp0ODVnMmxwZWJ6eHp6Zw== 744w" loading="lazy"/></figure><p>but MLPs only involve contractions onto the <code><strong>hidden</strong></code> leg, and so act independently on each token, meaning that they can&#39;t move information from one residual stream to another: </p><figure><img src="https://reader.miniflux.app/proxy/mosTPCxSSWPMu53QNSDvIiAE4lEEd4HOJdF2wAtedHc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wNHVoZTlkcHQwdWZzZXRjdHpsag==" srcset="https://reader.miniflux.app/proxy/1TczO6XfYi_KcoCW0osukfmko94NmX-j-o830atT6Bo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zY2N4NHpocjE3dHU5NDF6dHh2ag== 410w, https://reader.miniflux.app/proxy/bdwfft3-OSQikFbJS_-vsKb3o5usWb2Wh9pXLvyIxOQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ncnRic2F1dXRjeWR0MnJtcXdzaQ== 820w, https://reader.miniflux.app/proxy/93CI1MGOSRue16NLrzg2b9dUd_73dGK5PXi5k_P7Tz0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9pcHhvcWE2bmpxZWptYXhqb3RmaA== 1230w, https://reader.miniflux.app/proxy/AdrPzTmEdmzxPjZcOV8_r4WTxQ__7rVc8vScg7NAsDM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9pdjJkcHpodGlvZmdhZHdwazh4eg== 1640w, https://reader.miniflux.app/proxy/b9u0KAJ9cAr2y-B6CgLlzodc_VTjxKpBPdxX_TmVtX0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jc3Z2djN0cGJvaWp3ZmlyYWdrYg== 2050w, https://reader.miniflux.app/proxy/5v4TFi-jsPN_8xqJK1GnaQqtGnLOqJ_c7J6ceptjbJE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9pcWJkaHZ0amJwcGE2ZjVsczZraw== 2460w, https://reader.miniflux.app/proxy/Bc6mzNQidGs7m6GTlcfSnod-R7jKILbEwbuh1aCP4dA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tZTZzcmplemN4bzBuYWZwY2xsYw== 2870w, https://reader.miniflux.app/proxy/XKr9W58vBnFNiBPAJ1XhQ0TuriBfCfwCPLP2rGUgiQE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tY2htZWRjbHFreHVvZml2aXN4aQ== 3280w, https://reader.miniflux.app/proxy/PeqjhLovQ2RbYuqJyGPY_XMWClylZwL28p8qkIyhYZ0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91cHZrZG5lYmI3aDRreHRrc2p1dg== 3690w, https://reader.miniflux.app/proxy/3eaeA-X0ZYkedQBHSlUu8KIFfEb8TiITNc7GWIAB0X4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91cmhqZnVsOHExaGdtbzZpdHljMw== 4035w" loading="lazy"/></figure><p>Despite acting independently on each residual stream, MLPs make up the vast majority of the parameters in a transformer because they project up to a higher-dimensional space with the W↑ matrix<sup><a href="#fnjt0n10eo4b">[18]</a></sup> before applying a GELU nonlinearity and projecting back down again with W↓. The MLP parameters in W↑ and especially W↓ seem to be where most of the trained facts and information are stored, as evidenced by <a href="https://aclanthology.org/2021.emnlp-main.446/" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">Transformer Feed-Forward Layers Are Key-Value Memories</a>, the <a href="https://rome.baulab.info/" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">ROME (Rank One Model Editing) paper</a> and subsequent work on <a href="https://dynalist.io/d/n2ZWtnoYHrU1s4vnFSAQ519J#z=qeWBvs-R-taFfcCq-S_hgMqx" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">activation patching</a> for locating and editing facts inside transformers.</p><h2>Attention</h2><p>Each attention layer consists of a number of heads, which are responsible for moving relevant data from the residual stream of preceding tokens, transforming it, and copying it into the residual stream of later tokens. Each head acts effectively independently - we can see this in our diagram by replacing the <code><strong>num heads</strong></code> leg with a sum, and seeing that each term contributes independently to the residual stream:</p><figure><img src="https://reader.miniflux.app/proxy/VuEeeKrV-cvCUfG6oOX5twLllviBV9mHSpMzoBn26pI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vZzhiamVtamE2dXRocDZtNms1bw==" srcset="https://reader.miniflux.app/proxy/gboM7fwfXsdtY_ylS6kxQVx5mthzx8-As6BDUfKbCdQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mbjlmNXRtOGNub3ljNnFwN3dtNA== 370w, https://reader.miniflux.app/proxy/21FFh3-BZqtpHSQ_0-paXRt2wJg5msreJbkkQsSx5fI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ldmF2a21jMWViM2NiZnRicnRoaA== 740w, https://reader.miniflux.app/proxy/w-ujxS7bsjwlM55Up7F55B_6uSVizHhwecRqWlxPSsA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93Z2lwaWVmdXFwcm9qdWdzOGt2ag== 1110w, https://reader.miniflux.app/proxy/ZDKGP7ITrlUHtJea4DBiuBUn2qGFnJeYwq5M7H_KsaU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9kZzliaXIxbXNjenZhcmRkMmxpaA== 1480w, https://reader.miniflux.app/proxy/Knkpbbgzup_0PBKsptOTwpno19baT3zeQeUwSBxt7dk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95Zzl4d3N0ZG12amZjbnFoc210NQ== 1850w, https://reader.miniflux.app/proxy/yp36l140RE72mFw71v3ACnP8tS01YMWZk0XDVWITXBA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94MXNjZXJxNnN4dGdqeXRmaTU1ag== 2220w, https://reader.miniflux.app/proxy/sf6jICN8Ixrlij6e2z0o3EVwW4OGxetHvjY6BawFdYk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tand2b3pkZDh3cWR3c2ttYmR6Zw== 2590w, https://reader.miniflux.app/proxy/qj58T_pNJ38EMkS-frBeS3w2D8pfoB0_CfmMolR0l60=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9kaGswdDBncXJjdHN5a2F5bHduZw== 2960w, https://reader.miniflux.app/proxy/WbD3BBMNHz2pfstHwgMmEpUPg04gMqp_0xTSOSFrjD8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zdG9kZW53aGZ5cXJheG5jbm10OQ== 3330w, https://reader.miniflux.app/proxy/eC_ma0BFoa_CPBkvwrsXeWbvZgZPbFxbYyjmGVnTsUs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jYmRocGp6cWZqdmpjNzFhYWlxNQ== 3649w" loading="lazy"/></figure><p>Attention heads host the most easily interpretable parts of a transformer: the attention patterns. These are low-rank matrices (one for each attention head) calculated like so:</p><figure><img src="https://reader.miniflux.app/proxy/Uzm2_l58IPH9FsdHHn0sS0UOS2-kBFCCRwkSwnBjNAo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mdGh5cXR6bWZ3d25jNXMxcmtpeQ==" srcset="https://reader.miniflux.app/proxy/Sqo7ISAvRRNlaCOqS5jaSuKSl_ip0kgiSvWeOH-dfAA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9yZzVxOTJnZTBhcngwaHdtY2ZydQ== 240w, https://reader.miniflux.app/proxy/Vq4-23yXU_w1VRyG0HoaCGTGg3YMe3seaIq9QS2siQg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hOHp2ZG1oaGVvYjB1dHppb3Z4cQ== 480w, https://reader.miniflux.app/proxy/8NbYWhRO3ADGvVIbTDkhMrbwkRS8gIgJMwUaVIzbuYU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9iZXR5MGplYmVjdXZxcndkcW15cg== 720w, https://reader.miniflux.app/proxy/dTGuLYAo368GpAeFN6y4BJjVFiwB3gZm_mXkF1B2Zx4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92a3FsYnVrODFoa2NhcTRob25qZA== 960w, https://reader.miniflux.app/proxy/DVewyRBMMPHPyrUBLtzR0hAjYZQEVjyDFlX2ahgZsfw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93dW96Z2x5eXQwejdoenh0dXpsZw== 1200w, https://reader.miniflux.app/proxy/1PVncQMF6qkEewq_tI79AuL87HqVXweOZ6FJbBOQTpk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91NWR4Zmlqb3Y5YWd0ZjV2ZnZtZw== 1440w, https://reader.miniflux.app/proxy/mJF8v0xIOidnz9-D-7QqLgDqm0_wcIC3DtWsod_AGmU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95OGJoaWlyZHltZmR1eGlvZnNldA== 1680w, https://reader.miniflux.app/proxy/ZEtn8knBYFgRUEXy0hOkhJoxD4ETaTcg8QZI0Bh9TdI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95d2p0M3F3Y3pidW52ejM3Z2Vtcg== 1920w, https://reader.miniflux.app/proxy/vdpevQPpKfSINbQNqj-2nYdWZ_Y-D0G2tZIGV8g96sQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qZGFzdTE2a2ZnbGlkNHp1bmJrcg== 2160w, https://reader.miniflux.app/proxy/kwdDNZLp5N5Fbn2tuzBqOOLH8myWsLSpCrONpgd7ATI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ydXBpYnJrcXJ4eW5kMmtmcXhtbw== 2355w" loading="lazy"/></figure><p>Attention patterns determine how information is moved between tokens. For example, this attention pattern seems to move information from earlier tokens matching a pattern onto tokens immediately preceding the equivalent token in a new language:<sup><a href="#fnyxxu4agslhr">[19]</a></sup></p><figure><img src="https://reader.miniflux.app/proxy/w_ZraupZAJxX95kQSN5twAhED4N7cSNjpr0wwUXxnYw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9manlxd3NmaWFldm9nZHpvZmRkcw==" srcset="https://reader.miniflux.app/proxy/_sq8LgedXn6r92GoS_yuzWYBXyKRhZNEGt9sLvlCAtc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94aHpidnVwbW1vdnRmdTdtcHBxeg== 140w, https://reader.miniflux.app/proxy/x1n9H8Yyc59V_5IPYmrylsqws14-Yj34lrxYhFso46A=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95YmZrdXpieXVwMWpudmNveml4NA== 220w, https://reader.miniflux.app/proxy/lEqoeLk3MknBiKvEXyN9F3ILSjCi1eNgBVcwwowsRYk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zdGtqY25kYzFjeXlrZ3h1cGRnaA== 300w, https://reader.miniflux.app/proxy/hWQcPBRGmzaxhG0LCWC041ZhT4ZaAyfnX5qclpsLdPQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9yb3hjYTllaXlucDZlZHR6NjEzaw== 380w, https://reader.miniflux.app/proxy/TAE96ULifriNBJWkfDbxLHKSn_dVKKgG38zEhucRStc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9yMmF5b2tzbWxweDF4dDN1d2NrdA== 460w, https://reader.miniflux.app/proxy/WKiXmQS6IUu-0Jvce2TdVHD56eJzBDtjnUbJmf3Nc6A=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9yem91eDJ6emkxaW9mZmF3aG50dQ== 540w, https://reader.miniflux.app/proxy/O4FihTaQbn1TfzX8yj0UQQ5MMj98Ii4iKPMfODQGQak=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9saWFjcHB4MWsxc2h4Yng2bmtlbw== 620w, https://reader.miniflux.app/proxy/IIPSyR0qdkCoINLAJA0gcj4-VretJBNcYlPOsK59IiY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9nN2cwdHRpbXBodnN4YjRub3RiYg== 700w, https://reader.miniflux.app/proxy/SHXqkTd4ot72grD-uWVqSRYZn43lyOzjyxm3oX_dBQw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95YjV4OXN1bWhiODI0ZjhhNnRocw== 780w" loading="lazy"/><figcaption>You can play with <a href="https://transformer-circuits.pub/2022/in-context-learning-and-induction-heads/index.html#performing-translation" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">the interactive version</a> of this in the <a href="https://transformer-circuits.pub/2022/in-context-learning-and-induction-heads/index.html#performing-translation" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">In-context Learning and Induction Heads paper</a>.</figcaption></figure><p>We&#39;ll see an example of how an attention pattern like this can come about in the final section of this post (<a href="https://www.lesswrong.com/posts/BQKKQiBmc63fwjDrj/graphical-tensor-notation-for-interpretability#Example__toy_induction_head" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">Example: toy induction head</a>). But for now, we can just take attention patterns for granted. </p><p>Rather than computing attention patterns on the fly based on the current context in the residual stream (the two &#34;pasted&#34; tensors in pink), the attention pattern can be &#34;frozen&#34; for easier interpretability, fixing the A tensor and therefore fixing a specific pattern of information movement. When this is done, the attention block simplifies to</p><figure><img src="https://reader.miniflux.app/proxy/CqUtHZTSYxU9r598ZTQ-wsue6KEAWJyRsUSUqOHxXRQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9pb2ZxeG1jc2J2bDU5aGN3cXV4Mg==" srcset="https://reader.miniflux.app/proxy/GUVs7uDsjRbMAzGwoqonpDaV8e68jvQq6q-0_uVi428=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jZzF0cHJmd3ZpOHl4Mnpremk0Mg== 340w, https://reader.miniflux.app/proxy/hjUIhkJjRGKgV8nOFnkAlAPGv1ZNXVSi39qY75N3OQo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94NHhscWxnZWdiZmM5NnppaXA3cA== 680w, https://reader.miniflux.app/proxy/MX-i6GQ7wfUrVsRh3ot_L-PVByLUFoL6Og5MuQCAykk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ueTJvaXc5eG02ZmFob2V5YTNqNg== 1020w, https://reader.miniflux.app/proxy/pjqZTEsSA-TpuXGKY767PowN4I6cnOMHg7Q6IyEe2Ro=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qZ3NkcTB3aHphd3ZpZXBxb2F4Mw== 1360w, https://reader.miniflux.app/proxy/-GAvx6_33XjEdUAhfmOR213rjnIH03E6V2xO2Zqtj7k=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mcHFkczdxb3J3bWg3c3M5aW5vbw== 1700w, https://reader.miniflux.app/proxy/-ty0OJzmxKO4ZyrbwDmt7UpMulRkVK2DXPUWGMDGHmY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9lZnIxcWJsZXJpeHFudm1pbml1bw== 2040w, https://reader.miniflux.app/proxy/cjkkK2nVsSS84H5RGwje2xL1V6uddsjj3zwSJmRdxb8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95ejBjemtlcHZ0aW4xa282Y2FxMA== 2380w, https://reader.miniflux.app/proxy/E4-7vwxLrQlkIPdZQ7uMO7PqJvcOHRSMbKtAkbUQePY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92b2d2cnY1aGxxaWRlYTR0aThtag== 2720w, https://reader.miniflux.app/proxy/BCvcqs3Rsqy6Z5wuOMkQqggGqA1uOxEjMcPytPGtWVo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hZHhib3Nuc3Z5ZDJnd2Fzd3B4bA== 3060w, https://reader.miniflux.app/proxy/dCK4is5caXOfFou6XloPYvbqoyEEZulPSlJomePKcMw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mY3J0eG1kNXQyM3RmeWF5dXR5aA== 3343w" loading="lazy"/></figure><p>which is completely linear: the only non-einsum operation is now just a single copy and paste from the residual stream.<sup><a href="#fnnpy451jmyv">[20]</a></sup>  We can also see that the attention pattern A is the only transformation in the whole network which ever acts on the <code><strong>seq pos</strong></code> index: every other tensor is contracted into the <code><strong>hidden</strong></code> index, so every other linear transformation can be described independently for each token. This is why the attention pattern is the only part of the network that can move data between tokens. </p><p>With attention frozen, we can represent the sum over heads in a number of ways:</p><figure><img src="https://reader.miniflux.app/proxy/xq-rIaCLC_ZcIjhcflsbW-O-wFphP9aeBbkHyptVrdA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96eDlvYWVwZ2U5djF6d2F2cHppeA==" srcset="https://reader.miniflux.app/proxy/ohjPFzwyiRJFnfgPj4AIwT0fjgO2pJjYFlVRputoQdo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hcXAxdmt5bmVzenoxa3NwcDJsYw== 350w, https://reader.miniflux.app/proxy/uBdkZItnKU6b755MdxG03zskx02o6x1pNUZ3zm6gyGc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9weHRmdWNlZWg0cHVlemRob3ZjNQ== 700w, https://reader.miniflux.app/proxy/Aarf6a7xZSCQC2Bs-yEHtGr5lH54wGao2sKymx-W-dU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90OHN3N25qcmNweTdyazdpdGphaQ== 1050w, https://reader.miniflux.app/proxy/OzmnzQaWwTjRCmKiyRd0JhnwYXTJT6ZsCN6ET616ibY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94YnVkdWVmeGpienllOGY3czJjag== 1400w, https://reader.miniflux.app/proxy/rAFCjb3c9bRCEylukTJkNlthtvPONFa9guUKwjAVCUk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9rM2tndWtueGN5ZzlqbjZ3bXdkNQ== 1750w, https://reader.miniflux.app/proxy/VtoVr2DgSEaye2exACwPqSjuSkFyvwEaL6Ob8n4Eeks=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9idHlrMHBkbzZ3a25tamU2bzFscA== 2100w, https://reader.miniflux.app/proxy/eZghVgLAmRSECCJpXSlbRd0E_8OBnBrUIoH2ImG-DlA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9haTQ5YWRtYzlqZGI0dTV6ajBxdQ== 2450w, https://reader.miniflux.app/proxy/5adsme6wzWay1MEXuZgh02x61oFqwjCBisl5vOOpUF8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ueGpud2FodnVlMGNhdGRzeWRrMQ== 2800w, https://reader.miniflux.app/proxy/MDuAyU_ZgF54H7NlGfBOuETla3xY2dCJzs99s5mRT_8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91dTE0bG1zeGRrcGRrN25maGJvcg== 3150w, https://reader.miniflux.app/proxy/0rpi1WDPZISC60Dw77Rf0PmruHi7MGMgqBDAiJ_iqZg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mOXVndGZzZHpjemJ5NnB6ZHR0aQ== 3500w" loading="lazy"/></figure><p>these are all equivalent, just placing different emphasis on the independence of each head. You can even go in the opposite direction and emphasize the matrix-multiply nature of the <code><strong>num heads</strong></code> leg, reminiscent of low rank decompositions like SVD but for operators:<sup><a href="#fnz5zs6jysta">[21]</a></sup></p><figure><img src="https://reader.miniflux.app/proxy/26-9SJMfevo_DMJf3uL5xstS-YLqIbKnxNTv6HTtcwU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ieDRzYWJuaGtxYWxqdmFhZ2Z2ag==" srcset="https://reader.miniflux.app/proxy/PN43LxsmF9wvbQ3MNcpzn2Wj6etkBJIuRQU8lvIv2ho=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9iNWV6bHUwamNrb2FyYXpwaWllNQ== 210w, https://reader.miniflux.app/proxy/HpWpJ5c8iVYOHpjg2d3lm9GSOyEpF85BYc596IEOxE8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96cDN0Y2oxMzRjaW5jZncxb3drdQ== 420w, https://reader.miniflux.app/proxy/OkBJWovZHnPdtAhiMRLJcLebpa7o4qKBaIe1I_NaZS8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9uNzN3YndxN3JkZ2dpY280bWpkbQ== 630w, https://reader.miniflux.app/proxy/d21f0wOfaurMkU6SlhgbEdjVKYenBk0nusvt93oiG2E=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oOHhqMnZiZHp0anFmd2FjZnY1aw== 840w, https://reader.miniflux.app/proxy/IXQ-obiNa_AiXE4cnralMzBBZg2XVOIatcq1ucH9IsU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tcmJ4aHNsZmdrbnN0YzZwYTVpOA== 1050w, https://reader.miniflux.app/proxy/d2LKprT6gyPRjQ2zyyrZmxX6WBElDtaePY3ZRPBecII=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90ZXVmbnkzcjRjMDFhemUwN255bQ== 1260w, https://reader.miniflux.app/proxy/cO8dqwo1viwmeeLOm9VFLIBb0g8X8r8uAwKrvsoNZic=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vYW1qd2pjbzVkZG11Ymc3c3VpYg== 1470w, https://reader.miniflux.app/proxy/bXkpKSmMSBWWMw9cmJtr8RjCLAWscfgWe1xtRi8vNxY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93dmU4aDZxM3NqZ3B0bnFsamdkaw== 1680w, https://reader.miniflux.app/proxy/y1NnqZWmntc2f2z7NqJXfW-BQAlDEuMmpUpvYa8GYPQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9pcHBmMWI0d2VwYnd4djVreTVkeQ== 1890w, https://reader.miniflux.app/proxy/TCf_rPJ_mIEjTfL9sJ5XSnKKNSt41mtpAvs8D0LsnIA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mOWoyYTJ2YWJrMTE1c3l1amJtbw== 2012w" loading="lazy"/></figure><p>though this low-rank-operator way of looking at attention is probably less useful than the sum-of-heads way of looking at it. </p><h1>Composition and path expansion</h1><p>Layers of Attention and MLP blocks don&#39;t just act in isolation: they all copy from and write to the same residual stream, so later layers can use information computed in earlier ones. Still following <a href="https://transformer-circuits.pub/2021/framework/index.html" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">A Mathematical Framework for Transformer Circuits</a>, I&#39;ll ignore MLP blocks and focus only on the ways that attention heads in an earlier layer can &#34;compose&#34; with those in a later layer. I&#39;ll also ignore small but annoying nonlinearities like <a href="https://transformer-circuits.pub/2021/framework/index.html#technical-details" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">layer normalization</a>.</p><p>So here&#39;s a two layer attention-only transformer:</p><p><img src="https://reader.miniflux.app/proxy/n8y6VdwN8QoRrzaBVgu54u_y18peL4vLlY7f1_UdeZ0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9yenVlZWp6dWZ0eGJodjJ4cHV4ag==" srcset="https://reader.miniflux.app/proxy/eDiHE5mjrT_usxAWsWIDKQcmk5F3PBgB3TLMgNNwG-w=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vcXM4dGtkd2p2OG12M2wzeWV3Zg== 400w, https://reader.miniflux.app/proxy/xkeOmX4ZbBCjv7_Plu2BH1hdzf0KNtwN8cA-TA07VKs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xdWZjNmx3empqY3BhZnBwYW9hMw== 800w, https://reader.miniflux.app/proxy/_Ovak50q3merGqdwvY0EOTmPxWDFIQkn8uDwtsJpS_A=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tM2R5emRydDFlMXQ1aXlmZW1udg== 1200w, https://reader.miniflux.app/proxy/v6u5Q6sS0NA5cK6N6XY5PjKxt7yYcY3kdg1T6TqGzq4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92eTI0ejNrdnlreG5rZHRtd3owdw== 1600w, https://reader.miniflux.app/proxy/cQEls-F-muwKEsE97vjiY7V_GOXzWnCDlxd4yBe_foo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vczB5YTkwcjdweHhhajhlcmJ5dw== 2000w, https://reader.miniflux.app/proxy/m1u_mvClDScmXIxT6fsYGrx_bVnGPMCCJLVj6IzAgHk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9iZnNhZmpjMWZ5bnNleGZramtsaA== 2400w, https://reader.miniflux.app/proxy/qWygqE_e6QPcYnC4CXwnyvQQCRIYrvwYuphEWA_IcSM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96cWRyaXJtdXRycWVkZm5mZzB3dQ== 2800w, https://reader.miniflux.app/proxy/gGSosky-nneIrTEBpOs6GRbLooSBKiClkUaMytK3J44=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92ZnFibGxlMHBndGFxbTl4YjllZQ== 3200w, https://reader.miniflux.app/proxy/-wmcf9QPuQpyBr1qeXZARPf1tyFJDux1nxkrL1NrVYM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95MGlndHVva2l0MWVlN3RrYWdlZQ== 3600w, https://reader.miniflux.app/proxy/0Gdli1J7HZKNcsTwZLpfBnFWjpc2hTNy5LfFgkwD4s0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90bXdwOHVhaGtzaXhxeGdpenB3eg== 4000w" loading="lazy"/></p><p>where in the middle we&#39;ve gone ahead and copied the input into the first attention layer, and on the right we&#39;ve contracted the attention patterns in the first layer.</p><p>When the second layer copies from the residual stream, it will copy the a sum of terms from earlier layers. Rather than treating the result of this sum as a single complicated object, we can keep the sum expanded as two separate terms: the original input x plus a &#34;perturbation&#34; caused by the first layer:</p><figure><img src="https://reader.miniflux.app/proxy/b4zrehAQnknWkpDK5FFoe1w_SPblBFM4EDG05geJyZw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96cGFsNWltYmxwd2J0N3ZxNnZhbg==" srcset="https://reader.miniflux.app/proxy/wv9DJ6w-dKx1-O6EwrQpcuUWsKlLix8KMq9yiBDpM78=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9uc2s1azFnN2NwdWpzcXZrdWhjMQ== 260w, https://reader.miniflux.app/proxy/pUPQRlQfEdPF5wFrqhfRGdjgy7HEu4FEMzr8-CvvU20=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wNWlscmZqZ3l5NmZ3dDR0eGJxcg== 520w, https://reader.miniflux.app/proxy/21Dma0TIgOYdP8igWNyqBs95lBfvOX43n1U5-DsCKV8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zOGp2eGNvcXlxamVkaXJyeXlnNA== 780w, https://reader.miniflux.app/proxy/3xhc1oEUAJocj4EbM2zgnhmZ0P8i2B-qV3Dh_my6-zw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9yYWl1cXQ0cXpibWxweTd4OXA0Yw== 1040w, https://reader.miniflux.app/proxy/JgYO3g8aecUO3UscTBnnC0k3qKsN3tH_XmnJxY1QteY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9rZGF5anV0djBsdHBkY2MzZXk0cw== 1300w, https://reader.miniflux.app/proxy/Yr2TtCB0Zg6ZHZKwPxmzCU2sslVhdP7iQOpjSnztZ5s=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9veXBtYTI1NWwxa2RsZWpteGN5Zw== 1560w, https://reader.miniflux.app/proxy/l3PqDQXIkT-UUed5PXJ4gCcqmBLZcUabBKnQyeZQoNs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90eWhmMGs4aHh2Z3g3YWpjeWtmdQ== 1820w, https://reader.miniflux.app/proxy/pi8dtfrLHIxgTHxDDmvBVorilTsfh1VypmkF4xSSM7k=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9meWxzYWhha3huMTN0eWg4eWU3bw== 2080w, https://reader.miniflux.app/proxy/fIqjki_0nhieQOQTA6fmmEDZWzXV9H5vbi64cx_v-Ro=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oN2s2dWxmeDhmZjFqenVwdGs3bA== 2340w, https://reader.miniflux.app/proxy/rpR2d78oL_ZUHALl5ZpeBS21tQPbvu1_sHYEEzmn3xo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95cHptYWx5bXNpdHExeGN2Y2cybQ== 2564w" loading="lazy"/></figure><p>Now we can expand the output of the whole network as a sum of terms like this, in something reminiscent of a <a href="https://en.wikipedia.org/wiki/Perturbation_theory" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">perturbation theory</a>:</p><figure><img src="https://reader.miniflux.app/proxy/kuWUFRSWXWXJdldCDXvJyGG_lVFJqATRtU_LyYv2bcg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90bmszbW0zOGZjZmFydXEzdGV4eg==" srcset="https://reader.miniflux.app/proxy/ADxu_7FN9XVbClpjz6JAsQSUi2HQor9xwH-EAdbGusc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mb3B2ejJsdm5mc3E2c3lhYnp4dA== 400w, https://reader.miniflux.app/proxy/Hj5L1UDJjAnVznVcvmY_TTRrVqi3fAXKa94hL5q9ICU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mczM1bHB4dXJuaDVueThyY3F5cQ== 800w, https://reader.miniflux.app/proxy/OCMU6eCzdjE_J-abMkXnj5GwKi-EhHjsCOFk7oQSBu0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96cmo3a3k3MGd1eXhzenJienpicQ== 1200w, https://reader.miniflux.app/proxy/npFFfRth56rsjJ_j83RR6FMSFeHdLalltJLBOzFLY-8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jY3BiOHF5M25wenFuOHZydGdrcg== 1600w, https://reader.miniflux.app/proxy/hOEiTKkfnq6GUL5r7S5lFWk1wpYwFcfdAK9R1ZvAXU4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zZGh5aHVwY2xxeWRrZnltd3BydQ== 2000w, https://reader.miniflux.app/proxy/nRK4JBdXpqLWy66ceVAmm-W8ARFNiiyTQDXBoVdydi8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9yOWZia2tpMDFoZXJxdmR2cmc3Mg== 2400w, https://reader.miniflux.app/proxy/O52e6MKNLUOnThRALniDnNCXEyZAmaiOvtWiVWfv5pg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wZzBrcXdyZnE4aWVoY294dG1wNw== 2800w, https://reader.miniflux.app/proxy/IX9PwB2w9-k2JT_eaIKQZCTVA4-DTXn_45w0_bHjE6M=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jNm5yemJ3NW5neHcwcnZmYnFnaQ== 3200w, https://reader.miniflux.app/proxy/bNDhe9gHINRx5V7XJpGuhu87_qiUU19CMaoF6rSjmOM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qdXN6N21zOGtnbDhvZmJjeW5naQ== 3600w, https://reader.miniflux.app/proxy/rO889-Yb-HAM3gpvCAALPvV4Ytr8gWggzdW81TOn6gs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93bWNsb3BiZ29rODRqNzk1dGZ2eA== 4000w" loading="lazy"/><figcaption>Note: this expansion is not technically true as written due to the nonlinearities (green ellipses) not acting independently on each term in the sum: this is what it means to be nonlinear. However these nonlinearities are pretty linear - consisting only of a mask (which is linear), a re-scale, and a softmax to ensure that the elements in each row of the attention pattern add to 1. The layer normalization nonlinearities (not shown) <a href="https://transformer-circuits.pub/2021/framework/index.html#technical-details" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">can also be treated as approximately linear</a> with sufficient care.</figcaption></figure><p>So we see that there are three simplest kinds of nontrivial attention composition: Q-composition, K-composition, and V-composition. We can simplify the V-composition and non-composition terms slightly by noticing when the attention patterns in the second layer can also be frozen:</p><figure><img src="https://reader.miniflux.app/proxy/VtlaSH7jLB4VaySslfs56qolhhL1bjABHBn2sHSB24Y=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94YnJkYm14MWhjYnp0dGswZWJycA==" srcset="https://reader.miniflux.app/proxy/zR_5G1af2oMcfTNgPLei_CUlPmgaWhC9AnVeH9xtb64=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vemU3czVrYXdyOWh5NXdxM3RuaQ== 380w, https://reader.miniflux.app/proxy/2dA6UewcIfw-Jyb-gJfL1bW3vg9tSLOKP2kEqjAUdx8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9lNTR6ZW4zYm53bGdieG5mYW8zcQ== 760w, https://reader.miniflux.app/proxy/c5KGDAVnbg1ueTVYMZKrXr5VDL0EWDC9SchBeTzgnkg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oZ2VjdTR0d2d5Ym5kcjdsa3VlcA== 1140w, https://reader.miniflux.app/proxy/b3SttYEp6Q30EUSUMkyLRiaOjJLyjEly9cjXg0F3X-U=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94a3BheWlreG9uenQzajJvb2U1ag== 1520w, https://reader.miniflux.app/proxy/8cj_gUh4bIXnmY0GWV8nTDdwpyW5-zziFkKdw4NIevA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xMnRkeHJ2dmRheWFxd204Z2J3aQ== 1900w, https://reader.miniflux.app/proxy/x0icjleRS6Mdbjn7LsJ0xECsp8b_A0Fwjpv7c25WNDM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93dnl1OWpmZzJoMTJ4YXk5c3prag== 2280w, https://reader.miniflux.app/proxy/YwErCvl3kfMYhg-1HOE-aBrTip03FZQmqqFG9pUZkw0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hN3RuMHVrc3FycXF6bWgxMnRmbQ== 2660w, https://reader.miniflux.app/proxy/JZEJEAZsJ9p2Hu8rbP4NuZxPY4WzCVAVl8blGyglt0o=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9lNWpjdWVzZTF2b2g5d3lhZDJkNw== 3040w, https://reader.miniflux.app/proxy/uAKGcwzmuc0iiVQ-xn0rTr5diAR_SY3c4I71b2fe1rY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9nZmIwdTZ0cGF1NWpwbDdodmk0cA== 3420w, https://reader.miniflux.app/proxy/WfA3uggTtNQWykUEjqIbx7Q1eNHpAcWp4FGrn9-eDc0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91emttdWdrdzVtcWFuY2lzanBwNQ== 3800w" loading="lazy"/></figure><p>so we can see that V-composition has a simpler iteration structure than Q or K composition - the attention pattern is just formed by matrix-multiplying two attention patterns, and likewise for the WO and WV transformations.</p><p>There are ten terms which contribute to the final answer for two layers: three non-compositions (shown), three single compositions (shown), and four higher-order compositions (not shown). But we can (and usually should) also expand out the <code><strong>num heads</strong></code> indices as sums, and have a separate term for each head and combination of heads. Likewise for the <code><strong>seq pos</strong></code> indices if we want to consider the contributions to or from specific token positions. <a href="https://transformer-circuits.pub/2021/framework/index.html#additional-intuition" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">MLP layers could also be incorporated into this expansion sum</a>, though their stronger nonlinearities would require some kind of linearization, and they only have one kind of nontrivial composition anyway. Regardless, the number of terms grows exponentially with the number of layers, so this kind of trick will only be useful if we have some reason to think that most of the work is being done by relatively few terms (preferably low order ones). </p><p>Some intuition for thinking that relatively few terms are important comes from noticing that each head can only write to a relatively small subspace of the residual stream, because the <code><strong>head size</strong></code> dimension is small compared to the <code><strong>hidden</strong></code> dimension, and so each head is projecting a relatively small vector into a relatively high dimensional space with WO and selecting small parts of a high dimensional residual stream with with WQ and WK, leaving sufficient room in the residual stream for most heads in different layers to act mostly independently if they want.<sup><a href="#fnqyg1iv81uas">[23]</a></sup> Of course its an empirical matter if low order terms actually explain most of the relevant behaviors, so this should be <a href="https://transformer-circuits.pub/2021/framework/index.html#term-importance-analysis" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">checked empirically</a>. There may also be much more effective ways of decomposing the computations of a transformer into a series of terms or circuits like this, such that more of the relevant behavior is explained by fewer more interpretable terms. One recent method attempting to find them is the <a href="https://arxiv.org/abs/2304.14997" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">Automated Circuit DisCovery (ACDC) </a>algorithm. </p><h1>Example: toy induction head</h1><p>We&#39;ll finish off by constructing one toy example of an induction head: a circuit detecting what should come next in a repeated string of tokens. For example, consider predicting the next word in some text like &#34;The quick brown fox [...] the quick brown&#34;. It seems like &#34; fox&#34; should come next to fit the pattern. Information from the earlier &#34; fox&#34; token should be copied into the final &#34; brown&#34; token&#39;s residual stream, so that the model can predict &#34; fox&#34; for the next word there:</p><figure><img src="https://reader.miniflux.app/proxy/lAysdheBb8DMKlCPorwAVvsK02U4A2_dR03TRrSjOvU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9td3B0MWFiaGcwZGdreGt6OTc4dw==" srcset="https://reader.miniflux.app/proxy/UFV7l2XVuVddnr1gj2T60t5i8RqEm-Px1J7qE5gEDqQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95dG00cGpteG11YjRuaW56ZHp2aQ== 400w, https://reader.miniflux.app/proxy/c-aHMY7TVfHIu7pqsWE0w_t_R_pEfSMfUU0epi1shCI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9kYWZmcTF2OHpvcHN3b3ZwdHlpdg== 800w, https://reader.miniflux.app/proxy/TIXWUlzGsN0Yb7LegfKLrM2PwGX0xaOLARa-mglxous=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9udWlkbjJzamNhYWVvczM0dXdrdw== 1200w, https://reader.miniflux.app/proxy/Su9imrVuxwbHGuFfnWD8dFsNEsJ_guogqSG80m88uaA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95cXN5bHZiNWZqeWtycXllZm5saA== 1600w, https://reader.miniflux.app/proxy/MRgXIftJc9YJ16zvC3uBMNRyt6qGM-O-LjCPPDJnGBE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qendicXhuYmR2MHBrM2JyeGhtZg== 2000w, https://reader.miniflux.app/proxy/j31okLOSkM8X3_YFARy9BR7kQQiRNsh3YLcvhZbuBAE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jYmN6M3h1aXV1cnFibWhma3NmYw== 2400w, https://reader.miniflux.app/proxy/pITsODLAO582_iBywfarRgaJlHUD1o3UdnyW5Dy6TzA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qZDdqeDhwZHdqNnV1bDZybmZzNA== 2800w, https://reader.miniflux.app/proxy/QdXUzQwE0LHtghiG738NwAH6rzIvb1M9ZHs_xeX1WTM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9nYnB3ODAxZmQ4dHBkZHN3MjRhNw== 3200w, https://reader.miniflux.app/proxy/V1kx2HguYX-1UOQT0LVRUUlIAVAabushu5eFq1yF7cI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zbTl2Y2pzazhidXd1d2Q1YXJ1cQ== 3600w, https://reader.miniflux.app/proxy/w3xpEEOSNAndfs-sLPB6CcOQeb3-xaWVriFoFlib_ew=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xeTBycnlqYWV0eGxqY2EwcmV6dw== 4000w" loading="lazy"/></figure><p>This is known as induction, which is a type of in-context learning. There are many ways to make these induction heads, and real induction heads are likely to be messy, but they <a href="https://transformer-circuits.pub/2022/in-context-learning-and-induction-heads/index.html" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">have been found</a> in models of all sizes. We&#39;ll construct a handcrafted toy example of an induction circuit, by forming a &#34;virtual induction head&#34; from the K-composition of two heads in different layers:</p><figure><img src="https://reader.miniflux.app/proxy/6WV-eTUotCySI6Kw_yELscj03XAPL3Ja8Hz2h0ZGnBc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oMjBpcjZocmJzZndhbG15ZmFrdA==" srcset="https://reader.miniflux.app/proxy/dYz0P6Fc1C8zBuLLhhO0AK4G89kPDHDe_F97nfrqCP8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9odW9sdmozZXhucHlpZThieGVzYQ== 100w, https://reader.miniflux.app/proxy/V3BHsr8lvBTFIfMdsxWvKa227a3w8fcCNlf-ZvhZHdE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93dHVjYWM1cmljcWNkb2l5ZG9oeA== 200w, https://reader.miniflux.app/proxy/d2Z5_yTzT726NNLGGm-G7aOBEFgGl_9PHnkM4Rs-kyI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95b3J2b3JicmV0djdwZ2R3ZjJmdA== 300w, https://reader.miniflux.app/proxy/PVxVLWuUpzMxnXlcuLJqK2ajibEPN3ynyQ4XE08Dr4A=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9nemhveWdrZGJ6M3htZ2EwZDVjdg== 400w, https://reader.miniflux.app/proxy/QPCB9w7lP1YO08xFwKJKxh9FD64AcUu4LDv1VE7dr5I=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93amlkZms3cGExd2Rub2V4c3hqaQ== 500w, https://reader.miniflux.app/proxy/qBsGAGGqMLnGMNjkNEGMapKRq0-31C6lCxQ_IuThx2U=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93YXZqcXV1Z2Q1a28weHd2cjJjdQ== 600w, https://reader.miniflux.app/proxy/8brn8lWPhdo0Y5P-LvqAtd_VtqkvvLiODTYW8i6509s=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hc2RtMWt6ZmFybHdzYzJ3N3NwYw== 700w, https://reader.miniflux.app/proxy/nsUGIF4Klg1sUZZ0tNKAmk1_1Z4aGtf8gHt4SfngU6U=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90amZ6eHV2OXhpb3VvOHd0NDgxOA== 800w, https://reader.miniflux.app/proxy/Pwfhfjn30Mt3-9szJPg-afdyjSag1Ajff-o7COOo3b0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hYzhxeWNuYTBqc3l4Y3FsbXkxdw== 900w, https://reader.miniflux.app/proxy/1gYXfcFLZodSG4VCepNSnHKUqO2meXaOO-wY83LU9Bk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94OXdwbmFkbm1pb3RlejNqNjVqOQ== 964w" loading="lazy"/></figure><p>Everything in this diagram is now a matrix, so we could draw it to emphasize that it&#39;s just a sequence of matrix multiplications:</p><figure><img src="https://reader.miniflux.app/proxy/AiDEAV3_EB_IcMoNccy4CP27cX2Cfvkik45zz83C50I=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95eGh1d2cwYnd0a25nd2djc2Nudg==" srcset="https://reader.miniflux.app/proxy/u9oN5hPiTePX-zDa8tPCeYlktD-7Wu53CiXHtGf3bDs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92Z3ljdnE2cGRsb2cxaDdqbWJxaQ== 260w, https://reader.miniflux.app/proxy/NXmUh5FoglPBQVt_e8VVKxJtWYLSYyQ6nT9arK8EIEA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90YmxpZGJ5bDh2M2l4bXF4ajNpcQ== 520w, https://reader.miniflux.app/proxy/D3kZF_ZN7okOAoiHmWN2bbk2gODtht0V1LBbi9IedjM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wYWpxcjZ3dXhtZHVnM3diZmFndg== 780w, https://reader.miniflux.app/proxy/Pb2saKbm0iuiHR47oZ9CCYdaAa1oNc0vEeuizCEa0QU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9nZHJ3ZWhnbWw3dDhndWJrYjB4Mg== 1040w, https://reader.miniflux.app/proxy/V7pg5rIzTAn4DCl14G4jr8SQqySZzukAqi22lVU65No=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wc3loYmtncXpneW5jdjBsbTgzYw== 1300w, https://reader.miniflux.app/proxy/Bnx6kAgBPuTkY2r8HLCR3I1oB4enOkTpJkuwcgfnSNw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90ZWhmZ3RsY3B2cnRnNHJpc2Fxdg== 1560w, https://reader.miniflux.app/proxy/MVvFXaP3XwyOjggtvaxbNFxSjw4nszKlvw2Zfq_Tfag=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xaTJwaGVyb2dhaHNua2drNmZlMQ== 1820w, https://reader.miniflux.app/proxy/A-B8VGX7Rk_fkORbtXwer_BonTFy6cHIyvH85fDzkDI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95dnltcWpwenB6cmd4NDBlc214aw== 2080w, https://reader.miniflux.app/proxy/pc43_Cus80kEgIIU_BOc4uMcsPHLdus-77pV0MUXSgk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9uemRiemxia2RibHMxeWdoZW1jMw== 2340w, https://reader.miniflux.app/proxy/46HR9AJuZqDAhrDZ8F0AEBwrDNCI5kP44J3WdpuOKvw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9sZWxtMGltY3dkMm9vZHB4b2Z3dw== 2553w" loading="lazy"/></figure><p>but we&#39;ll stick with the previous format so you can more easily see how the circuit fits into the rest of the network. </p><p>In order for this to act like an induction head, the last &#34;brown&#34; input token (<img src="https://reader.miniflux.app/proxy/y3GNWgZUOh37o_WN30zZ_8gtvYyw3VpXNL9tfPE5vTQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9iam5pNWdld3dwdmFxMHpydXI0Yw==" srcset="https://reader.miniflux.app/proxy/sNArP2wsMcQ0mEvW8sASmIdZnqEtP7Qd_UMtz2aXlJs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hdjA0aGx2d2E1cndzc3B4MmNzNg== 138w, https://reader.miniflux.app/proxy/NoXNRLYr-FujRChhm-ZjctQUYQJV6t2EPYZkUPNRtEM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zdWIxeXR0bGRsdTFxcm9vNndmYw== 218w" loading="lazy"/>) should output a &#34;fox&#34; token:<sup><a href="#fnaxzrr2nf90q">[24]</a></sup>  </p><figure><img src="https://reader.miniflux.app/proxy/9c0oDo8I-bF594y0rvNpPNVoX20fGRFtuWHOvTmuefs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zYnVtNXF5cXRrY3hwc2pqaDdwZg==" srcset="https://reader.miniflux.app/proxy/1TejyCkvZpuRcfooJXMQTRsFnuspZibecWl0ES6_jzk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9kZ2Rrajdpa3VjYmZ2ZGlvZ2NvdA== 190w, https://reader.miniflux.app/proxy/JpAk62H8c6ioCCZKbCO6yM0ecJoS97Bziw1WNfUPnSk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xdmdwZmh2YnNycTdidmhrenI1Mw== 380w, https://reader.miniflux.app/proxy/-xO-YLRzdbns1en3fKoROgjrfnwu53GPPdGps6cNGZY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96aTV3ejZhamZpbTI2eGxldGV5bw== 570w, https://reader.miniflux.app/proxy/ycq8N04AVnNWscFPpG_9wDDTKBgE5vxSzLhMamNs3RU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qemVhcDh4cGhuaWJvbW1xNmZqZg== 760w, https://reader.miniflux.app/proxy/eaVNmBqC6APBXlu8qLCWmI_jzDdwU9LUdRVfEKW4hGo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96ZzU5dG5wdWdmbTN4ZjRmamxnYg== 950w, https://reader.miniflux.app/proxy/zyIfQRRtPMQCOuHuzTSjtyI2eX7cQGcVLojdCbUpJJQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wY3phaHBlbWFjZ3hlZDkwaHNrbQ== 1140w, https://reader.miniflux.app/proxy/VciGGh5q8yVnrHaoteBBZzf_5ZDsvVqhLyGJLWRFOXQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vYTd4ZWZkOHZlNmFkd2d3dGhsaQ== 1330w, https://reader.miniflux.app/proxy/dhBQmQsDJRMjmmzI5iyXWjASj9yCDB-dNjh7kmr_TKk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93NHh4Y3Z4dzdzbTRuaGF5Zmtmdw== 1520w, https://reader.miniflux.app/proxy/pR_gWuWcksNnjQ4XbdQmv_XFCFsADID1PFyIHcQpQTY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9kb25zeHF5M3JnZnVoY2pmZ2Z5cQ== 1710w, https://reader.miniflux.app/proxy/9o4gmq1mUzAhDPhFxmYiR9G3YK-G6RiGMN2sVBDvVoM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mZjEzcHpianhhYTl3aWZoa2dlaA== 1831w" loading="lazy"/></figure><p>Induction involves exploiting repeated patterns, so induction heads had better be able to pattern match. Here&#39;s the subcomponent of our induction circuit which will do that:</p><figure><img src="https://reader.miniflux.app/proxy/uBhZdgLXN85u9wGJzFJLDg2uVFOeC4vID0bd8p_Xt3c=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9nOWZmdmQ2Yjcxbnl6dWtyMHR0ZA==" srcset="https://reader.miniflux.app/proxy/8r0bpOv2Y_oO8zju2vYYv_nVPTLL1ghUeRA0wNFr5KE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95N3d5bHNmc3F4NXlyZHZjcHZjZw== 380w, https://reader.miniflux.app/proxy/aLxpq11QofHBA5-Uvef_cD6cROPR4uOYM0WTqVB1Vvc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9sbmxwb3ZxOWljeWtlZ2h0MGN6YQ== 760w, https://reader.miniflux.app/proxy/V48wGwXLAFAIHJ-FpEiHoW_PKd7HrGUugWYezK6SE_g=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jaGhwMjF0Znh5Y2RpZXRha3FuZg== 1140w, https://reader.miniflux.app/proxy/YUhfCoEFQP4QIL68z7wRXe1ugBiKcd8oCn31YKS8qNs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93cHFxam5iam9lbHltbmpuaTN1Zg== 1520w, https://reader.miniflux.app/proxy/w1eTBLL_q3eZLvz57KwiTCd-TQO-TxenVUMFr8tF3d0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9leTQ0bW44ejllcjhwZmxsd2h5YQ== 1900w, https://reader.miniflux.app/proxy/zEngxCRjGm4hi-NG8S5lDJwSfOu9Jna__IDwg5zJc2s=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94ZXRibmtxcG5vbmxhY3lxdm5pcw== 2280w, https://reader.miniflux.app/proxy/6R7p6ecabEjXUaUBdh0GrrL_xrjPyyQr7ggqC4kbgfM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91Y3k4Nnd3eGxtcjQ5b2MycHhrcg== 2660w, https://reader.miniflux.app/proxy/gB9puzjsTLHqEVEpyWXEpu7FEfc5ReO9LcX03WRdeKE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91Z3NmaWJpZWQxYzQ5a2I4Z2lybA== 3040w, https://reader.miniflux.app/proxy/Hd49-5lrBO0VlGdDJcRYEV9FK6YO9W5PwY_5W8B3rRo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zaWg1aW1oamUxMjVveTZldnFtcw== 3420w, https://reader.miniflux.app/proxy/eKd0hyzD0W9KIUk5yQRtraALI_nk2qI-CowqYdJPEuQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tamhuZnc0bXl5am13eW5mbWl3Zw== 3727w" loading="lazy"/></figure><p>So WO and WV in layer 1 (shown in yellow) and WQ and WK in layer 2 (shown in blue) can effectively just behave like identity matrices in the relevant subspace, or anything else producing something like a &#34;semantic delta tensor&#34; when you compose them together. We denote this tensor as &#34;Match&#34; because it should be near zero when contracted with any two vectors unless the vector on the left semantically &#34;matches&#34; with the vector on the right. </p><p>Now, we don&#39;t really care about the matching token per se, we just want to know which token came after it. We can see that the &#34;key&#34; side of the attention pattern A from layer 1 is going to be indexed at whatever token positions we get a match on (and multiplied by a number depending on strong the match is):</p><figure><img src="https://reader.miniflux.app/proxy/QV-dNuk44c6hEmmHnqNfQg2THOBhR7fQpE7NdPllkOM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tdXloZGF4bmV6YnJlanVya2N2aA==" srcset="https://reader.miniflux.app/proxy/hAJC7yhzsac5vO-L07bvcie_YiI7StOWnX-4um0Kdyk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ocTZkdmh6dDJtbGp6ZXl0c2huag== 330w, https://reader.miniflux.app/proxy/GeMU3uOtrmhrt4tfd8E6esNY6gcVkdxzQATIBrdfqqs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90OGliejhrYm5kNjFkN2FsMHN0aQ== 660w, https://reader.miniflux.app/proxy/DvezFpOal6nBTsU-PhUsfBnMGMgSQRqe8W-Ym6DUYuE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wYXE4d3VldGJ2NG1vaWp0dXI4ag== 990w, https://reader.miniflux.app/proxy/q0oXb1UFguiB2xRe7lsFTkmF9eEuobmpefpNGdwq8R8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96MWdmdHV1YWdtM3AxZjNwZGNmNg== 1320w, https://reader.miniflux.app/proxy/JRAmbmaBmK5cw6m27FL9xIuugiRyH1jFr9YSTTRG0Fg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9scHc3YXFhOGxjdWYwZmNlZnhmeQ== 1650w, https://reader.miniflux.app/proxy/vY_U_ceHvkIWw8XxJ_OeQ-eoBDYwnjgMfRxGpotvNz0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94ZWw3Z3h1ZjdpdWV0aWp5a2J1dQ== 1980w, https://reader.miniflux.app/proxy/l0xNd5bEbNaw4Yht2Vfwrj_bS79O7dZ0b5RKLxBqkto=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xajF6cnczcmt0bnhvZjN5ZDhqMg== 2310w, https://reader.miniflux.app/proxy/oMFMtYx28ISwSnxv98YihMjQ60VJnkRYIwigibFxPBA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ucGRnZjB3b25qc2tpbmN0ajVzZg== 2640w, https://reader.miniflux.app/proxy/Y4q0Ps7EBWNvgSKAs0TtJNBvLGnAj_b0LeChF1nu8X0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9md3JqbnV2eDhidWY1d2RndnBmZg== 2970w, https://reader.miniflux.app/proxy/2bNodGsXM1B05QyYAIuE8MW8TTBy_AuYw1i0pClx4Fg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9iajYwdjV1amloeGJlaGJvc3F3bw== 3238w" loading="lazy"/></figure><p>We know that the token we want is in the position directly after  <code>1st brown pos</code>, so A should map an index of <code>pos</code> on its key side to <code>pos + 1</code> on its query side so that we can index that token. Then we&#39;ll have</p><figure><img src="https://reader.miniflux.app/proxy/jB5ImzM37EoDGhlkNPsdZC6RtRpv8LhULQ9rgD0X27A=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9kNmR0MjhobGxjbHVhcXM2OTlseQ==" srcset="https://reader.miniflux.app/proxy/8EwtNBQICqC1JvChQXBJJ06dveDDfEeh_nMOruh7Gt0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95MmJucW82a281ZXJ0Zm84b252cA== 97w, https://reader.miniflux.app/proxy/-dmippxqS2w7Y4EDTCHoMIYR-IwnM5RUd7R0L9Umr8Y=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jMGJ2ZmZvcGx6d3ptMWN6eXNzNA== 177w, https://reader.miniflux.app/proxy/6Q6J3agabJTB9yl3YqVQkGQd_zk9mwozwXKmOcN4uno=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qa3g0dHFicW12aGx4cHFydXNqcQ== 257w, https://reader.miniflux.app/proxy/yun3p9BxmhsPeHhOet4VgpkZ8SwiGB0jb_3ykq4tnCI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qcHZtazg5aGR1dTJnd2tjN2tjeA== 337w, https://reader.miniflux.app/proxy/AqugPVSSJDr-9C8L1_NxWzpkvMIfNKc0PXHFk3lmI4U=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9va212dmZsY3N2YXE4d21jd2VqbA== 417w, https://reader.miniflux.app/proxy/yz7lwCk-ERF3_YmviKe1kA8xB4ExQV4u3xfqeBd-deg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92Z245ZmNpdnl4ZThmcnYzemdzcA== 497w, https://reader.miniflux.app/proxy/ORQwi_lO0b0ebMfQgsWSC8nWoFtvShvhHCOtsFV21Tg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jNTlmeHJtbnRnOTlra2JwYjNpdQ== 577w, https://reader.miniflux.app/proxy/BU8PyqfTCoCWwh9umNjJ0HHv_q7Z87jgTru44r_Nkac=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92enUwdXBiYnZkbXY1Z3I1NmZ0YQ== 657w" loading="lazy"/></figure><p>as we desire. We see that an attention pattern A doing this can just be a fixed off-diagonal delta-tensor Ak,q=δk,q+1: </p><figure><img src="https://reader.miniflux.app/proxy/Ftv_iFZ4KxyYMqef82fdEJaX9ZE8FuPq4YRXH3Cy-7A=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vd3dhdnBodWlmbW4xOGZkeG9lMQ==" srcset="https://reader.miniflux.app/proxy/YsIfPEiBcEvkBGTZ4jQ7fMMuOdvx0MQYJ8uBy6Ub6U4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vNmZ5Y3dqb290NW92bzhja3RuZQ== 110w, https://reader.miniflux.app/proxy/EsbNRptBiJYIQ2Rd3B56ofiUgYXS5CH0n9ej_mlCWyk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9kYWJ2NGFrd3h1bnFwZXZtb2FyOQ== 220w, https://reader.miniflux.app/proxy/wTy3PDIpszxDZHgzchjXT6tjdovMVmWcw4sIojPLWs8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jY2VrcjlzY2ZvOWg2YXlreXNsOA== 330w, https://reader.miniflux.app/proxy/HFBrhb78Z0WINvhZuwk6G2eZFT0h4q6Q7oAyw0xxZBM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91eHJnYzQyaWJ5OGpuejRiejBvZQ== 440w, https://reader.miniflux.app/proxy/rK1Dm21iUua-bpPV60cQULNQmas1ppdVvPKBEl0JZMY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9kMm1tZ3F2NGRtcHl2ZjNveHBrZQ== 550w, https://reader.miniflux.app/proxy/B5a5jz1zS7fSRG1MwuawoU-8bv6VJd0e4XNii6dRO_M=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ldXF5ZGZrdXZ0bnNuaHZwYnhkMQ== 660w, https://reader.miniflux.app/proxy/pOrtXF4PsBU3EEW3zd_wn6gAuhvkQgcv7cUy5NTH-1M=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mZDhoZnhzbmptamZhaWtqemZqYg== 770w, https://reader.miniflux.app/proxy/-jMDm3w0Q0s56ADLWVUACOPjsu-SLvbf5Fa9NMA-Qow=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92bHBqM29mdnZiYzA5OWh1YnUycw== 880w, https://reader.miniflux.app/proxy/kvw9CTVZu62hZ1RKr2eD3g4yo1hJE4XCEU3ESEsB9kQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95aDFib3prdzJqeGJlaGliM29nYg== 990w, https://reader.miniflux.app/proxy/3DGr-F0N4RdlPxGb-3HkLwUw57Poavt0_v21YiOoVtQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9lamF0cGhuamU5c3F6d2pkcHZtdQ== 1092w" loading="lazy"/></figure><p>This is also equivalent to mapping <code>pos</code> on its query side to <code>pos - 1</code> on its key side: always just attending to the previous token, so heads with this attention pattern are known as &#34;previous token heads&#34;. This attention pattern also removes the unwanted <code>2nd brown pos</code> term, because this term indexes the final column of the attention matrix where all entries are zero. </p><p>Putting this attention pattern Ak,q=δk,q+1 into our circuit therefore simplifies it to:</p><figure><img src="https://reader.miniflux.app/proxy/Fib-xReeopoW7xNq-TEtlAIZslvBysAhAm1wmH9Wt78=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wYWIyMWJxdnRhYXdvbmFyb3p2aQ==" srcset="https://reader.miniflux.app/proxy/lGpqJoOIaBlhGkq8RfzeUHabFXEuAE-bvlH5c1jjTVM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tdzl1bnZuMGR4enNsZ3RiaHNsYQ== 310w, https://reader.miniflux.app/proxy/-amW17xetg-9QoQ_VkkDwnXpdab50ZmGHB5XSNM-DBA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zcHV2ZGluMTJ3aXRxbW1iMXVnbg== 620w, https://reader.miniflux.app/proxy/WV-rBq7uNeILQsUqa21XfacC4Dw-dcoj4HCowrPaVxs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jOXVhdXBjd2xndGkycnI4c2xobA== 930w, https://reader.miniflux.app/proxy/marcDKOA4vxwVu2dK149OBdzlo-dLMk_FLbdVE-qSH0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95Ynk1cmJ0bTFtMG91bm5ncmJsaQ== 1240w, https://reader.miniflux.app/proxy/nG8fj2MkvUZ6Vqi-HBThl-BcJeXHzabS90BfMhcxdEA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90dm9uZmJkc3luYzBpd3BoNng3Yw== 1550w, https://reader.miniflux.app/proxy/O47a2NrqYLW7HnVZ7nk_hsjO1Wp7D5CZO5MLQFStHec=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90NW96ZHN1Zzd2OHM0bGRibmx0cA== 1860w, https://reader.miniflux.app/proxy/5hnEM6gGAK2DzMKOiSXjkWTJxW_9q5xRGJBc7VGz5aM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ld2lhczQxZnlrNW14bno5cml3Mw== 2170w, https://reader.miniflux.app/proxy/xbaAq7nan4Yb2Cufo1LyOD0k5egG7mLBg3q9nSh0sGo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9peGtucmpyaHoxYTJ4NmhvcHM1ag== 2480w, https://reader.miniflux.app/proxy/UpT7yRs0hte13rT2Nom8EaXzYcT98fg8KvTbWh31CqQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vdDFwOTNueWtwZGN0bHpjc2Vkeg== 2790w, https://reader.miniflux.app/proxy/y4DHv-BVb7Q93WVUcfIuFfE1rs0DBdgjnach9_oWpMA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9kY2xpNWllM3hrbm93cWRwMWZ2aw== 3016w" loading="lazy"/></figure><p>so we can get the desired &#34;fox&#34; token out, so long as it gets properly handled by WV and WO (which are in charge of putting the &#34;fox&#34; information into the residual stream), and by the unembedding WU (which is in charge of getting the &#34;fox&#34; information out of the residual stream and turning it into the correct &#34;fox&#34; token). </p><p>Putting everything together, we see that it&#39;s possible for virtual induction heads to have a very simple approximate form, composed almost entirely of delta-like tensors:</p><figure><img src="https://reader.miniflux.app/proxy/2xQz6Bshrrbb9Qc0gASViDD9BpQViueFYE1Pj-pePfo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wc3dkZ2d1YXhraHh5cW45bmR0MQ==" srcset="https://reader.miniflux.app/proxy/MpQMoYcLc65ToXasdZ___P1KJ6pSsJL_IRgdgIlNKA0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95dW4yc2Ria3d4cWt0Y2NkbDB2cQ== 300w, https://reader.miniflux.app/proxy/7OpLp5EMxSs5ekdXRvYZZgNbvTvoFEsVBmudcJT8eLo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mb3Y1b2M1ejVnMHAycnF0dGJudQ== 600w, https://reader.miniflux.app/proxy/fHewUlo41HRMhG_KfrFpjFQeYXYs1bXnREP_XLYqELU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wa3ljdWoyem9wZ3B5Z2VtZmNzZA== 900w, https://reader.miniflux.app/proxy/Ipwa854kV_4WUksBw3Ac2ZI1njsThxOEIWKG-YGqVpg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mOGlhd2IxZ2Fpcm5kNHh2MGU4YQ== 1200w, https://reader.miniflux.app/proxy/F_QJuN27NLPhcSaD83kI0z96pqSM8x22ObuFEs-u1a4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92bHRxanFlbm9hc3o2NHVpaGZybw== 1500w, https://reader.miniflux.app/proxy/EdKpDoufSJgSLc2lHxB7IdCvdUXoTBZPvWU_ddnTie4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hNTY5c3BibDJhOXFzdTc5ZzZ1eg== 1800w, https://reader.miniflux.app/proxy/8lbSwvNAFvroVpk8dQgK6ePMqzsRsl878Sc4d7n9VIU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91amdyaDRkcm1zcmhsMm40c3VtNw== 2100w, https://reader.miniflux.app/proxy/BvhyM3RC7a6r_9geVSDodga9zmrR1f_ODKmn_D7pP0A=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xMzNsY2R1djNqOXNudmt0dXc0Ng== 2400w, https://reader.miniflux.app/proxy/RbR1AE7IuCgW1Hbie2acf-7u-g9TI68eI9ElNBwbWLA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qZ2RlenFxb3V0emljc3BjeHB6dQ== 2700w, https://reader.miniflux.app/proxy/Bl4LJAXvigjkvTMasghyXzsYL5M7i9zp85Ua_qDj4iQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9nMGhnM2tzZ3RrOWIxM2RhcjVjbg== 3000w" loading="lazy"/></figure><p>We can sanity check this toy induction head by computing its attention pattern numerically on a repeating sequence of random vectors. We see that it looks like a real induction-head pattern, attending to the tokens which followed the current token previously in the sequence:</p><figure><img src="https://reader.miniflux.app/proxy/v8L8Eox-yzpzTOMlB_P7Ky4XjNTsyTuSMOVG3vhnHPk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wdTlkc21xZXdiaWtheHBtaGlydA==" srcset="https://reader.miniflux.app/proxy/1XPc-_e8G_1ovEzBfQnNn2qVpTqQCfsvXcRbRPoy5Ig=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9rYjZmb2Qyc2dnZXo2eG90dmRoZQ== 310w, https://reader.miniflux.app/proxy/3KQ-RhKS_45FYExjpJNiHnIWxk7n_R7PuH9h3SdUa8g=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94bHJ5NXowbWx6NG8xb2V3b3FrbA== 620w, https://reader.miniflux.app/proxy/O4xOC0bTnA02qnCFQpkegnQXUE7nfJILv2FVQ7OqPK4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9uM2J2a21mbHJ2Z2x0emhxZTR2MA== 930w, https://reader.miniflux.app/proxy/WiJkIu4bFIfTCmnlYWgfeeEH3ECVdgK22cL65lgHv-k=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93YW9yaXNjcWQ4aTdwZWJ5ZGJidw== 1240w, https://reader.miniflux.app/proxy/Jhh_BLdA2hmvUp4VZSXgT8tKet7GlkDNkRttvzRdVeg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9pcnFnbWNpc212aDExOWdhZjF5bw== 1550w, https://reader.miniflux.app/proxy/c_KFbVQgbtwZXbWu9QKUXHTBpZrt04v4TuNqScA9okU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ycm5waGYxb3liaXRveXkzZXFvbg== 1860w, https://reader.miniflux.app/proxy/Dwsx_Qaz67ZnqbZ8w-3ASGkPBLxgJScTz_2J_1Avud0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9icHppdGJuZ3JyejBseGpodHkwNw== 2170w, https://reader.miniflux.app/proxy/5jakKFYgz5I4WdEXJ6EhQxQRNDQpomr8ohju6Ybablc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tY3BwZjB1ZmdtMmI4dWVlaG5xdw== 2480w, https://reader.miniflux.app/proxy/6IFEh9q3qzzQc8Qy6wEfjYiVF2p4CAu3A6smrF8LEQ4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91a21hZ3pwYXh0MWN4YmRvdXh5bQ== 2790w, https://reader.miniflux.app/proxy/4pKFiEnIEui7zsT3dv34ud1nJkvtObFGECVGUGdTSnA=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94emQwd3YzcngyOThmYnhjdDV2aw== 3074w" loading="lazy"/></figure><p>here&#39;s the code for that:</p><pre><code>import torch as t; import matplotlib.pyplot as plt
from einops import einsum, repeat
hidden_dim = 768
pattern_len = 6

# Generate a three times repeated sequence of 6 random vectors
x = t.rand((pattern_len, hidden_dim))
x = repeat(x, &#39;seq hidden -&gt; (repeat seq) hidden&#39;, repeat=3)
seq_len = x.shape[0]

# Calculate the toy attention pattern
prev_token_head = t.diag(t.tensor([1.0]*(seq_len-1)), diagonal=-1)
match = t.eye(hidden_dim)
attn_pattern = einsum(x, match, x, prev_token_head, &#39;seq0 hidden0, hidden0 hidden1, seq1 hidden1, seq1 seq2 -&gt; seq2 seq0&#39;)

# Apply the mask and softmax to the attention pattern  
attn_pattern = (t.tril(attn_pattern)-t.triu(t.ones_like(attn_pattern)*1e5))
attn_pattern = attn_pattern.softmax(dim=-1)
print(&#39;attn_pattern = &#39;); plt.imshow(abs(attn_pattern), cmap=&#39;Blues&#39;); plt.show()</code></pre><p>However this virtual induction head formed by K-composition is just one term in the path expansion, so we&#39;d need to make sure that this is actually the dominant term by suppressing the others. This is where the WQ/K/O/V/U matrices are important, because they selectively determine what gets taken from and added into the residual stream, allowing them to suppress unwanted terms in the path expansion (if they so choose) so that only this virtual induction head is important.  </p><p>Finally, we can put these WO/V/U matrices back in and see the full induction network rather than just the &#34;virtual attention head&#34; term in the path expansion:</p><figure><img src="https://reader.miniflux.app/proxy/1oBAsZCwF6HFOc0Xks-iKuQUCf2Gcrx9HStl7ms7DkE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mY3JzYWxqdzJhY2JtZWx6bDVmcQ==" srcset="https://reader.miniflux.app/proxy/Cwy7S-88vOPSv2w14jIrQPXGRM8TzZ5yD0PASBrB2Ys=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91ZmVuN21nb21tMnN1Z2RmdWZ2dg== 150w, https://reader.miniflux.app/proxy/dWNGXScwO1QGevbf9ikvoxHiw-LPwhoJX4CSwMFlPwg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zd2FldGpwb2R6NHJpdmEzd3locg== 300w, https://reader.miniflux.app/proxy/C7VxoGBaBk1NlbDB2nETZTKo2u6rOtcrSPMy4ABDhwg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qcnJuZzhodGE2aXFnb3lhZ3FmYw== 450w, https://reader.miniflux.app/proxy/YWp7xCU_dzQE4sZ3bUoh4Db4UbavAns-KQf4-KcNWkg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9wenF5Z2k2MHlvY280b214dDlseQ== 600w, https://reader.miniflux.app/proxy/pIfuj7pDiwgP1LqsZVos0RH8BBF5Jqlgpd6LpD8CHLI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tZ293d2FxdGV4ZXI5cjhkdXk0ZQ== 750w, https://reader.miniflux.app/proxy/QX3U5Aob0YaGU9vhrtIh_9jb158h5znpfGWn-6-jt9Q=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90bHhxcHR5Y3QwY2VnenJ4a2Zsag== 900w, https://reader.miniflux.app/proxy/q4nMXr422fD9DCicfcm1Yo8blgFnhqOYAIsUHYG1XIw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9pbWlqbnZ3dXF6Z3NsbnJndmpieQ== 1050w, https://reader.miniflux.app/proxy/tY2Q4lkFOXa6AdsF5hsQZCmi33wYTTUgO7YoZQkUKAI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai96cml3c3l2eWl6Njl5N3dsc3I5Mg== 1200w, https://reader.miniflux.app/proxy/wmfGiNLUJGPq6e3ABxnfBbNHfBeSPVwbmdIhuc1Kyxs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90b2p0MnhwdHgyM2xiamhrcG1tNQ== 1350w, https://reader.miniflux.app/proxy/AOELWE8lMJKzC3nIrwIkV4vM3plIYfSdo-foL_V7f2w=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai90bHhwYmV0cm5mMzVnb25kaXBzbA== 1428w" loading="lazy"/></figure><p> </p><h1>Conclusion</h1><p>Overall I think graphical tensor notation is a really useful tool for understanding and communicating interpretability results, especially for anything involving operations between more than a few tensors. It surfaces dualities and interesting equivalences more easily than other notation, and remains intuitive without necessarily losing any mathematical rigor. It may just be my preference, but I continually run into papers where I wished this notation was used. </p><p>Please suggest corrections and changes. I can also give you editing access if you&#39;d like to expand this document or make more substantial rewrites. Editable SVG files for all diagrams are available <a href="https://drive.google.com/drive/folders/16uuvkG1NtjhpAbchJ2R1Zp96IoZYKtk5?usp=drive_link" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">here</a>.  Please also let me know whether you think the impact of this post due to capabilities externalities will be net-negative despite its potential use for interpretability work, or use <a href="https://strawpoll.com/w4nWrXkzdyA" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">this poll</a> if you have an opinion either way.</p><p> </p><ol><li id="fnbwj2f888xxm"><sup><strong><a href="#fnrefbwj2f888xxm">^</a></strong></sup><p>And capabilities work, so this is dual-use information. Please use <a href="https://strawpoll.com/w4nWrXkzdyA" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">this poll</a> to let me know whether or not you think the impact of this post will be net negative.</p></li><li id="fnbytowdrb3ck"><sup><strong><a href="#fnrefbytowdrb3ck">^</a></strong></sup><p>also known as <a href="https://tensornetwork.org/diagrams/" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">tensor-network notation</a>, <a href="http://homepages.math.uic.edu/~kauffman/Penrose.pdf#page=5" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">Penrose graphical notation</a>, <a href="https://en.wikipedia.org/wiki/ZX-calculus" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">ZX-calculus</a>, or <a href="https://ncatlab.org/nlab/show/string+diagram" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">string-diagram notation</a> depending on the context. </p></li><li id="fnytaychzpt3"><sup><strong><a href="#fnrefytaychzpt3">^</a></strong></sup><p>Technically tensors are abstract multilinear maps, rather than just arrays of numbers. However the two are equivalent once a basis for the multilinear space has been chosen.</p></li><li id="fn13ccdi9zt3v"><sup><strong><a href="#fnref13ccdi9zt3v">^</a></strong></sup><p>A tensor with N legs each of dimension d contains dN numbers. </p></li><li id="fnh1buayt8oo"><sup><strong><a href="#fnrefh1buayt8oo">^</a></strong></sup><p>Consider contracting along the top line first:</p><figure><img src="https://reader.miniflux.app/proxy/5CNY-2UtJKcQy5mDiBptzGTEewQ35thbV6IPEsJJTdw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9laGxkaDI2ZXZsb3Jxcm5hc2tneQ==" srcset="https://reader.miniflux.app/proxy/Ms7MQqpq47QW_xiPxNzEpk0IZlTf8WaiAwHTPuhX2eY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95bG5yeXUzYWxwdWFpejV6dHRnMA== 210w, https://reader.miniflux.app/proxy/IBi91bZO3R7q-yGboXe-BUIqlZWI9KS2VVsMug0atTU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vYXc0NXl5d2ZhaTRscnQ3Y29waw== 420w, https://reader.miniflux.app/proxy/LRkdI4LmQ4qrx_BHoQz4l4-Cayz0pa4ASaf1zdwO3XY=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xajF2bDR4Nmx0anNjc2k2bmdjaQ== 630w, https://reader.miniflux.app/proxy/Ki_mToh7nqx8McvQRmRwjpCKSwqoIKJcUfQ0J64RCH8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9jcWozeTRxNGlvaHJzNTRkbDkwdw== 840w, https://reader.miniflux.app/proxy/KGAiwWzZun5huIF3Ly-vUMs4U6sFG-8PfidK0npwIV8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9uNnBqaGloZzZ2c3Zybjd4cGxxZQ== 1050w, https://reader.miniflux.app/proxy/QL01e6OYQWEcn0MZ3RcX5-6MrIKRMzJNMl3-oGJ-oEE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94aXNxd3N2ZWJxdHQ3M3A2Z3p6NA== 1260w, https://reader.miniflux.app/proxy/td1cth-xQuMH6FFfWwPJlcMoIjuum9I8eOTq92mfe8k=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9rYmFocGNzcHE2MmlvZ3p5bmJvag== 1470w, https://reader.miniflux.app/proxy/xnj2PH9yqnnjRaSOx7VEhvJi0ZJb-PHxTIIxgnzOn7I=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91OXh4ajUxcGVhdmN6ZWRueWpycQ== 1680w, https://reader.miniflux.app/proxy/iou7bc9cfUAerT6p1DDz0OyaB9FfG6aBhxO2WBm64Vg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91cTNpdnE3ZGd0dmtmdWdsbDF1aQ== 1890w, https://reader.miniflux.app/proxy/SAWYyOVtkeRdRj3WadGVC3R9r2x8wGaGa2_V8OIj5Xo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qZ2lkbWdwdXpwbGt4ZjM4amVrdw== 2015w" loading="lazy"/></figure><p>which has a cost exponential in the number of tensors, because an intermediate tensor is created with N/2 legs. A much more efficient order is </p><figure><img src="https://reader.miniflux.app/proxy/58LHwnSBLUI-ckolIm112rtB8Ezz_RTk7wrrJhKXNI0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91aHVjdXpoN3JhazNuNWhucmoyaA==" srcset="https://reader.miniflux.app/proxy/G6r18ToulNOPZPqc7qVDlltliMJSDkjatxIEA-aE7Qs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tNG0weGptd2ZkbWdjcmxjMmJ5ag== 210w, https://reader.miniflux.app/proxy/eILtsH6c4eQX8XurwMEuoaAzYBNt4CJ6uLkQ4nl7M_I=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94eDFzbW9nbXY1OGw4bXY5OXhsZg== 420w, https://reader.miniflux.app/proxy/cgORf1T0dFk69HmSv7jslXSzlfFBkozQotFMpjezmdQ=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vdWQxamRuOWZkYjNqa2p1dHJjbA== 630w, https://reader.miniflux.app/proxy/3sExmFZe2vpm-K-kpnbpHSV8bS_QJizEsfKBUSc-jwM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9yczJhZHF6b3FveWR3ZTBheDh1ag== 840w, https://reader.miniflux.app/proxy/pZrCmS1QG1XW5IOKBXFd2E3nqcnpNOlnxh_jje3z21g=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9iOWEyYm56eDIzZWd0dXB6ZmhuaQ== 1050w, https://reader.miniflux.app/proxy/cgSfMqkHFJr6uX6v9OaaYZYTyb60PMAuYckuigDLdYs=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94Zm9wczI1eXpidWZrZjUyN2Zkbg== 1260w, https://reader.miniflux.app/proxy/_S0B093k77HN7rljojSK3vYsMxVVnNgFDQqmNTR5rgU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oZGxyd3pxZnE2dmxzcnZteXN5bg== 1470w, https://reader.miniflux.app/proxy/Omj9M40zpJHJ43dC4XHUyexS0EXZFqfJY9EL1jKtgWw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9vMmJsempmZ2pvcWx4eGVhaWUybw== 1680w, https://reader.miniflux.app/proxy/4YpTYcD7NI6eoyw1jTtkTC0tK5BDv1tl4BB9zrbQLeo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hN2FkeXhlbm00cjRremJxdjFldw== 1890w, https://reader.miniflux.app/proxy/t85SzogM5bgwF2WWjUB-i9ViHsBJO4-cZllPvZEfOL0=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9oajViZ292a2w5N2dodXRvOXJkMg== 2015w" loading="lazy"/></figure><p>which limits the the intermediate tensors to no more than three legs, and scales linearly with the number of tensors.</p><p> In general, finding the optimal order in which to contract a tensor network <a href="https://www.worldscientific.com/doi/abs/10.1142/S0129626497000176" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">is an NP-hard problem</a>, let alone actually performing the contraction, <a href="https://link.springer.com/article/10.1007/s00037-000-0170-4" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">which is #P-hard in general</a>. Usually though, fairly simple contraction order heuristics and approximation techniques get you relatively far. </p></li><li id="fn9fzq2gk6z18"><sup><strong><a href="#fnref9fzq2gk6z18">^</a></strong></sup><p>technically <br/><code>rearrange(einsum(t.eye(5), t.eye(3), &#39;i j, k l -&gt; i k j l&#39;), &#39;i k j l -&gt; (i k) (j l)&#39;)</code> as shape rearrangement isn&#39;t yet supported within an einsum call.</p></li><li id="fnm5ocsq6ut5j"><sup><strong><a href="#fnrefm5ocsq6ut5j">^</a></strong></sup><p>This is not the most natural way of representing a matrix or the effects of an SVD, because images have a notion of locality between nearby pixels, whereas nearby entries in a matrix are treated as unrelated. Still, it&#39;s intuitive and easy to visualize. See part <a href="https://www.lesswrong.com/posts/iupCxk3ddiJBAJkts/six-and-a-half-intuitions-for-svd#6B__Information_Compression" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">6B of Six and a half intuitions</a> for a more natural SVD compression example. </p></li><li id="fntsvsfrkezh"><sup><strong><a href="#fnreftsvsfrkezh">^</a></strong></sup><p>A sketch of the proof can be found in the <a href="https://www.lesswrong.com/posts/iupCxk3ddiJBAJkts/six-and-a-half-intuitions-for-svd#Appendix___Eckart_Young_Theorem" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">appendix of Six and a half intuitions</a> The original references are: <br/><a href="https://link.springer.com/article/10.1007/BF01449770" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">Schmidt 1907 </a><br/><a href="https://link.springer.com/article/10.1007/BF02288367" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">Eckart and Young 1936 </a><br/><a href="https://academic.oup.com/qjmath/article/11/1/50/1525786?login=false" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">Mirsky 1960  </a></p></li><li id="fngub7c5mcstg"><sup><strong><a href="#fnrefgub7c5mcstg">^</a></strong></sup><p><a href="https://onlinelibrary.wiley.com/doi/10.1002/sapm192761164" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">Hitchcock 1927</a><br/><a href="https://typeset.io/papers/foundations-of-the-parafac-procedure-models-and-conditions-4hwy0qyl1q" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">Harshman 1970</a><br/><a href="https://link.springer.com/article/10.1007/BF02310791" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">Carroll and Chang 1970</a></p></li><li id="fnjxtzw5zwo8"><sup><strong><a href="#fnrefjxtzw5zwo8">^</a></strong></sup><p><a href="https://onlinelibrary.wiley.com/doi/10.1002/sapm192761164" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">Hitchcock 1927</a><br/><a href="https://link.springer.com/article/10.1007/BF02289464" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">Tucker 1966</a></p></li><li id="fnnw86qlujp7"><sup><strong><a href="#fnrefnw86qlujp7">^</a></strong></sup><p><a href="https://www.sciencedirect.com/science/article/abs/pii/0196677490900146?via%3Dihub" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">Hastad 1990</a></p></li><li id="fnfmyqacdyvzw"><sup><strong><a href="#fnreffmyqacdyvzw">^</a></strong></sup><p>These originally come from quantum physics. Matrix Product State is the original name used by physicists, while tensor train is a more recent term sometimes used by mathematicians. </p></li><li id="fn7wayrajbdzx"><sup><strong><a href="#fnref7wayrajbdzx">^</a></strong></sup><p>For example, using a series of local SVDs and local contractions like so:</p><figure><img src="https://reader.miniflux.app/proxy/gy4b408ekvWm0d_imSM13pJ501JPP8nOuEyVE1K3Y48=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tZnl2ZW9lcm95aXZjaW9saHQxZg==" srcset="https://reader.miniflux.app/proxy/f23RYFcVDKkJK7KPC1_8jbNdib8noOWap4wG1cZ7lC4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ta3ZvOHU0NTlua3Ntb3FuaXJ1YQ== 280w, https://reader.miniflux.app/proxy/iNCyDa11JzONXSyPRTSQaOxsPXyR68AN9X8E8SxyMCI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qanB5YWJucGswaDdocTUzZjF5ZA== 560w, https://reader.miniflux.app/proxy/L3f5yoKlo39kb7XJvFEmhwHXnF0U8S0m7yQlrIC6avE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9maXcwd2dsbzB0b3lvcHVicnZseQ== 840w, https://reader.miniflux.app/proxy/ibF_xSo4Kjyx_lO1hIVfLlKFn2sIYUzYYdyTlu9o-_k=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mcGZneWlsemhuZzlsYXNjNTZxNg== 1120w, https://reader.miniflux.app/proxy/GJ1xwSWHAda1HpeuIh9TriM4qeOzurQfRC5_dT99Cc8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9weHRjYmpqanJrdHk0cWlsbTZ0cA== 1400w, https://reader.miniflux.app/proxy/SHlZN49G3e1mD7mV5eMyqRrdL4K6FlOl87ODnK33a_s=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9nbmF1cTBoZXhxZ3poa3dmajJudg== 1680w, https://reader.miniflux.app/proxy/bjgmr-BJDsU5XYPPFzSx1vlJuxujwdlyf1PANvQJTg4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9seG4zd3lkMGN0OTc5d2Rycm5meA== 1960w, https://reader.miniflux.app/proxy/5Mlum86Xilm4pc_15pFgYdDgvRC1tVxEPZUbha-ZKsc=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9iMDFpbjBrdXQ0cm1haGx1eTRzMw== 2240w, https://reader.miniflux.app/proxy/odMOJhqpapZA8pV-Im3XBM2KdJ8O6XjpTAw_wSqUtZ8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zcGpnZTc2aHBiOW1ndXUzZGZqbA== 2520w, https://reader.miniflux.app/proxy/MOJfiQxYccX1V4jMfipXLWP-yReLfd5fkV3Tre_MgBU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92Nm96aHhqeXN1aHZydnJrdGxzNg== 2744w" loading="lazy"/></figure></li><li id="fnvvx1l7fra8"><sup><strong><a href="#fnrefvvx1l7fra8">^</a></strong></sup><p>Gauge freedom is the fact that many tensor networks contract to the same tensor, so transformations can be applied which affect the tensors, but don&#39;t affect what the network would contract to. For example, a resolution of the identity I=XX−1 can be inserted on any bond. The matrix and its inverse can then be contracted into opposite surrounding tensors:</p><figure><img src="https://reader.miniflux.app/proxy/fSWmxXUteFEHpR5erNBinpemmCoNZPUyyrIR9wnPqM4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9xd210eXVxb2tkM3hlNWk1YWdxaw==" srcset="https://reader.miniflux.app/proxy/Ja37xi8FK-SuuH2inRLBwA9ulZ-DoowHANOoKZ6CaT8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92MnZ4dHd6cHk2d2x1dnllcHZ6eQ== 200w, https://reader.miniflux.app/proxy/VmB-gYF4IjiCHZSA2_1CThkxgvG5TporGISvsI26SFI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9keDk5NHpwMHJ2N282cnUyaXQ3dQ== 400w, https://reader.miniflux.app/proxy/iJROY6bzegfbcZEaOt_cH6YELH0ChjUh3KlDNY07_p8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qb3RybmxneWUyZHpzZmM0d3ppYw== 600w, https://reader.miniflux.app/proxy/J8iEMm-FXekdtkE9xehtq33yg_Ve2T6-6ntAzH8EiR8=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9rM2htYnhmbWtzeGp0OXB5amR3ag== 800w, https://reader.miniflux.app/proxy/rt9bUkCZrCmOwtHVjtR9XH9KYsl3KxUx4xXgo8J18_g=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9obmQ3dncxajk3eHVnandzbzYybg== 1000w, https://reader.miniflux.app/proxy/AYVatAFYIYne-m5gMy-58T5rU-VzsHhdkWKYA0ITjkM=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9id3N5YXk4bmxqemFvZGlqaGVhZA== 1200w, https://reader.miniflux.app/proxy/DDSSB8npQ0P_HX91L7bMh2x1SPX4jTcLBqmjjPNGbiE=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai94eW5xcDJpcjlreHhqZnZuNWd2bw== 1400w, https://reader.miniflux.app/proxy/CKICvlJLdt8kUCHxx1qjY6km8nBmALwqWGuKmgBagLU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai91eWZud2FmbGF5eGRmeTV4djdhbA== 1600w, https://reader.miniflux.app/proxy/p3UEUiGTT7ci-tALfL1EGoTn5jztJMEItLa7gX3dtTI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9zdHdicDB4bHdjbzJka2J2enFjdQ== 1800w, https://reader.miniflux.app/proxy/LaL2Dr77cmnx9gpy-m1VevFBJ12_xA54JI3Hqfo2gdg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9qY291aWd3aW83OHZobzUzdmJwNQ== 2000w" loading="lazy"/></figure><p>This can even arbitrarily increase the bond dimension of the tensor network without changing what it represents, since the matrices X and X−1 can be rectangular.</p><p>As a special case, the tensor network could even be multiplied by an entirely separate tensor network which contracts to the number 1:</p><figure><img src="https://reader.miniflux.app/proxy/qi-1KvE9EJ92UTwO8_p_lwUyum0nDT05bFrTEckW6Xo=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai93ejlyZHR6enIyZnNqd3FwdXNjZg==" srcset="https://reader.miniflux.app/proxy/if6-ue-wJap9h_w-B27L5nbreGkAcj6y0f6V0tJFcQk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9tc3dyYjZjYmVwajFiaGFjdGd4bg== 300w, https://reader.miniflux.app/proxy/so-LQsMtyNJ_JIfo4Qr4dzV-u79F-aSjwq29FInyMlI=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9kMHR4dW5mYXRreGRzdXJtZGY2OA== 600w, https://reader.miniflux.app/proxy/nKzzlkv0hTNb8n9bFMOWRmizSO-Xo0yWpV9ACyWvRdw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai92M3pvdTA1dXI5dXhjMnp5M2F2bQ== 900w, https://reader.miniflux.app/proxy/1qcO0wVoQjRsv1SjhGIB96XSw6w7gJZ3ofg3M1_x5Fw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9rcGd1dHlsd3VlYWJsYWVodjVmNg== 1200w, https://reader.miniflux.app/proxy/oPVcm1Mzg-CUgqmrwDYTHp83YfN4Yi7D8rl3dqFQUgw=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai95MHR1eGlrYTd4NnB1eGVtaThuag== 1500w, https://reader.miniflux.app/proxy/W-vdMj8G3vWNnQJTd6MUmiji3nFjGUBI2gasEZFjdGk=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ja2x5dGEyYWozbDJsdmg3ajBvdA== 1800w, https://reader.miniflux.app/proxy/cEat33WB0mufChQhg4DK4hK2U9HgR13JREgQbWQJQFg=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9ycHlheXdoN3BlbGlyYWg2OWg5aQ== 2100w, https://reader.miniflux.app/proxy/ekUzkdmhmRiU7GVsUUEV96RSl6322Z3IoQ_DIaBOElU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9raWJzZGJ0b3A1c2d4eWJuaWRkcw== 2400w, https://reader.miniflux.app/proxy/vnG3Yd32OCp0yQpiLbduXi9BWGci5Kc5m-kHYP1SHfU=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9mbXJsMnNpdDVucWRrcnB5aWcwcw== 2700w, https://reader.miniflux.app/proxy/3RG6I-5WLfhQWMLQyg07FGwNPH8rxxLilS2gfdBcNg4=/aHR0cHM6Ly9yZXMuY2xvdWRpbmFyeS5jb20vbGVzc3dyb25nLTItMC9pbWFnZS91cGxvYWQvZl9hdXRvLHFfYXV0by92MS9taXJyb3JlZEltYWdlcy9CUUtLUWlCbWM2M2Z3akRyai9hd21vYWJ2M3ZjczBva3BxejltbA== 3000w" loading="lazy"/></figure><p>Making all tensors isometric towards some spot in the network will fix the gauge, since SVDs are unique (up to degeneracies in the singular value spectrum). Likewise, truncating the zero singular values will remove any unnecessarily large bond-dimensions. However SVDs only work for gauge-fixing in tensor networks without loops, such as tensor trains or tree tensor networks. </p></li><li id="fnk90gzolb6j"><sup><strong><a href="#fnrefk90gzolb6j">^</a></strong></sup><p>Tensor networks work best at representing quantum states which have entanglement scaling with the surface area (rather than volume) of a subsystem.</p></li><li id="fnd3bbi58ho5"><sup><strong><a href="#fnrefd3bbi58ho5">^</a></strong></sup><p>Simon Verret already <a href="https://simonverret.github.io/2019/02/16/tensor-network-diagrams-of-typical-neural-network.html" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">has a post</a> on representing neural networks such as RNNs and LSTMs in graphical tensor notation, but I&#39;ll be using a different approach to the nonlinearities.</p></li><li id="fn1g1fyzr8cdph"><sup><strong><a href="#fnref1g1fyzr8cdph">^</a></strong></sup><p>The bias terms can be accommodated into the matrices by concatenating [1] to the input vector x and expanding the weight matrices appropriately.</p></li><li id="fnjt0n10eo4b"><sup><strong><a href="#fnrefjt0n10eo4b">^</a></strong></sup><p>a 4× higher dimensional space in the case of GPT-2</p></li><li id="fnyxxu4agslhr"><sup><strong><a href="#fnrefyxxu4agslhr">^</a></strong></sup><p>This specific &#34;induction head&#34; kind of attention pattern will only be seen after the first layer, because it must arise as a result of composition with attention head(s) in previous layers.</p></li><li id="fnnpy451jmyv"><sup><strong><a href="#fnrefnpy451jmyv">^</a></strong></sup><p>Copying and pasting can in general be nonlinear, for example if products are taken between copies of an object, that&#39;s the same as raising it to some power: a nonlinear operation. But here with attention frozen there are no products taken between copies: just a sum when the attention result is added back into the residual stream.</p></li><li id="fnz5zs6jysta"><sup><strong><a href="#fnrefz5zs6jysta">^</a></strong></sup><p>This is reminiscent of other decompositions of tensor operators into sums of rank-one tensor products, such as sums of strings of single-site Pauli operators in quantum error correcting codes, and Matrix Product Operators (MPOs) more generally. </p></li><li id="fnnlxx83ypt3"><sup><strong><a href="#fnrefnlxx83ypt3">^</a></strong></sup><p>I&#39;m ignoring layer norm throughout this section. </p></li><li id="fnqyg1iv81uas"><sup><strong><a href="#fnrefqyg1iv81uas">^</a></strong></sup><p>Though the same isn&#39;t true for MLP layers. Additionally, if <code><strong>num heads</strong></code> ×<code><strong>head size</strong></code> ≈ <code><strong>hidden dim</strong></code> (as is usually true), and the contribution of each head to its subspace is not small, then some decent number of heads per layer <strong>must</strong> interact with heads in the previous layer. </p></li><li id="fnaxzrr2nf90q"><sup><strong><a href="#fnrefaxzrr2nf90q">^</a></strong></sup><p>The original &#34;brown&#34; vector will probably also have to be subtracted out of the residual stream somewhere too. This is also ignoring positional embeddings. </p></li></ol><br/><br/><a href="https://www.lesswrong.com/posts/BQKKQiBmc63fwjDrj/graphical-tensor-notation-for-interpretability#comments" rel="noopener noreferrer" target="_blank" referrerpolicy="no-referrer">Discuss</a>